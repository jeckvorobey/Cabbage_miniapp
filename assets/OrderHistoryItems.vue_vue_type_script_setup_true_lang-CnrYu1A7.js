import{Q as g,a as m,b as o}from"./QItem-C7guVh2W.js";import{Q as v}from"./QList-CDrZ7gFU.js";import{Q as M}from"./QBtnDropdown-DcKpnKEv.js";import{V,W as O,a1 as C,Y as r,$ as t,Z as e,a2 as D,a3 as y,X as p,ab as E,a5 as s,a6 as f,a4 as k,_ as T,a7 as w,z as G}from"./index-uHYAwrN6.js";import{C as R}from"./ClosePopup-DNobT9tp.js";import{u as $,d as h}from"./use-quasar-BmoZ4Q_8.js";import{u as x}from"./orderStore-BXsYUc01.js";var u=(i=>(i.CREATED="created",i.ASSEMBLING="assembling",i.DELIVERING="delivering",i.COMPLETED="completed",i.CANCELLED="cancelled",i))(u||{});const P=["href"],j=V({__name:"OrderHistoryItems",props:{orderData:{},adminMode:{type:Boolean}},setup(i){const c=$(),N=x(),L=[{label:"создан",value:u.CREATED},{label:"собирается",value:u.ASSEMBLING},{label:"в пути",value:u.DELIVERING},{label:"завершён",value:u.COMPLETED},{label:"отменён",value:u.CANCELLED}];function I(l,a){c.dialog({cancel:!0,message:"Вы уверенны что хотите изменить статус?",persistent:!0,title:"Смена статуса"}).onOk(()=>{b(l,a)})}async function b(l,a){try{c.loading.show(),await N.updateOrderStatus(l,a)&&c.notify({color:"primary",message:"Статус успешно изменен"})}catch(d){console.error(d)}finally{c.loading.hide()}}function Q(l){return L.find(d=>d.value===l)?.label}function S(l){c.dialog({cancel:!0,message:"Вы уверенны что хотите отменить заказ?",persistent:!0,title:"Отмена заказа"}).onOk(()=>{b(l,u.CANCELLED)})}return(l,a)=>{const d=O("q-item-action");return r(),C("div",null,[t(v,null,{default:e(()=>[(r(!0),C(D,null,y(l.orderData,(n,B)=>(r(),p(g,{key:B,class:"border-bot"},{default:e(()=>[t(m,null,{default:e(()=>[t(o,{caption:"",lines:"2"},{default:e(()=>[...a[0]||(a[0]=[s("Дата",-1)])]),_:1}),t(o,null,{default:e(()=>[s(f(k(h)(n.order_date)),1)]),_:2},1024)]),_:2},1024),t(m,null,{default:e(()=>[t(o,{caption:"",lines:"2"},{default:e(()=>[...a[1]||(a[1]=[s("Имя",-1)])]),_:1}),t(o,null,{default:e(()=>[T("a",{href:`tg://user?id=${n.user.id}`,target:"_blank",class:"text-primary text-decoration-none"},f(n.user.full_name),9,P)]),_:2},1024),n.user.phone?(r(),p(o,{key:0,caption:""},{default:e(()=>[s(f(n.user.phone),1)]),_:2},1024)):E("",!0)]),_:2},1024),t(m,null,{default:e(()=>[t(o,{caption:"",lines:"2"},{default:e(()=>[...a[2]||(a[2]=[s("Статус",-1)])]),_:1}),t(o,null,{default:e(()=>[s(f(Q(n.status)),1)]),_:2},1024)]),_:2},1024),t(m,null,{default:e(()=>[t(o,{caption:"",lines:"2"},{default:e(()=>[...a[3]||(a[3]=[s("Общая сумма",-1)])]),_:1}),t(o,null,{default:e(()=>[s(f(n.total_amount),1)]),_:2},1024)]),_:2},1024),l.adminMode?(r(),p(d,{key:0},{default:e(()=>[t(M,{color:"green",dense:""},{default:e(()=>[(r(),C(D,null,y(L,(_,A)=>t(v,{key:A},{default:e(()=>[w((r(),p(g,{clickable:"",onClick:q=>I(n.id,_.value)},{default:e(()=>[t(m,null,{default:e(()=>[t(o,null,{default:e(()=>[s(f(_.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])),[[R]])]),_:2},1024)),64))]),_:2},1024)]),_:2},1024)):E("",!0),!l.adminMode&&(n.status===k(u).CREATED||n.status===k(u).ASSEMBLING)?(r(),p(d,{key:1},{default:e(()=>[t(G,{round:"",color:"deep-orange",icon:"close",onClick:_=>S(n.id)},null,8,["onClick"])]),_:2},1024)):E("",!0)]),_:2},1024))),128))]),_:1})])}}});export{j as _};
