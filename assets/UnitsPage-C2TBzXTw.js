import{d as w,r as v,aj as _,ai as m,an as a,f as e,as as S,b0 as D,ao as I,av as Q,b1 as N,Y as V,Q as f,aW as P,u as F,c as L,o as R,ag as j,ah as y,ak as g,am as b,F as E,aq as O,at as U,ap as C,ab as T}from"./index-DemT-Fo5.js";import{u as $,Q as W,b as k,a as q}from"./useUtils-D9PEiHZE.js";import{Q as Y}from"./QList-UHorcP8U.js";import{u as h,Q as z}from"./unitsStore-Xpjcy-lI.js";import{C as x}from"./ClosePopup-CMs0irHQ.js";import{_ as G}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{u as H}from"./usePermissionVisibility.hook-DoUq1Y_t.js";const J=w({__name:"AddUnitModal",setup(B){const c=$(),p=h(),s=v(!1),n=v({name:"",symbol:""});async function r(){try{await p.createUnit(n.value)&&c.notify({message:"Единица измерения успешно создана",color:"primary"})}catch(u){console.error(u)}}return(u,t)=>(m(),_(P,{ref:"dialogRef",modelValue:s.value,"onUpdate:modelValue":t[3]||(t[3]=l=>s.value=l),persistent:""},{default:a(()=>[e(S,{class:"add-product"},{default:a(()=>[e(z,{greedy:""},{default:a(()=>[e(D,null,{default:a(()=>[t[4]||(t[4]=I("div",{class:"text-h6 q-mb-md"},"Добавление единицы измерения",-1)),e(Q,{modelValue:n.value.name,"onUpdate:modelValue":t[0]||(t[0]=l=>n.value.name=l),outlined:"",class:"q-mb-xs",label:"Наименование"},null,8,["modelValue"]),e(Q,{modelValue:n.value.symbol,"onUpdate:modelValue":t[1]||(t[1]=l=>n.value.symbol=l),outlined:"",class:"q-mb-xs",label:"Символ"},null,8,["modelValue"])]),_:1}),e(N,{align:"right"},{default:a(()=>[V(e(f,{color:"red",label:"Отмена"},null,512),[[x]]),V(e(f,{color:"primary",label:"Подтвердить",onClick:t[2]||(t[2]=l=>r())},null,512),[[x]])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),K=G(J,[["__scopeId","data-v-05746ffa"]]),X={key:0},re=w({__name:"UnitsPage",setup(B){const c=$(),p=F(),s=h(),{isManager:n}=H(L(()=>p.user?.role)),r=v(!1);R(()=>{u()});async function u(){try{await s.fetchUnits(),c.loading.show()}catch(d){console.error(d)}finally{c.loading.hide()}}function t(d){c.dialog({title:"Удаление единицы измерения",message:"Вы уверенны что хотите удалить единицу измерения?",cancel:!0,persistent:!0}).onOk(()=>{l(d)})}async function l(d){try{await s.deleteUnit(d)}catch(o){console.error(o)}finally{u()}}return(d,o)=>{const M=j("q-item-action");return m(),y("div",null,[e(f,{onClick:o[0]||(o[0]=i=>r.value=!r.value),class:"full-width q-mb-sm",color:"secondary",label:"Добавление единицы измерения"}),b(s).units?(m(),y("div",X,[o[2]||(o[2]=I("h6",{class:"text-center q-mt-md q-mb-md"},"Единицы измерения",-1)),e(S,{class:"my-card q-ma-sm",flat:"",bordered:""},{default:a(()=>[(m(!0),y(E,null,O(b(s).units,(i,A)=>(m(),_(Y,{key:A},{default:a(()=>[e(W,null,{default:a(()=>[e(k,null,{default:a(()=>[e(q,null,{default:a(()=>[U(C(i.name),1)]),_:2},1024)]),_:2},1024),e(k,null,{default:a(()=>[e(q,null,{default:a(()=>[U(C(i.symbol),1)]),_:2},1024)]),_:2},1024),e(M,null,{default:a(()=>[b(n)?(m(),_(f,{key:0,flat:"",round:"",color:"red",icon:"delete",onClick:Z=>t(i.id)},null,8,["onClick"])):g("",!0),e(f,{flat:"",round:"",color:"primary",icon:"mode_edit"})]),_:2},1024)]),_:2},1024),e(T)]),_:2},1024))),128))]),_:1})])):g("",!0),e(K,{modelValue:r.value,"onUpdate:modelValue":o[1]||(o[1]=i=>r.value=i),label:"test"},null,8,["modelValue"])])}}});export{re as default};
