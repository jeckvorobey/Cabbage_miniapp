import{aq as S,r as g,ar as k,d as C,a2 as q,a5 as m,a4 as i,a9 as a,aa as w,f as e,a3 as I,F as x,ac as B,a8 as p,$ as L,ae as c,ab as u,a6 as N,Q as h}from"./index-BajYhe5X.js";import{u as V,Q as $,b as d,a as f}from"./use-quasar-DwvzMf_o.js";import{a as F,Q as A}from"./QSeparator-Bjbg7oo1.js";import{Q as D}from"./QCard-DGDbAFqO.js";import{Q as E}from"./QInfiniteScroll-BvIqR8u-.js";import{a as P}from"./useUtils-BPm5G4xQ.js";const T=S("Users",()=>{const _=g();async function o(r){return k.get("users",{params:r}).then(s=>s.data).catch(s=>{throw console.error("[UsersStore] - An error occurred while fetching via Users",s.message),s})}return{users:_,fetchUsers:o}}),O=C({__name:"UsersPage",setup(_){const o=V(),r=T(),s=g({offset:0,limit:20,total:0}),Q=(t,n)=>{if(console.log(t),r?.users?.length>=s.value.total){n(!0);return}y(),s.value.offset++,n()};async function y(){try{o.loading.show();const t=await r.fetchUsers(s.value);t&&(r?.users?.length?r.users.push(t.items):(r.users=t.items,s.value.total=t.total))}catch(t){console.error(t)}finally{o.loading.hide()}}function b(t){try{o.loading.show()}catch(n){console.error(n)}finally{o.notify({message:`Пользователь ${t.name} заблокирован`,color:"primary"}),o.loading.hide()}}return(t,n)=>{const v=q("q-item-action");return i(),m(E,{onLoad:Q,offset:250},{default:a(()=>[n[0]||(n[0]=w("h6",{class:"text-center q-mt-md q-mb-md"},"Пользователи",-1)),e(D,{class:"my-card q-ma-sm",flat:"",bordered:""},{default:a(()=>[(i(!0),I(x,null,B(p(r).users,(l,U)=>(i(),m(F,{key:U},{default:a(()=>[e($,null,{default:a(()=>[e(d,{avatar:""},{default:a(()=>[e(L,{color:"primary",name:"local_bar"})]),_:1}),e(d,null,{default:a(()=>[e(f,null,{default:a(()=>[c(u(l.name),1)]),_:2},1024),e(f,{caption:""},{default:a(()=>[c(u(l.telegram_id),1)]),_:2},1024)]),_:2},1024),e(d,null,{default:a(()=>[e(f,null,{default:a(()=>[c(u(l.username),1)]),_:2},1024),e(f,{caption:""},{default:a(()=>[c(u(l.role),1)]),_:2},1024)]),_:2},1024),e(v,null,{default:a(()=>[p(P)?(i(),m(h,{key:0,flat:"",round:"",color:"red",icon:"disabled_visible",onClick:j=>b(l)},null,8,["onClick"])):N("",!0),e(h,{flat:"",round:"",color:"primary",icon:"mode_edit"})]),_:2},1024)]),_:2},1024),e(A)]),_:2},1024))),128))]),_:1})]),_:1})}}});export{O as default};
