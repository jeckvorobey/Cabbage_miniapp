import{ar as S,r as g,as as k,d as C,a3 as w,a6 as d,a5 as i,aa as a,ab as I,f as e,a4 as q,F as x,ad as B,a9 as p,a0 as L,af as c,ac as u,a7 as N,Q as h}from"./index-CjQoejyx.js";import{u as V,Q as $,b as m,a as f}from"./use-quasar-Du0Vn07S.js";import{a as F,Q as A}from"./QSeparator-N3_Bytks.js";import{Q as D}from"./QCard-qCF9DJJi.js";import{Q as E}from"./QInfiniteScroll-BvLgNQb4.js";import{a as P}from"./useUtils-BLGZp2D5.js";const T=S("Users",()=>{const _=g();async function o(r){return k.get("users",{params:r}).then(s=>s.data).catch(s=>{throw console.error("[UsersStore] - An error occurred while fetching via Users",s.message),s})}return{users:_,fetchUsers:o}}),O=C({__name:"UsersPage",setup(_){const o=V(),r=T(),s=g({offset:0,limit:20,total:0}),Q=(t,n)=>{if(console.log(t),r?.users?.length>=s.value.total){n(!0);return}y(),s.value.offset++,n()};async function y(){try{o.loading.show();const t=await r.fetchUsers(s.value);t&&(r?.users?.length?r.users.push(t.items):(r.users=t.items,s.value.total=t.total))}catch(t){console.error(t)}finally{o.loading.hide()}}function b(t){try{o.loading.show()}catch(n){console.error(n)}finally{o.notify({message:`Пользователь ${t.name} заблокирован`,color:"primary"}),o.loading.hide()}}return(t,n)=>{const v=w("q-item-action");return i(),d(E,{onLoad:Q,offset:250},{default:a(()=>[n[0]||(n[0]=I("h6",{class:"text-center q-mt-md q-mb-md"},"Пользователи",-1)),e(D,{class:"my-card q-ma-sm",flat:"",bordered:""},{default:a(()=>[(i(!0),q(x,null,B(p(r).users,(l,U)=>(i(),d(F,{key:U},{default:a(()=>[e($,null,{default:a(()=>[e(m,{avatar:""},{default:a(()=>[e(L,{color:"primary",name:"local_bar"})]),_:1}),e(m,null,{default:a(()=>[e(f,null,{default:a(()=>[c(u(l.name),1)]),_:2},1024),e(f,{caption:""},{default:a(()=>[c(u(l.telegram_id),1)]),_:2},1024)]),_:2},1024),e(m,null,{default:a(()=>[e(f,null,{default:a(()=>[c(u(l.username),1)]),_:2},1024),e(f,{caption:""},{default:a(()=>[c(u(l.role),1)]),_:2},1024)]),_:2},1024),e(v,null,{default:a(()=>[p(P)?(i(),d(h,{key:0,flat:"",round:"",color:"red",icon:"disabled_visible",onClick:j=>b(l)},null,8,["onClick"])):N("",!0),e(h,{flat:"",round:"",color:"primary",icon:"mode_edit"})]),_:2},1024)]),_:2},1024),e(A)]),_:2},1024))),128))]),_:1})]),_:1})}}});export{O as default};
