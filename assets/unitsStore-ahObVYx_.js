import{k as C,r as F,au as E,at as P,o as q,g as B,h as I,l as $,ao as R,L as A,q as V,O,az as Q,ar as j,as as f}from"./index-CjQoejyx.js";import{d as k}from"./QInput-e7IcEHXM.js";const L=C({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(a,{slots:m,emit:d}){const g=B(),i=F(null);let u=0;const e=[];function o(t){const c=typeof t=="boolean"?t:a.noErrorFocus!==!0,v=++u,U=(n,r)=>{d(`validation${n===!0?"Success":"Error"}`,r)},p=n=>{const r=n.validate();return typeof r.then=="function"?r.then(s=>({valid:s,comp:n}),s=>({valid:!1,comp:n,err:s})):Promise.resolve({valid:r,comp:n})};return(a.greedy===!0?Promise.all(e.map(p)).then(n=>n.filter(r=>r.valid!==!0)):e.reduce((n,r)=>n.then(()=>p(r).then(s=>{if(s.valid===!1)return Promise.reject(s)})),Promise.resolve()).catch(n=>[n])).then(n=>{if(n===void 0||n.length===0)return v===u&&U(!0),!0;if(v===u){const{comp:r,err:s}=n[0];if(s!==void 0&&console.error(s),U(!1,r),c===!0){const x=n.find(({comp:w})=>typeof w.focus=="function"&&R(w.$)===!1);x!==void 0&&x.comp.focus()}}return!1})}function l(){u++,e.forEach(t=>{typeof t.resetValidation=="function"&&t.resetValidation()})}function y(t){t!==void 0&&A(t);const c=u+1;o().then(v=>{c===u&&v===!0&&(a.onSubmit!==void 0?d("submit",t):t?.target!==void 0&&typeof t.target.submit=="function"&&t.target.submit())})}function S(t){t!==void 0&&A(t),d("reset"),V(()=>{l(),a.autofocus===!0&&a.noResetFocus!==!0&&h()})}function h(){k(()=>{if(i.value===null)return;(i.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||i.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||i.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(i.value.querySelectorAll("[tabindex]"),c=>c.tabIndex!==-1))?.focus({preventScroll:!0})})}O(Q,{bindComponent(t){e.push(t)},unbindComponent(t){const c=e.indexOf(t);c!==-1&&e.splice(c,1)}});let b=!1;return E(()=>{b=!0}),P(()=>{b===!0&&a.autofocus===!0&&h()}),q(()=>{a.autofocus===!0&&h()}),Object.assign(g.proxy,{validate:o,resetValidation:l,submit:y,reset:S,focus:h,getValidationComponents:()=>e}),()=>I("form",{class:"q-form",ref:i,onSubmit:y,onReset:S},$(m.default))}}),M=j("Units",()=>{const a=F();async function m(e){return f.post("units",e).then(o=>o.data).catch(o=>{throw console.error("[UnitsStore] - An error occurred while createing via createUnit",o.message),o})}async function d(e){return f.get(`/units/${e}`).then(o=>o.data).catch(o=>{throw console.error("[UnitsStore] - An error occurred while fetching via fetchUnitsById",o.message),o})}async function g(){return f.get("units").then(e=>{a.value=e.data}).catch(e=>{throw console.error("[UnitsStore] - An error occurred while fetching via fetchUnits",e.message),e})}async function i(e,o){return f.put(`/units/${e}`,{data:o}).then(l=>l.data).catch(l=>{throw console.error("[UnitsStore] - An error occurred while fetching via updateUnit",l.message),l})}async function u(e){return f.delete(`units/${e}`).then(o=>o.data).catch(o=>{throw console.error("[UnitsStore] - An error occurred while deleting via deleteUnit",o.message),o})}return{createUnit:m,fetchUnitsById:d,fetchUnits:g,updateUnit:i,deleteUnit:u,units:a}});export{L as Q,M as u};
