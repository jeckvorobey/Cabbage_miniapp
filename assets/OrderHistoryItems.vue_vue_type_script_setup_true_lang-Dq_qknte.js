import{Q as D,a as f,b as n}from"./QItem-CDNw1yBw.js";import{Q as b}from"./QList-C6U-Gmfn.js";import{Q as M}from"./QBtnDropdown-mvQ9i95i.js";import{V as O,W as T,a1 as C,Y as d,$ as t,Z as e,a2 as k,a3 as g,X as p,ab as N,a5 as o,a6 as c,a4 as E,a7 as V,z as w}from"./index-CK0ElmSy.js";import{C as G}from"./ClosePopup-B68BiOGn.js";import{u as R,d as $}from"./use-quasar-BMwnSylD.js";import{u as P}from"./orderStore-zH59pHZU.js";var s=(r=>(r.CREATED="created",r.ASSEMBLING="assembling",r.DELIVERING="delivering",r.COMPLETED="completed",r.CANCELLED="cancelled",r))(s||{});const Z=O({__name:"OrderHistoryItems",props:{orderData:{},adminMode:{type:Boolean}},setup(r){const m=R(),y=P(),L=[{label:"создан",value:s.CREATED},{label:"собирается",value:s.ASSEMBLING},{label:"в пути",value:s.DELIVERING},{label:"завершён",value:s.COMPLETED},{label:"отменён",value:s.CANCELLED}];function I(l,a){m.dialog({cancel:!0,message:"Вы уверенны что хотите изменить статус?",persistent:!0,title:"Смена статуса"}).onOk(()=>{v(l,a)})}async function v(l,a){try{m.loading.show(),await y.updateOrderStatus(l,a)&&m.notify({color:"primary",message:"Статус успешно изменен"})}catch(i){console.error(i)}finally{m.loading.hide()}}function Q(l){return L.find(i=>i.value===l)?.label}function S(l){m.dialog({cancel:!0,message:"Вы уверенны что хотите отменить заказ?",persistent:!0,title:"Отмена заказа"}).onOk(()=>{v(l,s.CANCELLED)})}return(l,a)=>{const i=T("q-item-action");return d(),C("div",null,[t(b,null,{default:e(()=>[(d(!0),C(k,null,g(l.orderData,(u,A)=>(d(),p(D,{key:A,class:"border-bot"},{default:e(()=>[t(f,null,{default:e(()=>[t(n,{caption:"",lines:"2"},{default:e(()=>[...a[0]||(a[0]=[o("Дата",-1)])]),_:1}),t(n,null,{default:e(()=>[o(c(E($)(u.order_date)),1)]),_:2},1024)]),_:2},1024),t(f,null,{default:e(()=>[t(n,{caption:"",lines:"2"},{default:e(()=>[...a[1]||(a[1]=[o("Имя",-1)])]),_:1}),t(n,null,{default:e(()=>[o(c(u.user.full_name),1)]),_:2},1024)]),_:2},1024),t(f,null,{default:e(()=>[t(n,{caption:"",lines:"2"},{default:e(()=>[...a[2]||(a[2]=[o("Статус",-1)])]),_:1}),t(n,null,{default:e(()=>[o(c(Q(u.status)),1)]),_:2},1024)]),_:2},1024),t(f,null,{default:e(()=>[t(n,{caption:"",lines:"2"},{default:e(()=>[...a[3]||(a[3]=[o("Общая сумма",-1)])]),_:1}),t(n,null,{default:e(()=>[o(c(u.total_amount),1)]),_:2},1024)]),_:2},1024),l.adminMode?(d(),p(i,{key:0},{default:e(()=>[t(M,{color:"green",dense:""},{default:e(()=>[(d(),C(k,null,g(L,(_,B)=>t(b,{key:B},{default:e(()=>[V((d(),p(D,{clickable:"",onClick:q=>I(u.id,_.value)},{default:e(()=>[t(f,null,{default:e(()=>[t(n,null,{default:e(()=>[o(c(_.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])),[[G]])]),_:2},1024)),64))]),_:2},1024)]),_:2},1024)):N("",!0),!l.adminMode&&(u.status===E(s).CREATED||u.status===E(s).ASSEMBLING)?(d(),p(i,{key:1},{default:e(()=>[t(w,{round:"",color:"deep-orange",icon:"close",onClick:_=>S(u.id)},null,8,["onClick"])]),_:2},1024)):N("",!0)]),_:2},1024))),128))]),_:1})])}}});export{Z as _};
