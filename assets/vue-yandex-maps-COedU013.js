import{w as b,k as w,bw as pe,ak as oe,Z as U,bx as re,am as h,r as A,e as P,V as I,O as M,h as z,t as O,g as K,i as V,D as j,bb as N,cb as le,af as fe,by as me,bz as ye,bv as ve,bA as be,bB as ge,bC as he,X as we,aW as xe,bD as Se,bE as je,bd as Oe,bF as _e,bG as Me,bH as ke,a4 as Re,a5 as Ce,L as Le,N as Te,bI as Pe,a6 as Ye,_ as Ee,bJ as Ae,bK as Ie,bL as ze,bM as Ve,bN as We,ap as De,o as Ne,aG as Be,aN as Fe,f as Ge,bO as $e,bP as He,bQ as Ue,bR as Ke,bc as qe,aO as Xe,M as Ze,bS as Je,Y as Qe,a3 as et,bT as tt,bU as at,bV as nt,bW as it,bX as st,bY as ot,$ as rt,ab as lt,bZ as ut,b_ as ct,ba as dt,b$ as pt,c0 as ft,c1 as mt,c2 as yt,c3 as vt,c4 as bt,c5 as gt,c6 as ht,c7 as wt,ah as xt,c8 as St,ao as jt,c9 as Ot,ca as _t,cc as Mt,cd as kt,ai as Rt,ce as Ct,a1 as Lt,cf as Tt}from"./index-hzzl6ab0.js";/**
* vue v3.5.20
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const Pt=Object.freeze(Object.defineProperty({__proto__:null,BaseTransition:be,BaseTransitionPropsValidators:ge,Comment:he,EffectScope:ut,Fragment:we,KeepAlive:xe,ReactiveEffect:ct,Static:Se,Teleport:je,Text:Oe,Transition:fe,TransitionGroup:me,callWithAsyncErrorHandling:_e,callWithErrorHandling:Me,camelize:Mt,capitalize:kt,cloneVNode:ke,computed:P,createApp:ye,createBlock:Re,createCommentVNode:Ce,createElementBlock:Le,createElementVNode:Te,createRenderer:Pe,createTextVNode:Ye,createVNode:Ee,defineComponent:I,effectScope:dt,getCurrentInstance:V,getCurrentScope:pt,getTransitionRawChildren:Ae,guardReactiveProps:Ie,h:w,handleError:ze,hasInjectionContext:Ve,inject:M,isProxy:ft,isReactive:mt,isReadonly:yt,isRef:N,isShallow:vt,isVNode:We,markRaw:bt,mergeProps:De,nextTick:O,normalizeClass:Rt,normalizeStyle:Ct,onActivated:Ne,onBeforeMount:Be,onBeforeUnmount:K,onBeforeUpdate:Fe,onDeactivated:Ge,onErrorCaptured:$e,onMounted:z,onRenderTracked:He,onRenderTriggered:Ue,onScopeDispose:gt,onServerPrefetch:Ke,onUnmounted:qe,onUpdated:Xe,onWatcherCleanup:ht,openBlock:Ze,provide:j,proxyRefs:wt,queuePostFlushCb:Je,reactive:xt,readonly:St,ref:A,renderList:Qe,resolveComponent:et,resolveTransitionHooks:tt,setBlockTracking:at,setTransitionHooks:nt,shallowReactive:jt,shallowReadonly:Ot,shallowRef:h,ssrContextKey:it,toDisplayString:Lt,toHandlerKey:Tt,toRaw:oe,toRefs:_t,triggerRef:le,unref:U,useSSRContext:st,useTransitionState:ot,vShow:ve,version:re,watch:b,withCtx:rt,withDirectives:lt},Symbol.toStringTag,{value:"Module"}));var s;(e=>{e.settings=B({apikey:""}),e.isReadyToInit=te(()=>!!e.settings.value.apikey),e.ymaps=()=>ymaps3,e.script=h(null);class n extends Error{constructor(i){super(i),this.message=i,this.name="YandexMapException"}}e.YandexMapException=n,e.loadStatus=B("pending"),e.isLoaded=te(()=>e.loadStatus.value==="loaded"||e.loadStatus.value==="error"),e.loadError=B(null);function t(){return ymaps3.import("@yandex/ymaps3-layers-extra")}e.importLayersExtra=t})(s||(s={}));function B(e){return typeof window>"u"?{value:e,__v_isRef:!0}:A(e)}function te(e,n){return typeof window>"u"?{get value(){return e()},__v_isRef:!0}:P(e,n)}function _(e){return e=oe(U(e)),Array.isArray(e)?e.map(n=>_(n)):!e||typeof e!="object"||e?.constructor!==void 0&&e?.constructor!==Object?e:Object.keys(e).reduce((n,t)=>{const a=e[t];return n[t]=_(a),n},{})}function Yt(){return typeof process<"u"&&process.dev}function Et({text:e,isInternal:n,warn:t}){return t&&(e=`Warning: ${e}`),n&&(e+=" This is likely Vue Yandex Maps internal bug.",Yt()&&(e+=" You can report this bug here: https://github.com/yandex-maps-unofficial/vue-yandex-maps/issues/new/choose")),new s.YandexMapException(e)}function m(e){const n=Et(e);if(e.warn)console.warn(n);else throw n}function ue(e,n){for(const[t,a]of Object.entries(e))n.includes(t)&&delete e[t],a&&typeof a=="object"&&!Array.isArray(a)&&(ue(a,n),Object.keys(a).length||delete e[t])}function q(){return re.startsWith("2")}let D;async function At(){if(D===void 0){if(q()){D=null;return}D=(await pe(async()=>{const{Fragment:e}=await Promise.resolve().then(()=>Pt);return{Fragment:e}},void 0)).Fragment}}function It(e,n){return q()?w("div",n,e):w(D,n,e)}function zt(e){return q()&&e?.length>1?w("div",e):e}function ae(e){return typeof e=="function"?e():U(e)}const Vt=s.YandexMapException,ne={apikey:!0,servicesApikeys:!0,lang:!0,initializeOn:!0,importModules:!0,version:!0,strictMode:!0,domain:!0,mapsRenderWaitDuration:!0,mapsScriptWaitDuration:!0,scriptAttributes:!0,cdnLibraryLoading:!0};function $(){return new Promise((e,n)=>{if(typeof ymaps3<"u")return s.loadStatus.value!=="loaded"&&(s.loadStatus.value="loaded"),e();if(typeof window>"u")return n(new Vt("You must call initYmaps on Client Side only"));if(s.loadStatus.value==="loading"){const o=b(s.loadStatus,y=>{s.isLoaded.value&&(o(),y==="error"&&n(s.loadError),y==="loaded"&&e())},{immediate:!0});return}s.loadStatus.value="loading";const t=s.settings.value;t.apikey||m({text:"apikey was not set for Yandex Maps initialization. Ensure you have attached needed plugins or called createYmapsOptions with apikey. If you need delayed init, please use VueYandexMaps.isReadyToInit computed as v-if."});const a=document.createElement("SCRIPT");s.script.value=a;const i=new URL(`${t.domain}/${t.version}/`);i.searchParams.set("lang",t.lang||"ru_RU"),i.searchParams.set("apikey",t.apikey);const c={async:"",defer:"",referrerpolicy:"strict-origin-when-cross-origin",type:"text/javascript",id:"vue-yandex-maps",src:i.toString(),...t.scriptAttributes||{}};for(const o in c)c[o]!==!1&&a.setAttribute(o,c[o]);document.head.appendChild(a),a.onload=async()=>{try{await s.ymaps().ready,t.servicesApikeys&&Object.keys(t.servicesApikeys).length>0&&s.ymaps().getDefaultConfig().setApikeys(t.servicesApikeys),typeof t.strictMode=="boolean"&&(s.ymaps().strictMode=t.strictMode),t.importModules&&await Promise.all(t.importModules.map(o=>s.ymaps().import(o))),t.cdnLibraryLoading?.enabled!==!1&&s.ymaps().import.registerCdn(t.cdnLibraryLoading?.url||"https://cdn.jsdelivr.net/npm/{package}",[...["@yandex/ymaps3-default-ui-theme@latest","@yandex/ymaps3-resizer@latest","@yandex/ymaps3-minimap@latest","@yandex/ymaps3-context-menu@latest","@yandex/ymaps3-drawer-control@latest","@yandex/ymaps3-signpost@latest","@yandex/ymaps3-spinner@latest","@yandex/ymaps3-world-utils@latest"].filter(o=>!(t.cdnLibraryLoading?.extendLibraries??[]).some(y=>y.startsWith("@yandex")?y.split("@")[1]===o.split("@")[1]:!1)),...t.cdnLibraryLoading?.extendLibraries??[]]),s.loadStatus.value="loaded",e()}catch(o){s.loadStatus.value="error",s.loadError.value=o,n(o)}},a.onerror=o=>{s.loadError.value=o,n(o)}})}function Wt(e,n=!1){if(s.isReadyToInit.value)return s.settings.value;const t={lang:"ru_RU",initializeOn:"onComponentMount",importModules:[],version:"v3",strictMode:!1,domain:"https://api-maps.yandex.ru",mapsRenderWaitDuration:!0,mapsScriptWaitDuration:!0,servicesApikeys:null,scriptAttributes:{},cdnLibraryLoading:{},...e};t.apikey||m({text:"You must specify apikey for createYmapsOptions"});const a=Object.keys(t).filter(i=>!(i in ne));return a.length&&m({text:`You have passed unknown keys to createYmapsOptions: ${a.join(", ")}. Only ${Object.keys(ne).join(", ")} are allowed.`}),typeof window>"u"||(s.settings.value=t),t}function $t(e){return{install(n){Wt(e),e.initializeOn==="onPluginInit"&&$().catch(console.error)}}}const F=e=>e instanceof Date,Dt=e=>Object.keys(e).length===0,H=e=>e!=null&&typeof e=="object",ie=(e,...n)=>Object.prototype.hasOwnProperty.call(e,...n),G=e=>H(e)&&Dt(e),Nt=()=>Object.create(null),X=(e,n)=>{if(e===n)return{};if(!H(e)||!H(n))return n;const t=Object.keys(e).reduce((a,i)=>(ie(n,i)||(a[i]=void 0),a),Nt());return F(e)||F(n)?e.valueOf()==n.valueOf()?{}:n:Object.keys(n).reduce((a,i)=>{if(!ie(e,i))return a[i]=n[i],a;const c=X(e[i],n[i]);return G(c)&&!F(c)&&(G(e[i])||!G(n[i]))||(a[i]=c),a},t)};function ce(){V()||m({text:"injectMap must be only called on runtime.",isInternal:!0});const e=M("map");return(!e||!N(e))&&m({text:"Was not able to inject valid map in injectMap.",isInternal:!0}),e}function Bt(){V()||m({text:"injectLayers must be only called on runtime.",isInternal:!0});const e=M("layers");return(!e||!N(e))&&m({text:"Was not able to inject valid layers in injectLayers.",isInternal:!0}),e}async function Ft({timeoutCallback:e,waitDuration:n}={}){if(typeof window>"u"&&m({text:"waitTillYmapInit cannot be called on SSR.",isInternal:!0}),!(typeof ymaps3<"u"))return new Promise((t,a)=>{if(typeof ymaps3>"u"){let i;n=typeof n<"u"?n:s.settings.value.mapsScriptWaitDuration,n!==!1&&(i=setTimeout(()=>{e?.(i,!0),a(new s.YandexMapException("Was not able to wait for map initialization in waitTillYmapInit. Ensure that map was initialized. You can change this behavior by using mapsScriptWaitDuration."))},typeof n=="number"?n:5e3),e?.(i,!1)),b(s.isLoaded,()=>{i&&(clearTimeout(i),e?.(i,!0)),s.loadStatus.value==="loaded"?t():a(s.loadError)},{immediate:!0})}else t()})}async function de({map:e,timeoutCallback:n,waitDuration:t}={}){!e&&!V()&&m({text:"onMapInit must be only called on runtime.",isInternal:!0}),typeof window>"u"&&m({text:"waitTillMapInit cannot be called on SSR.",isInternal:!0});const a=e||ce();if(!a.value)return new Promise((i,c)=>{let o;t=typeof t<"u"?t:s.settings.value.mapsRenderWaitDuration,t!==!1&&(o=setTimeout(()=>{n?.(o,!0),c(new s.YandexMapException("Was not able to wait for map initialization in waitTillMapInit. You can change this behavior by using mapsRenderWaitDuration."))},typeof t=="number"?t:5e3),n?.(o,!1));let y;y=b(a,()=>{a.value&&(y?.(),o&&(clearTimeout(o),n?.(o,!0)),i())},{immediate:!0})})}function se({children:e,isMercator:n,root:t}){t||m({text:"Failed to execute deleteMapChild due to destroyed root",isInternal:!0}),e&&!n?typeof t?.value=="object"&&Array.isArray(t.value)?t.value=t.value.filter(a=>a!==e):t.value?.removeChild(e):t.value&&e&&n&&"update"in t.value&&t.value.update({projection:void 0})}const Ht=I({name:"YandexMap",props:{modelValue:{type:Object,default:null},value:{type:Object,default:null},tag:{type:String,default:"div"},width:{type:String,default:"100%"},height:{type:String,default:"100%"},zIndex:{type:Number,default:0},settings:{type:Object,required:!0},readonlySettings:{type:Boolean,default:!1},realSettingsLocation:{type:Boolean,default:!1},layers:{type:Array,default:(()=>[])},cursorGrab:{type:Boolean,default:!1}},emits:{input(e){return!e||typeof ymaps3>"u"||e instanceof ymaps3.YMap},"update:modelValue"(e){return!e||typeof ymaps3>"u"||e instanceof ymaps3.YMap}},slots:Object,setup(e,{slots:n,emit:t}){const a=h(null),i=h(null),c=h([]),o=h(null),y=h(null),g=h(!1),u=A(0);j("map",a),j("layers",c),j("projection",o),j("needsToHold",u),t("input",null),t("update:modelValue",null);const k=P(()=>({...e.settings,projection:void 0})),W=async()=>{e.settings.location||m({text:"You must specify location in YandexMap settings"}),a.value&&a.value.destroy();const d=y.value;if(!d)return;const r=k.value;o.value&&(r.projection=o.value),a.value=new ymaps3.YMap(d,r,[...c.value,...e.layers]),t("input",a.value),t("update:modelValue",a.value)};let R,C,l=null;async function p(){await de({map:a,timeoutCallback:(d,r)=>{r?l=null:l=d}}).catch(()=>{}),a.value&&(e.cursorGrab?(R=new ymaps3.YMapListener({onActionStart:d=>{d.type==="drag"&&e.cursorGrab&&i.value?.classList.add("__ymap--grabbing")},onActionEnd:d=>{d.type==="drag"&&i.value?.classList.remove("__ymap--grabbing")}}),a.value.addChild(R)):R&&a.value.removeChild(R))}let S=!1;return b(s.loadStatus,async d=>{if(d==="pending"){S=!0,g.value=!1;return}d!=="loaded"&&!S||(g.value=!0,await O(),u.value&&await new Promise(r=>b(u,()=>{u.value||r()},{immediate:!0})),await W())}),z(async()=>{const d=()=>{C?.();let r=_(k);C=b(k,L=>{if(!a.value)return;const v=_(L);e.realSettingsLocation&&v.location&&("center"in v.location&&"center"in r.location?r.location.center=a.value.center:"bounds"in v.location&&"bounds"in r.location&&(r.location.bounds=a.value.bounds),"zoom"in v.location&&"zoom"in r.location&&(r.location.zoom=a.value.zoom));const Y=Object.keys(X(r,v));if(Y.length===0)return;const T={...v};for(const f in T)Y.includes(f)||delete T[f];r=v,a.value?.update(T)},{deep:!0})};if(e.readonlySettings||d(),b(()=>e.readonlySettings,r=>{r?d():C?.()}),b(()=>e.cursorGrab,p,{immediate:!0}),await At(),!s.isLoaded.value){if(s.settings.value.initializeOn==="onComponentMount")try{await $()}catch(r){console.error("An error occured while initializing Yandex Map with onComponentMount setting"),console.error(r);return}else(s.loadStatus.value==="loading"||s.settings.value.initializeOn==="onPluginInit")&&(s.settings.value.initializeOn==="onPluginInit"&&s.loadStatus.value!=="loading"&&await O(),await $());s.isLoaded.value||m({text:"You have set up <yandex-map> component without initializing Yandex maps. Please check initializeOn setting or call initYmaps manually before registering this component."})}g.value=!0,await O(),u.value&&await new Promise(r=>b(u,()=>{u.value||r()},{immediate:!0})),await W()}),K(()=>{l&&clearTimeout(l),a.value&&a.value.destroy(),a.value=null,t("input",a.value),t("update:modelValue",a.value)}),()=>{const d={class:["__ymap",{"__ymap--grab":e.cursorGrab}],ref:i,style:{width:e.width,height:e.height,"z-index":e.zIndex.toString()}},r=w("div",{class:"__ymap_container",ref:y}),L={class:"__ymap_slots",style:{display:"none"}};return g.value?w(e.tag,d,[r,w("div",L,n.default?.({}))]):w(e.tag,d,[r,w("div",L)])}}});async function Z({returnOnly:e,willDeleteByHand:n,strictMapRoot:t,requiredImport:a,createFunction:i,settings:c,settingsUpdateIgnoreKeys:o,settingsUpdateFull:y,isLayer:g,isMercator:u,isMapRoot:k,mapRootRef:W,duplicateInit:R,index:C}){V()||m({text:"setupMapChildren must be only called on runtime.",isInternal:!0});try{const l=h(),p=M("mapRoot",null),S=M("mapRootInitPromises",null);let d;const r=ce(),L=Bt();let v=null;const Y=(f,x)=>{v||(v=new Set),x?v.delete(f):v.add(f)};if(k&&!R&&(j("mapRoot",W||l),d=h([]),j("mapRootInitPromises",d)),!e&&!n&&K(()=>{l.value&&se({children:l.value,isMercator:u,root:p?.value?p:r}),v?.size&&(v.forEach(f=>clearTimeout(f)),v.clear())}),c){let f=_(c);b(c,x=>{if(!x)return;if(y){console.log(x),l.value&&"update"in l.value&&l.value.update(x);return}const J=Object.keys(X(f,x));if(J.length===0)return;const E=_(x);for(const ee in E)J.includes(ee)||delete E[ee];const Q=o&&(N(o)?o.value:o);Q&&ue(E,Q),Object.keys(E).length!==0&&(f=_(x),l.value&&"update"in l.value&&l.value.update(E))},{deep:!0})}!e&&!u&&b(()=>ae(C),f=>{!l.value||!r.value||(se({children:l.value,isMercator:u,root:p?.value?p:r}),typeof p?.value=="object"&&Array.isArray(p.value)?p.value=[...p.value,l.value]:(p?.value||r.value).addChild(l.value,f))}),!g&&!u?(await de({timeoutCallback:Y}),r.value||m({text:"map is undefined in setupMapChildren. Please verify that Yandex Maps were initialized successfully and you only use components inside <yandex-map>."})):await Ft({timeoutCallback:Y}),t&&(p?.value||await O(),p?.value||m({text:"mapRoot is undefined in setupMapChildren. Please verify that you are using component inside it's root: for example, don't use Controls outside <yandex-map-controls>."})),k&&(await O(),await Promise.all(d?.value||[]));let T;if(a){const f=a();S?.value&&S.value.push(Promise.resolve(f)),T=await f}if(l.value=i(T),!e&&r.value&&!u){S?.value&&(await Promise.all(S.value),a||await O());const f=ae(C);typeof p?.value=="object"&&Array.isArray(p.value)?(p.value.splice(f??p.value.length,0,l.value),le(p)):(p?.value||r.value).addChild(l.value,f)}else g?L.value.push(l.value):u&&r.value&&r.value.update({projection:l.value});return l.value}catch(l){throw console.error("Error during map children loading",l),l}}const Ut=I({name:"YandexMapDefaultFeaturesLayer",props:{value:{type:Object,default:null},modelValue:{type:Object,default:null},settings:{type:Object,default:()=>({})}},emits:{input(e){return!0},"update:modelValue"(e){return!0}},slots:Object,setup(e,{slots:n,emit:t}){const a=M("needsToHold");a.value++;let i;return z(async()=>{i=await Z({createFunction:()=>new ymaps3.YMapDefaultFeaturesLayer(e.settings||{}),settings:P(()=>e.settings),isLayer:!0}),t("input",i),t("update:modelValue",i),a.value--}),()=>zt(n.default?.({}))}}),Kt=I({name:"YandexMapDefaultSchemeLayer",props:{value:{type:Object,default:null},modelValue:{type:Object,default:null},settings:{type:Object,default:()=>({})}},emits:{input(e){return!0},"update:modelValue"(e){return!0}},slots:Object,setup(e,{slots:n,emit:t}){const a=M("needsToHold");a.value++;let i;return z(async()=>{i=await Z({createFunction:()=>new ymaps3.YMapDefaultSchemeLayer(e.settings||{}),settings:P(()=>e.settings),isLayer:!0}),t("input",i),t("update:modelValue",i),a.value--}),()=>n.default?.({})}}),qt=I({name:"YandexMapDefaultMarker",inheritAttrs:!1,props:{value:{type:Object,default:null},modelValue:{type:Object,default:null},settings:{type:Object,required:!0}},emits:{input(e){return!0},"update:modelValue"(e){return!0}},slots:Object,setup(e,{slots:n,emit:t,attrs:a}){let i;const c=A(null),o=A(()=>{}),y=u=>(o.value=u,c.value),g=P(()=>{const u={...e.settings};return u.popup&&(typeof u.popup.content>"u"||u.popup.content==="fromSlot")&&c.value&&(u.popup={...u.popup,content:y}),u});return z(async()=>{e.settings.coordinates||m({text:"You must specify coordinates in YandexMapDefaultMarker settings"}),i=await Z({createFunction:({YMapDefaultMarker:u})=>new u(g.value),requiredImport:()=>ymaps3.import("@yandex/ymaps3-markers@0.0.1"),settings:g}),t("input",i),t("update:modelValue",i)}),b(c,()=>{c.value&&c.value.parentNode?.removeChild(c.value)}),()=>{if(n.popup)return It([w("div",{ref:c},n.popup?.({close:o.value}))])}}});export{Kt as _,Ut as a,qt as b,$t as c,Ht as d};
