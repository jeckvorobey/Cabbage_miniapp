import{k as oe,g as J,a as se,u as O,v as Te,_ as Me,c as D,h as _,l as He,av as Be,aw as Ke,ax as We,ay as Xe,r as k,K as ke,M as we,E as Ye,O as Ze,R as Je,w as Ge,n as et,i as tt,az as at,aA as ot,aB as be,aC as lt,ac as Ce,Q as Y,Z as rt,aD as nt,d as ce,ai as X,ah as L,aE as st,am as E,f as q,aF as ue,an as I,aj as ae,au as re,al as ie,aG as ze,X as ut,ar as Ue,o as it,ag as ne,ap as dt,F as ct,ao as ee,as as Fe,aH as De}from"./index-FiVUXmGD.js";import{u as Pe,Q as Ee,a as ft}from"./orderStore-DVPSluPr.js";import{Q as pt}from"./QInfiniteScroll-D-IZ8sGd.js";import{u as $e}from"./use-quasar-BK5dcviZ.js";import{Q as xe}from"./QSelect-BlT2rnlH.js";import{b as vt,h as Se,u as mt}from"./categoriesStore-CZzxbLdZ.js";import{u as Qe,Q as gt}from"./unitsStore-B4PYaYx4.js";import{C as _t}from"./ClosePopup-RwPN_dFR.js";import{_ as Re}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./QMenu-vdFMgmXi.js";import"./selection-DcDhta-M.js";const ht=oe({name:"QPage",props:{padding:Boolean,styleFn:Function},setup(t,{slots:i}){const{proxy:{$q:n}}=J(),a=se(Te,O);if(a===O)return console.error("QPage needs to be a deep child of QLayout"),O;if(se(Me,O)===O)return console.error("QPage needs to be child of QPageContainer"),O;const c=D(()=>{const F=(a.header.space===!0?a.header.size:0)+(a.footer.space===!0?a.footer.size:0);if(typeof t.styleFn=="function"){const B=a.isContainer.value===!0?a.containerHeight.value:n.screen.height;return t.styleFn(F,B)}return{minHeight:a.isContainer.value===!0?a.containerHeight.value-F+"px":n.screen.height===0?F!==0?`calc(100vh - ${F}px)`:"100vh":n.screen.height-F+"px"}}),f=D(()=>`q-page${t.padding===!0?" q-layout-padding":""}`);return()=>_("main",{class:f.value,style:c.value},He(i.default))}}),yt=oe({name:"QUploaderAddTrigger",setup(){const t=se(Be,O);return t===O&&console.error("QUploaderAddTrigger needs to be child of QUploader"),t}}),bt={...Ke,min:{type:Number,default:0},max:{type:Number,default:100},color:String,centerColor:String,trackColor:String,fontSize:String,rounded:Boolean,thickness:{type:Number,default:.2,validator:t=>t>=0&&t<=1},angle:{type:Number,default:0},showValue:Boolean,reverse:Boolean,instantFeedback:Boolean},de=50,Ae=2*de,je=Ae*Math.PI,Ft=Math.round(je*1e3)/1e3,Dt=oe({name:"QCircularProgress",props:{...bt,value:{type:Number,default:0},animationSpeed:{type:[String,Number],default:600},indeterminate:Boolean},setup(t,{slots:i}){const{proxy:{$q:n}}=J(),a=We(t),s=D(()=>{const u=(n.lang.rtl===!0?-1:1)*t.angle;return{transform:t.reverse!==(n.lang.rtl===!0)?`scale3d(-1, 1, 1) rotate3d(0, 0, 1, ${-90-u}deg)`:`rotate3d(0, 0, 1, ${u-90}deg)`}}),c=D(()=>t.instantFeedback!==!0&&t.indeterminate!==!0?{transition:`stroke-dashoffset ${t.animationSpeed}ms ease 0s, stroke ${t.animationSpeed}ms ease`}:""),f=D(()=>Ae/(1-t.thickness/2)),F=D(()=>`${f.value/2} ${f.value/2} ${f.value} ${f.value}`),B=D(()=>vt(t.value,t.min,t.max)),w=D(()=>t.max-t.min),p=D(()=>t.thickness/2*f.value),U=D(()=>{const u=(t.max-B.value)/w.value,e=t.rounded===!0&&B.value<t.max&&u<.25?p.value/2*(1-u/.25):0;return je*u+e});function d({thickness:u,offset:e,color:l,cls:v,rounded:h}){return _("circle",{class:"q-circular-progress__"+v+(l!==void 0?` text-${l}`:""),style:c.value,fill:"transparent",stroke:"currentColor","stroke-width":u,"stroke-dasharray":Ft,"stroke-dashoffset":e,"stroke-linecap":h,cx:f.value,cy:f.value,r:de})}return()=>{const u=[];t.centerColor!==void 0&&t.centerColor!=="transparent"&&u.push(_("circle",{class:`q-circular-progress__center text-${t.centerColor}`,fill:"currentColor",r:de-p.value/2,cx:f.value,cy:f.value})),t.trackColor!==void 0&&t.trackColor!=="transparent"&&u.push(d({cls:"track",thickness:p.value,offset:0,color:t.trackColor})),u.push(d({cls:"circle",thickness:p.value,offset:U.value,color:t.color,rounded:t.rounded===!0?"round":void 0}));const e=[_("svg",{class:"q-circular-progress__svg",style:s.value,viewBox:F.value,"aria-hidden":"true"},u)];return t.showValue===!0&&e.push(_("div",{class:"q-circular-progress__text absolute-full row flex-center content-center",style:{fontSize:t.fontSize}},i.default!==void 0?i.default():[_("div",B.value)])),_("div",{class:`q-circular-progress q-circular-progress--${t.indeterminate===!0?"in":""}determinate`,style:a.value,role:"progressbar","aria-valuemin":t.min,"aria-valuemax":t.max,"aria-valuenow":t.indeterminate===!0?void 0:B.value},Xe(i.internal,e))}}});function W(t,i,n,a){const s=[];return t.forEach(c=>{a(c)===!0?s.push(c):i.push({failedPropValidation:n,file:c})}),s}function te(t){t?.dataTransfer&&(t.dataTransfer.dropEffect="copy"),we(t)}const xt={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},St=["rejected"];function qt({editable:t,dnd:i,getFileInput:n,addFilesToQueue:a}){const{props:s,emit:c,proxy:f}=J(),F=k(null),B=D(()=>s.accept!==void 0?s.accept.split(",").map(r=>(r=r.trim(),r==="*"?"*/":(r.endsWith("/*")&&(r=r.slice(0,r.length-1)),r.toUpperCase()))):null),w=D(()=>parseInt(s.maxFiles,10)),p=D(()=>parseInt(s.maxTotalSize,10));function U(r){if(t.value)if(r!==Object(r)&&(r={target:null}),r.target?.matches('input[type="file"]')===!0)r.clientX===0&&r.clientY===0&&ke(r);else{const P=n();P!==r.target&&P?.click(r)}}function d(r){t.value&&r&&a(null,r)}function u(r,P,V,N){let g=Array.from(P||r.target.files);const x=[],$=()=>{x.length!==0&&c("rejected",x)};if(s.accept!==void 0&&B.value.indexOf("*/")===-1&&(g=W(g,x,"accept",y=>B.value.some(S=>y.type.toUpperCase().startsWith(S)||y.name.toUpperCase().endsWith(S))),g.length===0))return $();if(s.maxFileSize!==void 0){const y=parseInt(s.maxFileSize,10);if(g=W(g,x,"max-file-size",S=>S.size<=y),g.length===0)return $()}if(s.multiple!==!0&&g.length!==0&&(g=[g[0]]),g.forEach(y=>{y.__key=y.webkitRelativePath+y.lastModified+y.name+y.size}),N===!0){const y=V.map(S=>S.__key);g=W(g,x,"duplicate",S=>y.includes(S.__key)===!1)}if(g.length===0)return $();if(s.maxTotalSize!==void 0){let y=N===!0?V.reduce((S,R)=>S+R.size,0):0;if(g=W(g,x,"max-total-size",S=>(y+=S.size,y<=p.value)),g.length===0)return $()}if(typeof s.filter=="function"){const y=s.filter(g);g=W(g,x,"filter",S=>y.includes(S))}if(s.maxFiles!==void 0){let y=N===!0?V.length:0;if(g=W(g,x,"max-files",()=>(y++,y<=w.value)),g.length===0)return $()}if($(),g.length!==0)return g}function e(r){te(r),i.value!==!0&&(i.value=!0)}function l(r){we(r),(r.relatedTarget!==null||Ye.is.safari!==!0?r.relatedTarget!==F.value:document.elementsFromPoint(r.clientX,r.clientY).includes(F.value)===!1)===!0&&(i.value=!1)}function v(r){te(r);const P=r.dataTransfer.files;P.length!==0&&a(null,P),i.value=!1}function h(r){if(i.value===!0)return _("div",{ref:F,class:`q-${r}__dnd absolute-full`,onDragenter:te,onDragover:te,onDragleave:l,onDrop:v})}return Object.assign(f,{pickFiles:U,addFiles:d}),{pickFiles:U,addFiles:d,onDragover:e,onDragleave:l,processFiles:u,getDndNode:h,maxFilesNumber:w,maxTotalSizeNumber:p}}function qe(t){return(t*100).toFixed(2)+"%"}const Bt={...Ze,...xt,label:String,color:String,textColor:String,square:Boolean,flat:Boolean,bordered:Boolean,noThumbnails:Boolean,thumbnailFit:{type:String,default:"cover"},autoUpload:Boolean,hideUploadBtn:Boolean,disable:Boolean,readonly:Boolean},Le=[...St,"start","finish","added","removed"];function kt(t,i){const n=J(),{props:a,slots:s,emit:c,proxy:f}=n,{$q:F}=f,B=Je(a,F);function w(o,b,C){if(o.__status=b,b==="idle"){o.__uploaded=0,o.__progress=0,o.__sizeLabel=Se(o.size),o.__progressLabel="0.00%";return}if(b==="failed"){f.$forceUpdate();return}o.__uploaded=b==="uploaded"?o.size:C,o.__progress=b==="uploaded"?1:Math.min(.9999,o.__uploaded/o.size),o.__progressLabel=qe(o.__progress),f.$forceUpdate()}const p=D(()=>a.disable!==!0&&a.readonly!==!0),U=k(!1),d=k(null),u=k(null),e={files:k([]),queuedFiles:k([]),uploadedFiles:k([]),uploadedSize:k(0),updateFileStatus:w,isAlive:()=>lt(n)===!1},{pickFiles:l,addFiles:v,onDragover:h,onDragleave:r,processFiles:P,getDndNode:V,maxFilesNumber:N,maxTotalSizeNumber:g}=qt({editable:p,dnd:U,getFileInput:me,addFilesToQueue:ge});Object.assign(e,t({props:a,slots:s,emit:c,helpers:e,exposeApi:o=>{Object.assign(e,o)}})),e.isBusy===void 0&&(e.isBusy=k(!1));const x=k(0),$=D(()=>x.value===0?0:e.uploadedSize.value/x.value),y=D(()=>qe($.value)),S=D(()=>Se(x.value)),R=D(()=>p.value===!0&&e.isUploading.value!==!0&&(a.multiple===!0||e.queuedFiles.value.length===0)&&(a.maxFiles===void 0||e.files.value.length<N.value)&&(a.maxTotalSize===void 0||x.value<g.value)),m=D(()=>p.value===!0&&e.isBusy.value!==!0&&e.isUploading.value!==!0&&e.queuedFiles.value.length!==0);rt(Be,he);const T=D(()=>"q-uploader column no-wrap"+(B.value===!0?" q-uploader--dark q-dark":"")+(a.bordered===!0?" q-uploader--bordered":"")+(a.square===!0?" q-uploader--square no-border-radius":"")+(a.flat===!0?" q-uploader--flat no-shadow":"")+(a.disable===!0?" disabled q-uploader--disable":"")+(U.value===!0?" q-uploader--dnd":"")),M=D(()=>"q-uploader__header"+(a.color!==void 0?` bg-${a.color}`:"")+(a.textColor!==void 0?` text-${a.textColor}`:""));Ge(e.isUploading,(o,b)=>{b===!1&&o===!0?c("start"):b===!0&&o===!1&&c("finish")});function H(){a.disable===!1&&(e.abort(),e.uploadedSize.value=0,x.value=0,ve(),e.files.value=[],e.queuedFiles.value=[],e.uploadedFiles.value=[])}function Q(){a.disable===!1&&pe(["uploaded"],()=>{e.uploadedFiles.value=[]})}function G(){pe(["idle","failed"],({size:o})=>{x.value-=o,e.queuedFiles.value=[]})}function pe(o,b){if(a.disable===!0)return;const C={files:[],size:0},A=e.files.value.filter(z=>o.indexOf(z.__status)===-1?!0:(C.size+=z.size,C.files.push(z),z.__img!==void 0&&window.URL.revokeObjectURL(z.__img.src),!1));C.files.length!==0&&(e.files.value=A,b(C),c("removed",C.files))}function le(o){a.disable||(o.__status==="uploaded"?e.uploadedFiles.value=e.uploadedFiles.value.filter(b=>b.__key!==o.__key):o.__status==="uploading"?o.__abort():x.value-=o.size,e.files.value=e.files.value.filter(b=>b.__key!==o.__key?!0:(b.__img!==void 0&&window.URL.revokeObjectURL(b.__img.src),!1)),e.queuedFiles.value=e.queuedFiles.value.filter(b=>b.__key!==o.__key),c("removed",[o]))}function ve(){e.files.value.forEach(o=>{o.__img!==void 0&&window.URL.revokeObjectURL(o.__img.src)})}function me(){return u.value||d.value.getElementsByClassName("q-uploader__input")[0]}function ge(o,b){const C=P(o,b,e.files.value,!0),A=me();A!=null&&(A.value=""),C!==void 0&&(C.forEach(z=>{if(e.updateFileStatus(z,"idle"),x.value+=z.size,a.noThumbnails!==!0&&z.type.toUpperCase().startsWith("IMAGE")){const ye=new Image;ye.src=window.URL.createObjectURL(z),z.__img=ye}}),e.files.value=e.files.value.concat(C),e.queuedFiles.value=e.queuedFiles.value.concat(C),c("added",C),a.autoUpload===!0&&e.upload())}function _e(){m.value===!0&&e.upload()}function Z(o,b,C){if(o===!0){const A={type:"a",key:b,icon:F.iconSet.uploader[b],flat:!0,dense:!0};let z;return b==="add"?(A.onClick=l,z=he):A.onClick=C,_(Y,A,z)}}function he(){return _("input",{ref:u,class:"q-uploader__input overflow-hidden absolute-full",tabindex:-1,type:"file",title:"",accept:a.accept,multiple:a.multiple===!0?"multiple":void 0,capture:a.capture,onMousedown:ke,onClick:l,onChange:ge})}function Oe(){return s.header!==void 0?s.header(K):[_("div",{class:"q-uploader__header-content column"},[_("div",{class:"flex flex-center no-wrap q-gutter-xs"},[Z(e.queuedFiles.value.length!==0,"removeQueue",G),Z(e.uploadedFiles.value.length!==0,"removeUploaded",Q),e.isUploading.value===!0?_(be,{class:"q-uploader__spinner"}):null,_("div",{class:"col column justify-center"},[a.label!==void 0?_("div",{class:"q-uploader__title"},[a.label]):null,_("div",{class:"q-uploader__subtitle"},[S.value+" / "+y.value])]),Z(R.value,"add"),Z(a.hideUploadBtn===!1&&m.value===!0,"upload",e.upload),Z(e.isUploading.value,"clear",e.abort)])])]}function Ie(){return s.list!==void 0?s.list(K):e.files.value.map(o=>_("div",{key:o.__key,class:"q-uploader__file relative-position"+(a.noThumbnails!==!0&&o.__img!==void 0?" q-uploader__file--img":"")+(o.__status==="failed"?" q-uploader__file--failed":o.__status==="uploaded"?" q-uploader__file--uploaded":""),style:a.noThumbnails!==!0&&o.__img!==void 0?{backgroundImage:'url("'+o.__img.src+'")',backgroundSize:a.thumbnailFit}:null},[_("div",{class:"q-uploader__file-header row flex-center no-wrap"},[o.__status==="failed"?_(Ce,{class:"q-uploader__file-status",name:F.iconSet.type.negative,color:"negative"}):null,_("div",{class:"q-uploader__file-header-content col"},[_("div",{class:"q-uploader__title"},[o.name]),_("div",{class:"q-uploader__subtitle row items-center no-wrap"},[o.__sizeLabel+" / "+o.__progressLabel])]),o.__status==="uploading"?_(Dt,{value:o.__progress,min:0,max:1,indeterminate:o.__progress===0}):_(Y,{round:!0,dense:!0,flat:!0,icon:F.iconSet.uploader[o.__status==="uploaded"?"done":"clear"],onClick:()=>{le(o)}})])]))}et(()=>{e.isUploading.value===!0&&e.abort(),e.files.value.length!==0&&ve()});const K={};for(const o in e)tt(e[o])===!0?at(K,o,()=>e[o].value):K[o]=e[o];return Object.assign(K,{upload:_e,reset:H,removeUploadedFiles:Q,removeQueuedFiles:G,removeFile:le,pickFiles:l,addFiles:v}),ot(K,{canAddFiles:()=>R.value,canUpload:()=>m.value,uploadSizeLabel:()=>S.value,uploadProgressLabel:()=>y.value}),i({...e,upload:_e,reset:H,removeUploadedFiles:Q,removeQueuedFiles:G,removeFile:le,pickFiles:l,addFiles:v,canAddFiles:R,canUpload:m,uploadSizeLabel:S,uploadProgressLabel:y}),()=>{const o=[_("div",{class:M.value},Oe()),_("div",{class:"q-uploader__list scroll"},Ie()),V("uploader")];e.isBusy.value===!0&&o.push(_("div",{class:"q-uploader__overlay absolute-full flex flex-center"},[_(be)]));const b={ref:d,class:T.value};return R.value===!0&&Object.assign(b,{onDragover:h,onDragleave:r}),_("div",b,o)}}const wt=()=>!0;function Ve(t){const i={};return t.forEach(n=>{i[n]=wt}),i}const Ct=Ve(Le),zt=({name:t,props:i,emits:n,injectPlugin:a})=>oe({name:t,props:{...Bt,...i},emits:nt(n)===!0?{...Ct,...n}:[...Le,...n],setup(s,{expose:c}){return kt(a,c)}});function j(t){return typeof t=="function"?t:()=>t}const Ut="QUploader",Pt={url:[Function,String],method:{type:[Function,String],default:"POST"},fieldName:{type:[Function,String],default:()=>t=>t.name},headers:[Function,Array],formFields:[Function,Array],withCredentials:[Function,Boolean],sendRaw:[Function,Boolean],batch:[Function,Boolean],factory:Function},Et=["factoryFailed","uploaded","failed","uploading"];function $t({props:t,emit:i,helpers:n}){const a=k([]),s=k([]),c=k(0),f=D(()=>({url:j(t.url),method:j(t.method),headers:j(t.headers),formFields:j(t.formFields),fieldName:j(t.fieldName),withCredentials:j(t.withCredentials),sendRaw:j(t.sendRaw),batch:j(t.batch)})),F=D(()=>c.value>0),B=D(()=>s.value.length!==0);let w;function p(){a.value.forEach(e=>{e.abort()}),s.value.length!==0&&(w=!0)}function U(){const e=n.queuedFiles.value.slice(0);n.queuedFiles.value=[],f.value.batch(e)?d(e):e.forEach(l=>{d([l])})}function d(e){if(c.value++,typeof t.factory!="function"){u(e,{});return}const l=t.factory(e);if(!l)i("factoryFailed",new Error("QUploader: factory() does not return properly"),e),c.value--;else if(typeof l.catch=="function"&&typeof l.then=="function"){s.value.push(l);const v=h=>{n.isAlive()===!0&&(s.value=s.value.filter(r=>r!==l),s.value.length===0&&(w=!1),n.queuedFiles.value=n.queuedFiles.value.concat(e),e.forEach(r=>{n.updateFileStatus(r,"failed")}),i("factoryFailed",h,e),c.value--)};l.then(h=>{w===!0?v(new Error("Aborted")):n.isAlive()===!0&&(s.value=s.value.filter(r=>r!==l),u(e,h))}).catch(v)}else u(e,l||{})}function u(e,l){const v=new FormData,h=new XMLHttpRequest,r=(m,T)=>l[m]!==void 0?j(l[m])(T):f.value[m](T),P=r("url",e);if(!P){console.error("q-uploader: invalid or no URL specified"),c.value--;return}const V=r("formFields",e);V!==void 0&&V.forEach(m=>{v.append(m.name,m.value)});let N=0,g=0,x=0,$=0,y;h.upload.addEventListener("progress",m=>{if(y===!0)return;const T=Math.min($,m.loaded);n.uploadedSize.value+=T-x,x=T;let M=x-g;for(let H=N;M>0&&H<e.length;H++){const Q=e[H];if(M>Q.size)M-=Q.size,N++,g+=Q.size,n.updateFileStatus(Q,"uploading",Q.size);else{n.updateFileStatus(Q,"uploading",M);return}}},!1),h.onreadystatechange=()=>{h.readyState<4||(h.status&&h.status<400?(n.uploadedFiles.value=n.uploadedFiles.value.concat(e),e.forEach(m=>{n.updateFileStatus(m,"uploaded")}),i("uploaded",{files:e,xhr:h})):(y=!0,n.uploadedSize.value-=x,n.queuedFiles.value=n.queuedFiles.value.concat(e),e.forEach(m=>{n.updateFileStatus(m,"failed")}),i("failed",{files:e,xhr:h})),c.value--,a.value=a.value.filter(m=>m!==h))},h.open(r("method",e),P),r("withCredentials",e)===!0&&(h.withCredentials=!0);const S=r("headers",e);S!==void 0&&S.forEach(m=>{h.setRequestHeader(m.name,m.value)});const R=r("sendRaw",e);e.forEach(m=>{n.updateFileStatus(m,"uploading",0),R!==!0&&v.append(r("fieldName",m),m,m.name),m.xhr=h,m.__abort=()=>{h.abort()},$+=m.size}),i("uploading",{files:e,xhr:h}),a.value.push(h),R===!0?h.send(new Blob(e)):h.send(v)}return{isUploading:F,isBusy:B,abort:p,upload:U}}const Qt={name:Ut,props:Pt,emits:Et,injectPlugin:$t},Rt=zt(Qt);function fe(){const{emit:t,proxy:i}=J(),n=k(null);function a(){n.value.show()}function s(){n.value.hide()}function c(F){t("ok",F),s()}function f(){t("hide")}return Object.assign(i,{show:a,hide:s}),{dialogRef:n,onDialogHide:f,onDialogOK:c,onDialogCancel:s}}const Ne=["ok","hide"];fe.emits=Ne;fe.emitsObject=Ve(Ne);const At={class:"text-center upload-title"},jt=ce({__name:"AddProductModal",emits:["refresh-data"],setup(t,{emit:i}){const n=i,a=$e(),s=Pe(),c=mt(),{dialogRef:f}=fe(),F=Qe(),B=k(!1),w=k(),p=k({id:null,name:"",category_id:"",unit_id:"",qty:null,description:""});async function U(){try{const e=await s.createProduct(p.value);e&&(p.value.id=e.id,a.notify({message:"Товар успешно создан, теперь вам необходимо добавить картинку",color:"primary"}))}catch(e){console.error(e)}}function d(e){const l=new FileReader;l.readAsDataURL(e[0]),l.onload=()=>{l?.result&&(w.value=String(l.result))},u(e[0])}async function u(e){const l=new FormData;l.append("file",e);try{await s.uploadFile(p.value.id,l)&&(a.notify({message:"Картинка успешно добавлена",color:"primary"}),f.value?.hide())}catch(v){console.error(v)}finally{n("refresh-data")}}return(e,l)=>(L(),X(st,{ref_key:"dialogRef",ref:f,modelValue:B.value,"onUpdate:modelValue":l[6]||(l[6]=v=>B.value=v),persistent:""},{default:E(()=>[q(Ue,{class:"add-product"},{default:E(()=>[q(gt,{greedy:""},{default:E(()=>[q(ue,null,{default:E(()=>[l[9]||(l[9]=I("div",{class:"text-h6 q-mb-md"},"Добавление товара",-1)),q(re,{modelValue:p.value.name,"onUpdate:modelValue":l[0]||(l[0]=v=>p.value.name=v),class:"q-mb-xs",outlined:"",label:"Наименование товара"},null,8,["modelValue"]),q(re,{modelValue:p.value.qty,"onUpdate:modelValue":l[1]||(l[1]=v=>p.value.qty=v),class:"q-mb-xs",outlined:"",label:"Количество"},null,8,["modelValue"]),q(xe,{modelValue:p.value.category_id,"onUpdate:modelValue":l[2]||(l[2]=v=>p.value.category_id=v),options:ie(c).categories,class:"q-mb-xs",outlined:"",label:"Тип тары","emit-value":"","map-options":"","option-label":"name","option-value":"id"},null,8,["modelValue","options"]),q(xe,{modelValue:p.value.unit_id,"onUpdate:modelValue":l[3]||(l[3]=v=>p.value.unit_id=v),options:ie(F).units,outlined:"",label:"Вес","emit-value":"","map-options":"","option-label":"name","option-value":"id"},null,8,["modelValue","options"]),q(re,{class:"q-mt-sm",modelValue:p.value.description,"onUpdate:modelValue":l[4]||(l[4]=v=>p.value.description=v),filled:"",type:"textarea",rows:"2",label:"Описание"},null,8,["modelValue"]),!w.value&&p.value.id?(L(),X(Rt,{key:0,class:"q-mt-sm",ref:"uploaderRef",color:"primary",flat:"",onAdded:d},{header:E(()=>[...l[7]||(l[7]=[])]),list:E(()=>[q(yt),I("div",At,[q(Ce,{class:"q-mr-sm",name:"note_add",size:"24px"}),l[8]||(l[8]=I("span",null,"Загрузить картинку",-1))])]),_:1},512)):ae("",!0),w.value?(L(),X(Ee,{key:1,class:"q-mt-sm",src:w.value},null,8,["src"])):ae("",!0)]),_:1}),q(ze,{align:"right"},{default:E(()=>[ut(q(Y,{color:"red",label:"Отмена"},null,512),[[_t]]),q(Y,{color:"primary",label:"Подтвердить",onClick:l[5]||(l[5]=v=>U())})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Lt=Re(jt,[["__scopeId","data-v-15064176"]]),Vt={class:"product-card row q-col-gutter-xs"},Nt={class:"text-center card-title"},Ot={class:"text-center"},It={class:"text-bold"},Tt={key:0,class:"text-grey old-price"},Mt=ce({__name:"ProductList",setup(t){const i=$e(),n=Qe(),a=Pe(),s=ft(),c=k(!1),f=k(!1);it(async()=>{try{await n.fetchUnits(),i.loading.show()}catch(d){console.error(d)}finally{i.loading.hide()}});function F(){B()}async function B(){try{i.loading.show();const d=await a.fetchProducts(a.pagination);d&&(a.pagination.total=d.total,a.pagination.has_more=d.has_more,a?.products?.length?a.products.push(d.items):a.products=d.items)}catch(d){console.error(d)}finally{i.loading.hide()}}function w(d){try{if(i.loading.show(),s.basketData?.length){const u=s.basketData.find(e=>e.id===d.id);u?p(u,d):s.basketData.push(structuredClone(De(d)))}else s.basketData.push(structuredClone(De(d)))}catch(u){console.error(u)}finally{i.notify({message:`Товар ${d.name} добавлен в корзину`,color:"primary"}),i.loading.hide()}}function p(d,u){d.price&&(d.price+=u.price),d.weight&&(d.weight+=u.weight),d.oldPrice&&(d.oldPrice+=u.oldPrice)}const U=async(d,u)=>{if(!a.pagination.has_more){c.value=!0,u(!0);return}await B(),a.pagination.offset+=a.pagination.limit,u()};return(d,u)=>(L(),X(pt,{onLoad:U,offset:250},{default:E(()=>[q(Y,{onClick:u[0]||(u[0]=e=>f.value=!f.value),class:"full-width q-mb-sm",color:"secondary",label:"Добавление товара"}),I("div",Vt,[(L(!0),ne(ct,null,dt(ie(a).products,(e,l)=>(L(),ne("div",{class:"col-6",key:l},[q(Ue,{class:"my-card radius-12 full-height",style:{"border-radius":"20px"},flat:"",bordered:""},{default:E(()=>[q(ue,{class:"q-pa-sm full-height"},{default:E(()=>[I("div",null,[q(Ee,{class:"cursor-pointer",src:"https://media.istockphoto.com/id/1141529240/ru/%D0%B2%D0%B5%D0%BA%D1%82%D0%BE%D1%80%D0%BD%D0%B0%D1%8F/%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D0%B5-%D1%8F%D0%B1%D0%BB%D0%BE%D0%BA%D0%BE-%D0%B2-%D0%BF%D0%BB%D0%BE%D1%81%D0%BA%D0%BE%D0%BC-%D1%81%D1%82%D0%B8%D0%BB%D0%B5-%D0%B8%D0%BB%D0%BB%D1%8E%D1%81%D1%82%D1%80%D0%B0%D1%86%D0%B8%D1%8F-%D0%B2%D0%B5%D0%BA%D1%82%D0%BE%D1%80%D0%B0.jpg?s=612x612&w=0&k=20&c=B-KXrA7VTm8E6t4jk9qcuFz8bDFzTJwiIGaYGYUcsZI="})]),q(ue,{class:"q-pa-sm"},{default:E(()=>[I("div",Nt,ee(e.name),1),I("div",Ot,[I("span",It,ee(e.price),1),u[3]||(u[3]=Fe(" ₽ ",-1)),e?.oldPrice?(L(),ne("span",Tt,ee(e.old_price)+" ₽",1)):ae("",!0),Fe(" / "+ee(e.unit_symbol),1)])]),_:2},1024),q(ze,{class:"justify-center"},{default:E(()=>[q(Y,{dense:"","no-caps":"",class:"full-width",color:"secondary",icon:"add_shopping_cart",label:"В корзину",onClick:v=>w(e)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]))),128))]),f.value?(L(),X(Lt,{key:0,modelValue:f.value,"onUpdate:modelValue":u[1]||(u[1]=e=>f.value=e),onRefreshData:u[2]||(u[2]=e=>F())},null,8,["modelValue"])):ae("",!0)]),_:1}))}}),Ht=Re(Mt,[["__scopeId","data-v-fa13c6a4"]]),la=ce({__name:"DashboardPage",setup(t){return(i,n)=>(L(),X(ht,{class:"q-mx-xs"},{default:E(()=>[q(Ht,{class:"q-mb-lg"})]),_:1}))}});export{la as default};
