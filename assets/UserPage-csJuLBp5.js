import{Q as z}from"./QImg-C-CEbNDX.js";import{aX as E,r as m,aY as g,d as S,o as x,af as C,ae as A,aD as F,aj as i,f as a,aG as D,aE as U,ak as d,ai as w,aC as V,aZ as M,aF as N,U as _,aA as y,c as b,aB as k,a3 as P,ad as T,ag as K,al as L,a9 as h}from"./index-B2oe_LZP.js";import{Q as R}from"./QBtnToggle-FkV4v26C.js";import{Q as q}from"./QSelect-Be2SeZoz.js";import{u as B}from"./use-quasar-B3xRNweg.js";import{Q as G}from"./QForm-DE_Quj8D.js";import{C as Q}from"./ClosePopup-BRuIqseI.js";import{g as X}from"./useUtils-DbrnkpiV.js";import"./QBtnGroup-CA1sQ3mq.js";import"./QItem-BnVDEbcZ.js";import"./QMenu-CkIlgdwo.js";import"./selection-C1Z_woUr.js";import"./rtl-D3GObVCM.js";const I=E("Addresses",()=>{const v=m(),u=m();async function r(){return g.get("addresses").then(e=>e.data).catch(e=>{throw console.error("[AddressesStore] - An error occurred while fetching via fetchAddresses",e.message),e})}async function c(e){return g.post("addresses",e).then(s=>s.data).catch(s=>{throw console.error("[AddressesStore] - An error occurred while createing via createAddress",s.message),s})}async function t(e){return g.patch(`/addresses/${e.id}`,e).then(s=>s.data).catch(s=>{throw console.error("[AddressesStore] - An error occurred while creating via updateAddress",s.message),s})}async function p(e){return g.delete(`addresses/${e}`).then(s=>s.data).catch(s=>{throw console.error("[AddressesStore] - An error occurred while deleting via deleteAddress",s.message),s})}async function l(){return g.get("delivery-zones").then(e=>e.data).catch(e=>{throw console.error("[AddressesStore] - An error occurred while fetching via fetchAddresses",e.message),e})}return{addresses:v,deliveryZones:u,fetchAddresses:r,createAddress:c,updateAddress:t,deleteAddress:p,fetchDeliveryZones:l}}),Y=S({__name:"AddAddressModal",setup(v){const u=B(),r=I(),c=m(!0),t=m({area_id:null,address_line:"",comment:"",is_default:!1});x(async()=>{try{u.loading.show();const l=await r.fetchDeliveryZones();l&&(r.deliveryZones=l)}catch(l){console.error(l)}finally{u.loading.hide()}});async function p(){try{await r.createAddress(t.value)}catch(l){console.error(l)}}return(l,e)=>(A(),C(F,{ref:"dialogRef",modelValue:c.value,"onUpdate:modelValue":e[5]||(e[5]=s=>c.value=s),persistent:""},{default:i(()=>[a(D,{class:""},{default:i(()=>[a(G,{greedy:""},{default:i(()=>[a(U,null,{default:i(()=>[e[6]||(e[6]=d("div",{class:"text-h6"},"Создание нового адреса доставки",-1)),a(q,{modelValue:t.value.area_id,"onUpdate:modelValue":e[0]||(e[0]=s=>t.value.area_id=s),options:w(r).deliveryZones,class:"q-mb-xs",outlined:"",label:"Зона доставки","emit-value":"","map-options":"","option-label":"title","option-value":"id"},null,8,["modelValue","options"]),a(V,{class:"q-mb-sm",outlined:"",modelValue:t.value.address_line,"onUpdate:modelValue":e[1]||(e[1]=s=>t.value.address_line=s),label:"Адрес"},null,8,["modelValue"]),a(V,{label:"Комментарий",modelValue:t.value.comment,"onUpdate:modelValue":e[2]||(e[2]=s=>t.value.comment=s),outlined:"",type:"textarea",rows:"3"},null,8,["modelValue"]),a(M,{modelValue:t.value.is_default,"onUpdate:modelValue":e[3]||(e[3]=s=>t.value.is_default=s),label:"Активный аддрес"},null,8,["modelValue"])]),_:1}),a(N,{align:"right"},{default:i(()=>[_(a(y,{color:"red",flat:"",label:"Отмена"},null,512),[[Q]]),_(a(y,{color:"primary",flat:"",label:"Сохранить",onClick:e[4]||(e[4]=s=>p())},null,512),[[Q]])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),H={class:"q-pa-sm"},J={class:"justify-center row q-mb-md"},O={class:"text-h5 justify-between q-mb-sm row"},W={class:"items-center"},ee={class:"items-center"},se={class:"row items-center q-mb-sm"},ge=S({__name:"UserPage",setup(v){const u=B(),r=I(),c=b(()=>k.isActive),t=P({dark:"dark",light:"light"}),p=b(()=>c.value?t.dark:t.light),l=m(!1),e=m("dark"),s=m({full_name:"",mail:"",phone:"",addres:""}),$={id:4,full_name:"Denis Ivanov",phone:null,subscribe_news:!0,role:1,is_user:!1,language_code:"ru",is_premium:!1,main_image_url:"https://api.telegram.org/file/bot7772150741:AAFpK9oECUvBzrE8Kdh-fc1Io18ucALDvgI/photos/file_11.jpg",is_bot:!1};x(()=>{j()});const Z=()=>{k.toggle(),window.localStorage.setItem("theme",p.value)};async function j(){try{u.loading.show();const f=await r.fetchAddresses();f&&(r.addresses=f.items)}catch(f){console.error(f)}finally{u.loading.hide()}}return(f,o)=>(A(),T("div",null,[o[6]||(o[6]=d("h6",{class:"text-center q-mb-md"},"Личный кабинет",-1)),d("div",H,[a(D,{class:"my-card full-height",flat:"",bordered:""},{default:i(()=>[a(U,null,{default:i(()=>[d("div",J,[a(z,{class:"radius-100",height:"120px",width:"120px",src:w(X)("/card-shop.jpg")},null,8,["src"])]),d("div",O,[d("div",null,L($.full_name),1),d("div",null,[a(R,{modelValue:e.value,"onUpdate:modelValue":o[0]||(o[0]=n=>e.value=n),size:"sm","no-caps":"",unelevated:"",dense:"","toggle-color":"grey-9",color:"white","text-color":"grey-9",options:[{value:"dark",slot:"dark",title:"Dark mode"},{value:"light",slot:"light",title:"Light mode"}],onClick:o[1]||(o[1]=n=>Z())},{dark:i(()=>[d("div",W,[a(h,{name:"nightlight"})])]),light:i(()=>[d("div",ee,[a(h,{name:"light_mode"})])]),_:1},8,["modelValue"])])]),a(V,{class:"q-mb-sm",outlined:"",modelValue:s.value.phone,"onUpdate:modelValue":o[2]||(o[2]=n=>s.value.phone=n),label:"Телефон"},null,8,["modelValue"]),d("div",se,[a(q,{modelValue:s.value.addres,"onUpdate:modelValue":o[3]||(o[3]=n=>s.value.addres=n),options:w(r).addresses,class:"col-10",outlined:"",label:"Адрес","emit-value":"","map-options":"","option-label":"address_line","option-value":"id"},null,8,["modelValue","options"]),a(h,{onClick:o[4]||(o[4]=n=>l.value=!l.value),name:"add",size:"34px",color:"green",class:"col-2"})])]),_:1})]),_:1})]),l.value?(A(),C(Y,{key:0,modelValue:l.value,"onUpdate:modelValue":o[5]||(o[5]=n=>l.value=n)},null,8,["modelValue"])):K("",!0)]))}});export{ge as default};
