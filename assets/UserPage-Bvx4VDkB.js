import{Q as Z}from"./QImg-COpz7o5B.js";import{aU as E,r as m,aV as g,d as S,o as x,af as C,ae as A,aB as M,aj as i,f as a,aE as D,aC as U,ak as d,ai as V,aA as w,aW as N,aD as P,U as _,av as y,c as b,az as k,a3 as T,ad as F,ag as K,al as L,a9 as h}from"./index-C5OPW76n.js";import{Q as R}from"./QBtnToggle-BnDAXYR9.js";import{Q as q}from"./QSelect-BBmMG8vo.js";import{u as B}from"./use-quasar-DHz9wDzy.js";import{Q as W}from"./QForm-BdbOQnyG.js";import{C as Q}from"./ClosePopup-t_WY4bjf.js";import{g as G}from"./useUtils-DO7iCsb-.js";import"./QBtnGroup-BoXW6r64.js";import"./QItem-BKVUcLfv.js";import"./QMenu-2kJLarbi.js";import"./rtl-D3GObVCM.js";const I=E("Addresses",()=>{const v=m(),u=m();async function r(){return g.get("addresses").then(e=>e.data).catch(e=>{throw console.error("[AddressesStore] - An error occurred while fetching via fetchAddresses",e.message),e})}async function c(e){return g.post("addresses",e).then(s=>s.data).catch(s=>{throw console.error("[AddressesStore] - An error occurred while createing via createAddress",s.message),s})}async function t(e){return g.patch(`/addresses/${e.id}`,e).then(s=>s.data).catch(s=>{throw console.error("[AddressesStore] - An error occurred while creating via updateAddress",s.message),s})}async function p(e){return g.delete(`addresses/${e}`).then(s=>s.data).catch(s=>{throw console.error("[AddressesStore] - An error occurred while deleting via deleteAddress",s.message),s})}async function l(){return g.get("delivery-zones").then(e=>e.data).catch(e=>{throw console.error("[AddressesStore] - An error occurred while fetching via fetchAddresses",e.message),e})}return{addresses:v,deliveryZones:u,fetchAddresses:r,createAddress:c,updateAddress:t,deleteAddress:p,fetchDeliveryZones:l}}),H=S({__name:"AddAddressModal",setup(v){const u=B(),r=I(),c=m(!0),t=m({area_id:null,address_line:"",comment:"",is_default:!1});x(async()=>{try{u.loading.show();const l=await r.fetchDeliveryZones();l&&(r.deliveryZones=l)}catch(l){console.error(l)}finally{u.loading.hide()}});async function p(){try{await r.createAddress(t.value)}catch(l){console.error(l)}}return(l,e)=>(A(),C(M,{ref:"dialogRef",modelValue:c.value,"onUpdate:modelValue":e[5]||(e[5]=s=>c.value=s),persistent:""},{default:i(()=>[a(D,{class:""},{default:i(()=>[a(W,{greedy:""},{default:i(()=>[a(U,null,{default:i(()=>[e[6]||(e[6]=d("div",{class:"text-h6"},"Создание нового адреса доставки",-1)),a(q,{modelValue:t.value.area_id,"onUpdate:modelValue":e[0]||(e[0]=s=>t.value.area_id=s),options:V(r).deliveryZones,class:"q-mb-xs",outlined:"",label:"Зона доставки","emit-value":"","map-options":"","option-label":"title","option-value":"id"},null,8,["modelValue","options"]),a(w,{class:"q-mb-sm",outlined:"",modelValue:t.value.address_line,"onUpdate:modelValue":e[1]||(e[1]=s=>t.value.address_line=s),label:"Адрес"},null,8,["modelValue"]),a(w,{label:"Комментарий",modelValue:t.value.comment,"onUpdate:modelValue":e[2]||(e[2]=s=>t.value.comment=s),outlined:"",type:"textarea",rows:"3"},null,8,["modelValue"]),a(N,{modelValue:t.value.is_default,"onUpdate:modelValue":e[3]||(e[3]=s=>t.value.is_default=s),label:"Активный аддрес"},null,8,["modelValue"])]),_:1}),a(P,{align:"right"},{default:i(()=>[_(a(y,{color:"red",flat:"",label:"Отмена"},null,512),[[Q]]),_(a(y,{color:"primary",flat:"",label:"Сохранить",onClick:e[4]||(e[4]=s=>p())},null,512),[[Q]])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),J={class:"q-pa-sm"},O={class:"justify-center row q-mb-md"},X={class:"text-h5 justify-between q-mb-sm row"},Y={class:"items-center"},ee={class:"items-center"},se={class:"row items-center q-mb-sm"},fe=S({__name:"UserPage",setup(v){const u=B(),r=I(),c=b(()=>k.isActive),t=T({dark:"dark",light:"light"}),p=b(()=>c.value?t.dark:t.light),l=m(!1),e=m("dark"),s=m({full_name:"",mail:"",phone:"",addres:""}),$={id:4,full_name:"Denis Ivanov",phone:null,subscribe_news:!0,role:1,is_user:!1,language_code:"ru",is_premium:!1,main_image_url:"https://api.telegram.org/file/bot7772150741:AAFpK9oECUvBzrE8Kdh-fc1Io18ucALDvgI/photos/file_11.jpg",is_bot:!1};x(()=>{z()});const j=()=>{k.toggle(),window.localStorage.setItem("theme",p.value)};async function z(){try{u.loading.show();const f=await r.fetchAddresses();f&&(r.addresses=f.items)}catch(f){console.error(f)}finally{u.loading.hide()}}return(f,o)=>(A(),F("div",null,[o[6]||(o[6]=d("h6",{class:"text-center q-mb-md"},"Личный кабинет",-1)),d("div",J,[a(D,{class:"my-card full-height",flat:"",bordered:""},{default:i(()=>[a(U,null,{default:i(()=>[d("div",O,[a(Z,{class:"radius-100",height:"120px",width:"120px",src:V(G)("/card-shop.jpg")},null,8,["src"])]),d("div",X,[d("div",null,L($.full_name),1),d("div",null,[a(R,{modelValue:e.value,"onUpdate:modelValue":o[0]||(o[0]=n=>e.value=n),size:"sm","no-caps":"",unelevated:"",dense:"","toggle-color":"grey-9",color:"white","text-color":"grey-9",options:[{value:"dark",slot:"dark",title:"Dark mode"},{value:"light",slot:"light",title:"Light mode"}],onClick:o[1]||(o[1]=n=>j())},{dark:i(()=>[d("div",Y,[a(h,{name:"nightlight"})])]),light:i(()=>[d("div",ee,[a(h,{name:"light_mode"})])]),_:1},8,["modelValue"])])]),a(w,{class:"q-mb-sm",outlined:"",modelValue:s.value.phone,"onUpdate:modelValue":o[2]||(o[2]=n=>s.value.phone=n),label:"Телефон"},null,8,["modelValue"]),d("div",se,[a(q,{modelValue:s.value.addres,"onUpdate:modelValue":o[3]||(o[3]=n=>s.value.addres=n),options:V(r).addresses,class:"col-10",outlined:"",label:"Адрес","emit-value":"","map-options":"","option-label":"address_line","option-value":"id"},null,8,["modelValue","options"]),a(h,{onClick:o[4]||(o[4]=n=>l.value=!l.value),name:"add",size:"34px",color:"green",class:"col-2"})])]),_:1})]),_:1})]),l.value?(A(),C(H,{key:0,modelValue:l.value,"onUpdate:modelValue":o[5]||(o[5]=n=>l.value=n)},null,8,["modelValue"])):K("",!0)]))}});export{fe as default};
