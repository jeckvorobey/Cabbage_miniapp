import{k as ie,g as te,a as fe,v as O,x as Xe,$ as Je,c as m,h as y,l as Ze,aw as Pe,ax as et,ay as tt,az as at,r as k,L as Ae,N as Ee,G as lt,P as ot,S as rt,w as nt,n as st,i as ut,aA as it,aB as dt,aC as qe,aD as ct,ad as Re,Q as T,_ as ft,aE as vt,am as W,d as ge,u as Ne,o as $e,aj as H,ai as $,aF as pt,an as U,f as D,aG as ue,ao as R,ak as se,av as le,aH as ve,Y as oe,ap as G,as as Qe,ah as ce,aq as mt,F as gt,aI as ke,at as Be}from"./index-BCDS6zPH.js";import{u as Ve,Q as pe,a as _t}from"./orderStore-D2Ah59ra.js";import{Q as ht}from"./QInfiniteScroll-DhtKT6kk.js";import{u as Ie}from"./use-quasar-DbF-hKHZ.js";import{b as yt,h as we,u as bt}from"./categoriesStore-D5al0wjp.js";import{Q as Ce}from"./QSelect-ClPp_Bjd.js";import{u as Me,Q as Ue}from"./unitsStore-C5LKNVbQ.js";import{C as re}from"./ClosePopup-CGA59Sas.js";import{E as C}from"./useUtils-C0QSN97f.js";import{_ as je}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./QMenu-DteO9KoP.js";const Ft=ie({name:"QPage",props:{padding:Boolean,styleFn:Function},setup(a,{slots:s}){const{proxy:{$q:n}}=te(),l=fe(Xe,O);if(l===O)return console.error("QPage needs to be a deep child of QLayout"),O;if(fe(Je,O)===O)return console.error("QPage needs to be child of QPageContainer"),O;const p=m(()=>{const f=(l.header.space===!0?l.header.size:0)+(l.footer.space===!0?l.footer.size:0);if(typeof a.styleFn=="function"){const S=l.isContainer.value===!0?l.containerHeight.value:n.screen.height;return a.styleFn(f,S)}return{minHeight:l.isContainer.value===!0?l.containerHeight.value-f+"px":n.screen.height===0?f!==0?`calc(100vh - ${f}px)`:"100vh":n.screen.height-f+"px"}}),c=m(()=>`q-page${a.padding===!0?" q-layout-padding":""}`);return()=>y("main",{class:c.value,style:p.value},Ze(s.default))}}),Dt=ie({name:"QUploaderAddTrigger",setup(){const a=fe(Pe,O);return a===O&&console.error("QUploaderAddTrigger needs to be child of QUploader"),a}}),St={...et,min:{type:Number,default:0},max:{type:Number,default:100},color:String,centerColor:String,trackColor:String,fontSize:String,rounded:Boolean,thickness:{type:Number,default:.2,validator:a=>a>=0&&a<=1},angle:{type:Number,default:0},showValue:Boolean,reverse:Boolean,instantFeedback:Boolean},me=50,Le=2*me,Oe=Le*Math.PI,xt=Math.round(Oe*1e3)/1e3,qt=ie({name:"QCircularProgress",props:{...St,value:{type:Number,default:0},animationSpeed:{type:[String,Number],default:600},indeterminate:Boolean},setup(a,{slots:s}){const{proxy:{$q:n}}=te(),l=tt(a),u=m(()=>{const i=(n.lang.rtl===!0?-1:1)*a.angle;return{transform:a.reverse!==(n.lang.rtl===!0)?`scale3d(-1, 1, 1) rotate3d(0, 0, 1, ${-90-i}deg)`:`rotate3d(0, 0, 1, ${i-90}deg)`}}),p=m(()=>a.instantFeedback!==!0&&a.indeterminate!==!0?{transition:`stroke-dashoffset ${a.animationSpeed}ms ease 0s, stroke ${a.animationSpeed}ms ease`}:""),c=m(()=>Le/(1-a.thickness/2)),f=m(()=>`${c.value/2} ${c.value/2} ${c.value} ${c.value}`),S=m(()=>yt(a.value,a.min,a.max)),z=m(()=>a.max-a.min),w=m(()=>a.thickness/2*c.value),P=m(()=>{const i=(a.max-S.value)/z.value,e=a.rounded===!0&&S.value<a.max&&i<.25?w.value/2*(1-i/.25):0;return Oe*i+e});function B({thickness:i,offset:e,color:_,cls:d,rounded:r}){return y("circle",{class:"q-circular-progress__"+d+(_!==void 0?` text-${_}`:""),style:p.value,fill:"transparent",stroke:"currentColor","stroke-width":i,"stroke-dasharray":xt,"stroke-dashoffset":e,"stroke-linecap":r,cx:c.value,cy:c.value,r:me})}return()=>{const i=[];a.centerColor!==void 0&&a.centerColor!=="transparent"&&i.push(y("circle",{class:`q-circular-progress__center text-${a.centerColor}`,fill:"currentColor",r:me-w.value/2,cx:c.value,cy:c.value})),a.trackColor!==void 0&&a.trackColor!=="transparent"&&i.push(B({cls:"track",thickness:w.value,offset:0,color:a.trackColor})),i.push(B({cls:"circle",thickness:w.value,offset:P.value,color:a.color,rounded:a.rounded===!0?"round":void 0}));const e=[y("svg",{class:"q-circular-progress__svg",style:u.value,viewBox:f.value,"aria-hidden":"true"},i)];return a.showValue===!0&&e.push(y("div",{class:"q-circular-progress__text absolute-full row flex-center content-center",style:{fontSize:a.fontSize}},s.default!==void 0?s.default():[y("div",S.value)])),y("div",{class:`q-circular-progress q-circular-progress--${a.indeterminate===!0?"in":""}determinate`,style:l.value,role:"progressbar","aria-valuemin":a.min,"aria-valuemax":a.max,"aria-valuenow":a.indeterminate===!0?void 0:S.value},at(s.internal,e))}}});function Z(a,s,n,l){const u=[];return a.forEach(p=>{l(p)===!0?u.push(p):s.push({failedPropValidation:n,file:p})}),u}function ne(a){a?.dataTransfer&&(a.dataTransfer.dropEffect="copy"),Ee(a)}const kt={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},Bt=["rejected"];function wt({editable:a,dnd:s,getFileInput:n,addFilesToQueue:l}){const{props:u,emit:p,proxy:c}=te(),f=k(null),S=m(()=>u.accept!==void 0?u.accept.split(",").map(t=>(t=t.trim(),t==="*"?"*/":(t.endsWith("/*")&&(t=t.slice(0,t.length-1)),t.toUpperCase()))):null),z=m(()=>parseInt(u.maxFiles,10)),w=m(()=>parseInt(u.maxTotalSize,10));function P(t){if(a.value)if(t!==Object(t)&&(t={target:null}),t.target?.matches('input[type="file"]')===!0)t.clientX===0&&t.clientY===0&&Ae(t);else{const v=n();v!==t.target&&v?.click(t)}}function B(t){a.value&&t&&l(null,t)}function i(t,v,Q,L){let h=Array.from(v||t.target.files);const x=[],N=()=>{x.length!==0&&p("rejected",x)};if(u.accept!==void 0&&S.value.indexOf("*/")===-1&&(h=Z(h,x,"accept",b=>S.value.some(q=>b.type.toUpperCase().startsWith(q)||b.name.toUpperCase().endsWith(q))),h.length===0))return N();if(u.maxFileSize!==void 0){const b=parseInt(u.maxFileSize,10);if(h=Z(h,x,"max-file-size",q=>q.size<=b),h.length===0)return N()}if(u.multiple!==!0&&h.length!==0&&(h=[h[0]]),h.forEach(b=>{b.__key=b.webkitRelativePath+b.lastModified+b.name+b.size}),L===!0){const b=Q.map(q=>q.__key);h=Z(h,x,"duplicate",q=>b.includes(q.__key)===!1)}if(h.length===0)return N();if(u.maxTotalSize!==void 0){let b=L===!0?Q.reduce((q,I)=>q+I.size,0):0;if(h=Z(h,x,"max-total-size",q=>(b+=q.size,b<=w.value)),h.length===0)return N()}if(typeof u.filter=="function"){const b=u.filter(h);h=Z(h,x,"filter",q=>b.includes(q))}if(u.maxFiles!==void 0){let b=L===!0?Q.length:0;if(h=Z(h,x,"max-files",()=>(b++,b<=z.value)),h.length===0)return N()}if(N(),h.length!==0)return h}function e(t){ne(t),s.value!==!0&&(s.value=!0)}function _(t){Ee(t),(t.relatedTarget!==null||lt.is.safari!==!0?t.relatedTarget!==f.value:document.elementsFromPoint(t.clientX,t.clientY).includes(f.value)===!1)===!0&&(s.value=!1)}function d(t){ne(t);const v=t.dataTransfer.files;v.length!==0&&l(null,v),s.value=!1}function r(t){if(s.value===!0)return y("div",{ref:f,class:`q-${t}__dnd absolute-full`,onDragenter:ne,onDragover:ne,onDragleave:_,onDrop:d})}return Object.assign(c,{pickFiles:P,addFiles:B}),{pickFiles:P,addFiles:B,onDragover:e,onDragleave:_,processFiles:i,getDndNode:r,maxFilesNumber:z,maxTotalSizeNumber:w}}function ze(a){return(a*100).toFixed(2)+"%"}const Ct={...ot,...kt,label:String,color:String,textColor:String,square:Boolean,flat:Boolean,bordered:Boolean,noThumbnails:Boolean,thumbnailFit:{type:String,default:"cover"},autoUpload:Boolean,hideUploadBtn:Boolean,disable:Boolean,readonly:Boolean},Te=[...Bt,"start","finish","added","removed"];function Ut(a,s){const n=te(),{props:l,slots:u,emit:p,proxy:c}=n,{$q:f}=c,S=rt(l,f);function z(o,F,A){if(o.__status=F,F==="idle"){o.__uploaded=0,o.__progress=0,o.__sizeLabel=we(o.size),o.__progressLabel="0.00%";return}if(F==="failed"){c.$forceUpdate();return}o.__uploaded=F==="uploaded"?o.size:A,o.__progress=F==="uploaded"?1:Math.min(.9999,o.__uploaded/o.size),o.__progressLabel=ze(o.__progress),c.$forceUpdate()}const w=m(()=>l.disable!==!0&&l.readonly!==!0),P=k(!1),B=k(null),i=k(null),e={files:k([]),queuedFiles:k([]),uploadedFiles:k([]),uploadedSize:k(0),updateFileStatus:z,isAlive:()=>ct(n)===!1},{pickFiles:_,addFiles:d,onDragover:r,onDragleave:t,processFiles:v,getDndNode:Q,maxFilesNumber:L,maxTotalSizeNumber:h}=wt({editable:w,dnd:P,getFileInput:be,addFilesToQueue:Fe});Object.assign(e,a({props:l,slots:u,emit:p,helpers:e,exposeApi:o=>{Object.assign(e,o)}})),e.isBusy===void 0&&(e.isBusy=k(!1));const x=k(0),N=m(()=>x.value===0?0:e.uploadedSize.value/x.value),b=m(()=>ze(N.value)),q=m(()=>we(x.value)),I=m(()=>w.value===!0&&e.isUploading.value!==!0&&(l.multiple===!0||e.queuedFiles.value.length===0)&&(l.maxFiles===void 0||e.files.value.length<L.value)&&(l.maxTotalSize===void 0||x.value<h.value)),g=m(()=>w.value===!0&&e.isBusy.value!==!0&&e.isUploading.value!==!0&&e.queuedFiles.value.length!==0);ft(Pe,Se);const K=m(()=>"q-uploader column no-wrap"+(S.value===!0?" q-uploader--dark q-dark":"")+(l.bordered===!0?" q-uploader--bordered":"")+(l.square===!0?" q-uploader--square no-border-radius":"")+(l.flat===!0?" q-uploader--flat no-shadow":"")+(l.disable===!0?" disabled q-uploader--disable":"")+(P.value===!0?" q-uploader--dnd":"")),Y=m(()=>"q-uploader__header"+(l.color!==void 0?` bg-${l.color}`:"")+(l.textColor!==void 0?` text-${l.textColor}`:""));nt(e.isUploading,(o,F)=>{F===!1&&o===!0?p("start"):F===!0&&o===!1&&p("finish")});function X(){l.disable===!1&&(e.abort(),e.uploadedSize.value=0,x.value=0,ye(),e.files.value=[],e.queuedFiles.value=[],e.uploadedFiles.value=[])}function V(){l.disable===!1&&he(["uploaded"],()=>{e.uploadedFiles.value=[]})}function ae(){he(["idle","failed"],({size:o})=>{x.value-=o,e.queuedFiles.value=[]})}function he(o,F){if(l.disable===!0)return;const A={files:[],size:0},M=e.files.value.filter(E=>o.indexOf(E.__status)===-1?!0:(A.size+=E.size,A.files.push(E),E.__img!==void 0&&window.URL.revokeObjectURL(E.__img.src),!1));A.files.length!==0&&(e.files.value=M,F(A),p("removed",A.files))}function de(o){l.disable||(o.__status==="uploaded"?e.uploadedFiles.value=e.uploadedFiles.value.filter(F=>F.__key!==o.__key):o.__status==="uploading"?o.__abort():x.value-=o.size,e.files.value=e.files.value.filter(F=>F.__key!==o.__key?!0:(F.__img!==void 0&&window.URL.revokeObjectURL(F.__img.src),!1)),e.queuedFiles.value=e.queuedFiles.value.filter(F=>F.__key!==o.__key),p("removed",[o]))}function ye(){e.files.value.forEach(o=>{o.__img!==void 0&&window.URL.revokeObjectURL(o.__img.src)})}function be(){return i.value||B.value.getElementsByClassName("q-uploader__input")[0]}function Fe(o,F){const A=v(o,F,e.files.value,!0),M=be();M!=null&&(M.value=""),A!==void 0&&(A.forEach(E=>{if(e.updateFileStatus(E,"idle"),x.value+=E.size,l.noThumbnails!==!0&&E.type.toUpperCase().startsWith("IMAGE")){const xe=new Image;xe.src=window.URL.createObjectURL(E),E.__img=xe}}),e.files.value=e.files.value.concat(A),e.queuedFiles.value=e.queuedFiles.value.concat(A),p("added",A),l.autoUpload===!0&&e.upload())}function De(){g.value===!0&&e.upload()}function ee(o,F,A){if(o===!0){const M={type:"a",key:F,icon:f.iconSet.uploader[F],flat:!0,dense:!0};let E;return F==="add"?(M.onClick=_,E=Se):M.onClick=A,y(T,M,E)}}function Se(){return y("input",{ref:i,class:"q-uploader__input overflow-hidden absolute-full",tabindex:-1,type:"file",title:"",accept:l.accept,multiple:l.multiple===!0?"multiple":void 0,capture:l.capture,onMousedown:Ae,onClick:_,onChange:Fe})}function We(){return u.header!==void 0?u.header(J):[y("div",{class:"q-uploader__header-content column"},[y("div",{class:"flex flex-center no-wrap q-gutter-xs"},[ee(e.queuedFiles.value.length!==0,"removeQueue",ae),ee(e.uploadedFiles.value.length!==0,"removeUploaded",V),e.isUploading.value===!0?y(qe,{class:"q-uploader__spinner"}):null,y("div",{class:"col column justify-center"},[l.label!==void 0?y("div",{class:"q-uploader__title"},[l.label]):null,y("div",{class:"q-uploader__subtitle"},[q.value+" / "+b.value])]),ee(I.value,"add"),ee(l.hideUploadBtn===!1&&g.value===!0,"upload",e.upload),ee(e.isUploading.value,"clear",e.abort)])])]}function Ye(){return u.list!==void 0?u.list(J):e.files.value.map(o=>y("div",{key:o.__key,class:"q-uploader__file relative-position"+(l.noThumbnails!==!0&&o.__img!==void 0?" q-uploader__file--img":"")+(o.__status==="failed"?" q-uploader__file--failed":o.__status==="uploaded"?" q-uploader__file--uploaded":""),style:l.noThumbnails!==!0&&o.__img!==void 0?{backgroundImage:'url("'+o.__img.src+'")',backgroundSize:l.thumbnailFit}:null},[y("div",{class:"q-uploader__file-header row flex-center no-wrap"},[o.__status==="failed"?y(Re,{class:"q-uploader__file-status",name:f.iconSet.type.negative,color:"negative"}):null,y("div",{class:"q-uploader__file-header-content col"},[y("div",{class:"q-uploader__title"},[o.name]),y("div",{class:"q-uploader__subtitle row items-center no-wrap"},[o.__sizeLabel+" / "+o.__progressLabel])]),o.__status==="uploading"?y(qt,{value:o.__progress,min:0,max:1,indeterminate:o.__progress===0}):y(T,{round:!0,dense:!0,flat:!0,icon:f.iconSet.uploader[o.__status==="uploaded"?"done":"clear"],onClick:()=>{de(o)}})])]))}st(()=>{e.isUploading.value===!0&&e.abort(),e.files.value.length!==0&&ye()});const J={};for(const o in e)ut(e[o])===!0?it(J,o,()=>e[o].value):J[o]=e[o];return Object.assign(J,{upload:De,reset:X,removeUploadedFiles:V,removeQueuedFiles:ae,removeFile:de,pickFiles:_,addFiles:d}),dt(J,{canAddFiles:()=>I.value,canUpload:()=>g.value,uploadSizeLabel:()=>q.value,uploadProgressLabel:()=>b.value}),s({...e,upload:De,reset:X,removeUploadedFiles:V,removeQueuedFiles:ae,removeFile:de,pickFiles:_,addFiles:d,canAddFiles:I,canUpload:g,uploadSizeLabel:q,uploadProgressLabel:b}),()=>{const o=[y("div",{class:Y.value},We()),y("div",{class:"q-uploader__list scroll"},Ye()),Q("uploader")];e.isBusy.value===!0&&o.push(y("div",{class:"q-uploader__overlay absolute-full flex flex-center"},[y(qe)]));const F={ref:B,class:K.value};return I.value===!0&&Object.assign(F,{onDragover:r,onDragleave:t}),y("div",F,o)}}const zt=()=>!0;function He(a){const s={};return a.forEach(n=>{s[n]=zt}),s}const Pt=He(Te),At=({name:a,props:s,emits:n,injectPlugin:l})=>ie({name:a,props:{...Ct,...s},emits:vt(n)===!0?{...Pt,...n}:[...Te,...n],setup(u,{expose:p}){return Ut(l,p)}});function j(a){return typeof a=="function"?a:()=>a}const Et="QUploader",Rt={url:[Function,String],method:{type:[Function,String],default:"POST"},fieldName:{type:[Function,String],default:()=>a=>a.name},headers:[Function,Array],formFields:[Function,Array],withCredentials:[Function,Boolean],sendRaw:[Function,Boolean],batch:[Function,Boolean],factory:Function},Nt=["factoryFailed","uploaded","failed","uploading"];function $t({props:a,emit:s,helpers:n}){const l=k([]),u=k([]),p=k(0),c=m(()=>({url:j(a.url),method:j(a.method),headers:j(a.headers),formFields:j(a.formFields),fieldName:j(a.fieldName),withCredentials:j(a.withCredentials),sendRaw:j(a.sendRaw),batch:j(a.batch)})),f=m(()=>p.value>0),S=m(()=>u.value.length!==0);let z;function w(){l.value.forEach(e=>{e.abort()}),u.value.length!==0&&(z=!0)}function P(){const e=n.queuedFiles.value.slice(0);n.queuedFiles.value=[],c.value.batch(e)?B(e):e.forEach(_=>{B([_])})}function B(e){if(p.value++,typeof a.factory!="function"){i(e,{});return}const _=a.factory(e);if(!_)s("factoryFailed",new Error("QUploader: factory() does not return properly"),e),p.value--;else if(typeof _.catch=="function"&&typeof _.then=="function"){u.value.push(_);const d=r=>{n.isAlive()===!0&&(u.value=u.value.filter(t=>t!==_),u.value.length===0&&(z=!1),n.queuedFiles.value=n.queuedFiles.value.concat(e),e.forEach(t=>{n.updateFileStatus(t,"failed")}),s("factoryFailed",r,e),p.value--)};_.then(r=>{z===!0?d(new Error("Aborted")):n.isAlive()===!0&&(u.value=u.value.filter(t=>t!==_),i(e,r))}).catch(d)}else i(e,_||{})}function i(e,_){const d=new FormData,r=new XMLHttpRequest,t=(g,K)=>_[g]!==void 0?j(_[g])(K):c.value[g](K),v=t("url",e);if(!v){console.error("q-uploader: invalid or no URL specified"),p.value--;return}const Q=t("formFields",e);Q!==void 0&&Q.forEach(g=>{d.append(g.name,g.value)});let L=0,h=0,x=0,N=0,b;r.upload.addEventListener("progress",g=>{if(b===!0)return;const K=Math.min(N,g.loaded);n.uploadedSize.value+=K-x,x=K;let Y=x-h;for(let X=L;Y>0&&X<e.length;X++){const V=e[X];if(Y>V.size)Y-=V.size,L++,h+=V.size,n.updateFileStatus(V,"uploading",V.size);else{n.updateFileStatus(V,"uploading",Y);return}}},!1),r.onreadystatechange=()=>{r.readyState<4||(r.status&&r.status<400?(n.uploadedFiles.value=n.uploadedFiles.value.concat(e),e.forEach(g=>{n.updateFileStatus(g,"uploaded")}),s("uploaded",{files:e,xhr:r})):(b=!0,n.uploadedSize.value-=x,n.queuedFiles.value=n.queuedFiles.value.concat(e),e.forEach(g=>{n.updateFileStatus(g,"failed")}),s("failed",{files:e,xhr:r})),p.value--,l.value=l.value.filter(g=>g!==r))},r.open(t("method",e),v),t("withCredentials",e)===!0&&(r.withCredentials=!0);const q=t("headers",e);q!==void 0&&q.forEach(g=>{r.setRequestHeader(g.name,g.value)});const I=t("sendRaw",e);e.forEach(g=>{n.updateFileStatus(g,"uploading",0),I!==!0&&d.append(t("fieldName",g),g,g.name),g.xhr=r,g.__abort=()=>{r.abort()},N+=g.size}),s("uploading",{files:e,xhr:r}),l.value.push(r),I===!0?r.send(new Blob(e)):r.send(d)}return{isUploading:f,isBusy:S,abort:w,upload:P}}const Qt={name:Et,props:Rt,emits:Nt,injectPlugin:$t},Vt=At(Qt);function _e(){const{emit:a,proxy:s}=te(),n=k(null);function l(){n.value.show()}function u(){n.value.hide()}function p(f){a("ok",f),u()}function c(){a("hide")}return Object.assign(s,{show:l,hide:u}),{dialogRef:n,onDialogHide:c,onDialogOK:p,onDialogCancel:u}}const Ge=["ok","hide"];_e.emits=Ge;_e.emitsObject=He(Ge);function It(a){const s=W(a);if(s&&typeof s=="object"&&"role"in s){const n=s.role;return n!=null?W(n):null}return s}function Ke(a){const s=m(()=>{const c=It(a);if(c==null)return;const f=Number(c);if(Object.values(C).includes(f))return f}),n=m(()=>s.value===C.ADMIN),l=m(()=>s.value===C.MANAGER||s.value===C.ADMIN),u=m(()=>{const c=s.value;return c===C.USER||c===C.MANAGER||c===C.ADMIN});return{permission:s,isAdmin:n,isManager:l,isUser:u,hasPermission:c=>m(()=>{const f=s.value;if(f==null)return!1;switch(Number(c)){case C.ADMIN:return f===C.ADMIN;case C.MANAGER:return f===C.MANAGER||f===C.ADMIN;case C.USER:return f===C.USER||f===C.MANAGER||f===C.ADMIN;default:return!1}})}}const Mt={class:"text-center upload-title"},jt={class:"text-h6 text-center"},Lt=ge({__name:"AddProductModal",props:{productData:{}},emits:["refresh-data","add-product"],setup(a,{emit:s}){const n=a,l=s,u=Ie(),p=Ve(),c=bt(),{dialogRef:f}=_e(),S=Ne(),{isManager:z}=Ke(m(()=>S.user?.role)),w=Me(),P=k(!1),B=k(),i=k({id:null,name:"",price:null,category_id:null,unit_id:null,qty:null,description:"",images:""});$e(()=>{n.productData&&(i.value=n.productData)});async function e(){try{const r=await p.createProduct(i.value);r&&(i.value.id=r.id,u.notify({message:"Товар успешно создан, теперь вам необходимо добавить картинку",color:"primary"}),l("refresh-data"))}catch(r){console.error(r)}}function _(){l("add-product",i.value)}function d(r){const t=new FileReader;t.readAsDataURL(r[0]),t.onload=()=>{t?.result&&(B.value=String(t.result))};const v=new FormData;v.append("file",r[0]),i.value.images=v}return(r,t)=>($(),H(pt,{ref_key:"dialogRef",ref:f,modelValue:P.value,"onUpdate:modelValue":t[8]||(t[8]=v=>P.value=v),persistent:""},{default:U(()=>[D(Qe,{class:"add-product"},{default:U(()=>[W(z)?($(),H(Ue,{key:0,greedy:""},{default:U(()=>[D(ue,null,{default:U(()=>[t[11]||(t[11]=R("div",{class:"text-h6 q-mb-md"},"Добавление товара",-1)),D(Vt,{class:"q-mt-sm",ref:"uploaderRef",color:"primary",flat:"",onAdded:d},{header:U(()=>[...t[9]||(t[9]=[])]),list:U(()=>[D(Dt),R("div",Mt,[D(Re,{class:"q-mr-sm",name:"note_add",size:"24px"}),t[10]||(t[10]=R("span",null,"Загрузить картинку",-1))])]),_:1},512),B.value?($(),H(pe,{key:0,class:"q-mt-sm",src:B.value},null,8,["src"])):se("",!0),D(le,{modelValue:i.value.name,"onUpdate:modelValue":t[0]||(t[0]=v=>i.value.name=v),class:"q-mb-xs",outlined:"",label:"Наименование товара"},null,8,["modelValue"]),D(le,{modelValue:i.value.price,"onUpdate:modelValue":t[1]||(t[1]=v=>i.value.price=v),class:"q-mb-xs",outlined:"",label:"Стоимость товара"},null,8,["modelValue"]),D(le,{modelValue:i.value.qty,"onUpdate:modelValue":t[2]||(t[2]=v=>i.value.qty=v),class:"q-mb-xs",outlined:"",label:"Количество"},null,8,["modelValue"]),D(Ce,{modelValue:i.value.category_id,"onUpdate:modelValue":t[3]||(t[3]=v=>i.value.category_id=v),options:W(c).categories,class:"q-mb-xs",outlined:"",label:"Тип тары","emit-value":"","map-options":"","option-label":"name","option-value":"id"},null,8,["modelValue","options"]),D(Ce,{modelValue:i.value.unit_id,"onUpdate:modelValue":t[4]||(t[4]=v=>i.value.unit_id=v),options:W(w).units,outlined:"",label:"Вес","emit-value":"","map-options":"","option-label":"name","option-value":"id"},null,8,["modelValue","options"]),D(le,{class:"q-mt-sm",modelValue:i.value.description,"onUpdate:modelValue":t[5]||(t[5]=v=>i.value.description=v),filled:"",type:"textarea",rows:"2",label:"Описание"},null,8,["modelValue"])]),_:1}),D(ve,{align:"right"},{default:U(()=>[oe(D(T,{color:"red",label:"Отмена"},null,512),[[re]]),oe(D(T,{color:"primary",label:"Подтвердить",onClick:t[6]||(t[6]=v=>e())},null,512),[[re]])]),_:1})]),_:1})):($(),H(Ue,{key:1},{default:U(()=>[D(ue,null,{default:U(()=>[D(pe,{class:"q-mt-sm",src:i.value?.images},null,8,["src"]),R("div",jt,G(i.value.name),1),R("div",null,"Стоимость товара: "+G(i.value.price),1),R("div",null,"Количество: "+G(i.value.qty),1),t[12]||(t[12]=R("div",null,"Вес: 11 ",-1)),R("div",null,"Описание: "+G(i.value.description),1)]),_:1}),D(ve,{align:"right"},{default:U(()=>[oe(D(T,{color:"red",label:"Отмена"},null,512),[[re]]),oe(D(T,{color:"primary",label:"Добавить в карзину",onClick:t[7]||(t[7]=v=>_())},null,512),[[re]])]),_:1})]),_:1}))]),_:1})]),_:1},8,["modelValue"]))}}),Ot=je(Lt,[["__scopeId","data-v-3af76f8b"]]),Tt={class:"product-card row q-col-gutter-xs"},Ht=["onClick"],Gt={class:"text-center card-title"},Kt={class:"text-center"},Wt={class:"text-bold"},Yt={key:0,class:"text-grey old-price"},Xt=ge({__name:"ProductList",setup(a){const s=Ie(),n=Me(),l=Ve(),u=_t(),p=Ne(),{isManager:c}=Ke(m(()=>p.user?.role)),f=k(!1),S=k(!1),z=k();$e(async()=>{try{await n.fetchUnits(),s.loading.show()}catch(d){console.error(d)}finally{s.loading.hide()}});function w(){P()}async function P(){try{s.loading.show();const d=await l.fetchProducts(l.pagination);d&&(l.pagination.total=d.total,l.pagination.has_more=d.has_more,l?.products?.length?l.products.push(d.items):l.products=d.items)}catch(d){console.error(d)}finally{s.loading.hide()}}function B(d){try{if(s.loading.show(),u.basketData?.length){const r=u.basketData.find(t=>t.id===d.id);r?i(r,d):u.basketData.push(structuredClone(ke(d)))}else u.basketData.push(structuredClone(ke(d)))}catch(r){console.error(r)}finally{s.notify({message:`Товар ${d.name} добавлен в корзину`,color:"primary"}),s.loading.hide()}}function i(d,r){d.price&&(d.price+=r.price),d.weight&&(d.weight+=r.weight),d.oldPrice&&(d.oldPrice+=r.oldPrice)}const e=async(d,r)=>{if(!l.pagination.has_more){f.value=!0,r(!0);return}await P(),l.pagination.offset+=l.pagination.limit,r()};function _(d){z.value=d,S.value=!S.value}return(d,r)=>($(),H(ht,{onLoad:e,offset:250},{default:U(()=>[W(c)?($(),H(T,{key:0,onClick:r[0]||(r[0]=t=>_()),class:"full-width q-mb-sm",color:"secondary",label:"Добавление товара"})):se("",!0),R("div",Tt,[($(!0),ce(gt,null,mt(W(l).products,(t,v)=>($(),ce("div",{class:"col-6",key:v},[D(Qe,{class:"my-card radius-12 full-height",style:{"border-radius":"20px"},flat:"",bordered:""},{default:U(()=>[D(ue,{class:"q-pa-sm full-height"},{default:U(()=>[R("div",{onClick:Q=>_(t)},[D(pe,{class:"cursor-pointer",src:"https://media.istockphoto.com/id/1141529240/ru/%D0%B2%D0%B5%D0%BA%D1%82%D0%BE%D1%80%D0%BD%D0%B0%D1%8F/%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D0%B5-%D1%8F%D0%B1%D0%BB%D0%BE%D0%BA%D0%BE-%D0%B2-%D0%BF%D0%BB%D0%BE%D1%81%D0%BA%D0%BE%D0%BC-%D1%81%D1%82%D0%B8%D0%BB%D0%B5-%D0%B8%D0%BB%D0%BB%D1%8E%D1%81%D1%82%D1%80%D0%B0%D1%86%D0%B8%D1%8F-%D0%B2%D0%B5%D0%BA%D1%82%D0%BE%D1%80%D0%B0.jpg?s=612x612&w=0&k=20&c=B-KXrA7VTm8E6t4jk9qcuFz8bDFzTJwiIGaYGYUcsZI="})],8,Ht),D(ue,{class:"q-pa-sm"},{default:U(()=>[R("div",Gt,G(t.name),1),R("div",Kt,[R("span",Wt,G(t.price),1),r[3]||(r[3]=Be(" ₽ ",-1)),t?.oldPrice?($(),ce("span",Yt,G(t.old_price)+" ₽",1)):se("",!0),Be(" / "+G(t.unit_symbol),1)])]),_:2},1024),D(ve,{class:"justify-center"},{default:U(()=>[D(T,{dense:"","no-caps":"",class:"full-width",color:"secondary",icon:"add_shopping_cart",label:"В корзину",onClick:Q=>B(t)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]))),128))]),S.value?($(),H(Ot,{key:1,modelValue:S.value,"onUpdate:modelValue":r[1]||(r[1]=t=>S.value=t),productData:z.value,onRefreshData:r[2]||(r[2]=t=>w()),onAddProduct:B},null,8,["modelValue","productData"])):se("",!0)]),_:1}))}}),Jt=je(Xt,[["__scopeId","data-v-219dcff6"]]),da=ge({__name:"DashboardPage",setup(a){return(s,n)=>($(),H(Ft,{class:"q-mx-xs"},{default:U(()=>[D(Jt,{class:"q-mb-lg"})]),_:1}))}});export{da as default};
