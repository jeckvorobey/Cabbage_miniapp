import{aX as x,r as c,aY as p,d as b,aj as w,ai as v,aE as C,an as n,f as l,aH as h,aF as y,ao as i,aD as m,aZ as S,aG as U,Y as V,Q as A,o as q,ah as k,ak as $,am as B,ad as D}from"./index-CcfvS8Eu.js";import{Q as M}from"./QSelect-tCYPj9mk.js";import{u as _}from"./use-quasar-DtARRiGq.js";import{Q as N}from"./QForm-OuceneqC.js";import{C as g}from"./ClosePopup-BMFTL8MB.js";import"./QItem-bG1dKP_L.js";import"./QMenu-DeP7sQlF.js";import"./rtl-D3GObVCM.js";const Q=x("Addresses",()=>{const f=c();async function u(){return p.get("addresses").then(a=>a.data).catch(a=>{throw console.error("[AddressesStore] - An error occurred while fetching via fetchAddresses",a.message),a})}async function r(a){return p.post("addresses",a).then(e=>e.data).catch(e=>{throw console.error("[AddressesStore] - An error occurred while createing via createAddress",e.message),e})}async function o(a){return p.patch(`/addresses/${a.id}`,a).then(e=>e.data).catch(e=>{throw console.error("[AddressesStore] - An error occurred while creating via updateAddress",e.message),e})}async function d(a){return p.delete(`addresses/${a}`).then(e=>e.data).catch(e=>{throw console.error("[AddressesStore] - An error occurred while deleting via deleteAddress",e.message),e})}return{addresses:f,fetchAddresses:u,createAddress:r,updateAddress:o,deleteAddress:d}}),E=b({__name:"AddAddressModal",setup(f){const u=Q(),r=c(!0),o=c({address_line:"",comment:"",is_default:!1});async function d(){try{await u.createAddress(o.value)}catch(a){console.error(a)}}return(a,e)=>(v(),w(C,{ref:"dialogRef",modelValue:r.value,"onUpdate:modelValue":e[4]||(e[4]=s=>r.value=s),persistent:""},{default:n(()=>[l(h,{class:""},{default:n(()=>[l(N,{greedy:""},{default:n(()=>[l(y,null,{default:n(()=>[e[5]||(e[5]=i("div",{class:"text-h6"},"Создание нового адреса доставки",-1)),e[6]||(e[6]=i("div",{class:"text-subtitle2"},"Введите адрес доставки",-1)),l(m,{class:"q-mb-sm",outlined:"",modelValue:o.value.address_line,"onUpdate:modelValue":e[0]||(e[0]=s=>o.value.address_line=s),label:"Адрес"},null,8,["modelValue"]),l(m,{label:"Комментарий",modelValue:o.value.comment,"onUpdate:modelValue":e[1]||(e[1]=s=>o.value.comment=s),outlined:"",type:"textarea",rows:"3"},null,8,["modelValue"]),l(S,{modelValue:o.value.is_default,"onUpdate:modelValue":e[2]||(e[2]=s=>o.value.is_default=s),label:"Активный аддрес"},null,8,["modelValue"])]),_:1}),l(U,{align:"right"},{default:n(()=>[V(l(A,{color:"red",flat:"",label:"Отмена"},null,512),[[g]]),V(l(A,{color:"primary",flat:"",label:"Сохранить",onClick:e[3]||(e[3]=s=>d())},null,512),[[g]])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),F={class:"q-pa-sm"},I={class:"row items-center q-mb-sm"},X=b({__name:"UserPage",setup(f){const u=_(),r=Q(),o=c(!1),d=c({name:"",mail:"",phone:"",addres:""});q(()=>{a()});async function a(){try{u.loading.show();const e=await r.fetchAddresses();e&&(r.addresses=e.items)}catch(e){console.error(e)}finally{u.loading.hide()}}return(e,s)=>(v(),k("div",null,[s[7]||(s[7]=i("h6",{class:"text-center q-mb-md"},"Личный кабинет",-1)),i("div",F,[l(h,{class:"my-card full-height",flat:"",bordered:""},{default:n(()=>[l(y,null,{default:n(()=>[s[6]||(s[6]=i("div",{class:"text-h6"},"Ваши данные:",-1)),l(m,{class:"q-mb-sm",outlined:"",modelValue:d.value.name,"onUpdate:modelValue":s[0]||(s[0]=t=>d.value.name=t),label:"Имя"},null,8,["modelValue"]),l(m,{class:"q-mb-sm",outlined:"",modelValue:d.value.phone,"onUpdate:modelValue":s[1]||(s[1]=t=>d.value.phone=t),label:"Телефон"},null,8,["modelValue"]),l(m,{class:"q-mb-sm",outlined:"",modelValue:d.value.mail,"onUpdate:modelValue":s[2]||(s[2]=t=>d.value.mail=t),label:"Mail"},null,8,["modelValue"]),i("div",I,[l(M,{modelValue:d.value.addres,"onUpdate:modelValue":s[3]||(s[3]=t=>d.value.addres=t),options:B(r).addresses,class:"col-10",outlined:"",label:"Адрес","emit-value":"","map-options":"","option-label":"address_line","option-value":"id"},null,8,["modelValue","options"]),l(D,{onClick:s[4]||(s[4]=t=>o.value=!o.value),name:"add",size:"34px",color:"green",class:"col-2"})])]),_:1})]),_:1})]),o.value?(v(),w(E,{key:0,modelValue:o.value,"onUpdate:modelValue":s[5]||(s[5]=t=>o.value=t)},null,8,["modelValue"])):$("",!0)]))}});export{X as default};
