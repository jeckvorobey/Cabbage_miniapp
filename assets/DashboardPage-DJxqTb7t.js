import{k as oe,g as Z,a as se,v as I,x as Te,$ as Me,c as D,h as _,l as He,aw as ke,ax as Ke,ay as We,az as Ye,r as B,L as Be,N as we,G as Xe,P as Je,S as Ze,w as Ge,n as et,i as tt,aA as at,aB as ot,aC as be,aD as lt,ad as Ce,Q as X,_ as rt,aE as nt,d as ce,aj as Y,ai as j,aF as st,an as $,f as q,aG as ue,ao as O,ak as ae,av as re,am as ie,aH as ze,Y as ut,as as Ue,o as it,ah as ne,aq as dt,F as ct,ap as ee,at as Fe,aI as De}from"./index-CJK5khiL.js";import{u as Pe,Q as $e,a as ft}from"./orderStore-BA_WsMAb.js";import{Q as pt}from"./QInfiniteScroll-CPD_5jvD.js";import{u as Ee}from"./use-quasar-Bh8tBMcT.js";import{Q as xe}from"./QSelect-CnVxBtqX.js";import{b as vt,h as Se,u as mt}from"./categoriesStore-CRu8v48v.js";import{u as Qe,Q as gt}from"./unitsStore-DOYgWu5l.js";import{C as _t}from"./ClosePopup-BHpy8UbB.js";import{_ as Re}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./QMenu-BaGI2exO.js";import"./selection-CpwKneQY.js";const ht=oe({name:"QPage",props:{padding:Boolean,styleFn:Function},setup(t,{slots:i}){const{proxy:{$q:n}}=Z(),a=se(Te,I);if(a===I)return console.error("QPage needs to be a deep child of QLayout"),I;if(se(Me,I)===I)return console.error("QPage needs to be child of QPageContainer"),I;const c=D(()=>{const F=(a.header.space===!0?a.header.size:0)+(a.footer.space===!0?a.footer.size:0);if(typeof t.styleFn=="function"){const k=a.isContainer.value===!0?a.containerHeight.value:n.screen.height;return t.styleFn(F,k)}return{minHeight:a.isContainer.value===!0?a.containerHeight.value-F+"px":n.screen.height===0?F!==0?`calc(100vh - ${F}px)`:"100vh":n.screen.height-F+"px"}}),f=D(()=>`q-page${t.padding===!0?" q-layout-padding":""}`);return()=>_("main",{class:f.value,style:c.value},He(i.default))}}),yt=oe({name:"QUploaderAddTrigger",setup(){const t=se(ke,I);return t===I&&console.error("QUploaderAddTrigger needs to be child of QUploader"),t}}),bt={...Ke,min:{type:Number,default:0},max:{type:Number,default:100},color:String,centerColor:String,trackColor:String,fontSize:String,rounded:Boolean,thickness:{type:Number,default:.2,validator:t=>t>=0&&t<=1},angle:{type:Number,default:0},showValue:Boolean,reverse:Boolean,instantFeedback:Boolean},de=50,Ae=2*de,Le=Ae*Math.PI,Ft=Math.round(Le*1e3)/1e3,Dt=oe({name:"QCircularProgress",props:{...bt,value:{type:Number,default:0},animationSpeed:{type:[String,Number],default:600},indeterminate:Boolean},setup(t,{slots:i}){const{proxy:{$q:n}}=Z(),a=We(t),s=D(()=>{const u=(n.lang.rtl===!0?-1:1)*t.angle;return{transform:t.reverse!==(n.lang.rtl===!0)?`scale3d(-1, 1, 1) rotate3d(0, 0, 1, ${-90-u}deg)`:`rotate3d(0, 0, 1, ${u-90}deg)`}}),c=D(()=>t.instantFeedback!==!0&&t.indeterminate!==!0?{transition:`stroke-dashoffset ${t.animationSpeed}ms ease 0s, stroke ${t.animationSpeed}ms ease`}:""),f=D(()=>Ae/(1-t.thickness/2)),F=D(()=>`${f.value/2} ${f.value/2} ${f.value} ${f.value}`),k=D(()=>vt(t.value,t.min,t.max)),w=D(()=>t.max-t.min),p=D(()=>t.thickness/2*f.value),U=D(()=>{const u=(t.max-k.value)/w.value,e=t.rounded===!0&&k.value<t.max&&u<.25?p.value/2*(1-u/.25):0;return Le*u+e});function d({thickness:u,offset:e,color:l,cls:v,rounded:h}){return _("circle",{class:"q-circular-progress__"+v+(l!==void 0?` text-${l}`:""),style:c.value,fill:"transparent",stroke:"currentColor","stroke-width":u,"stroke-dasharray":Ft,"stroke-dashoffset":e,"stroke-linecap":h,cx:f.value,cy:f.value,r:de})}return()=>{const u=[];t.centerColor!==void 0&&t.centerColor!=="transparent"&&u.push(_("circle",{class:`q-circular-progress__center text-${t.centerColor}`,fill:"currentColor",r:de-p.value/2,cx:f.value,cy:f.value})),t.trackColor!==void 0&&t.trackColor!=="transparent"&&u.push(d({cls:"track",thickness:p.value,offset:0,color:t.trackColor})),u.push(d({cls:"circle",thickness:p.value,offset:U.value,color:t.color,rounded:t.rounded===!0?"round":void 0}));const e=[_("svg",{class:"q-circular-progress__svg",style:s.value,viewBox:F.value,"aria-hidden":"true"},u)];return t.showValue===!0&&e.push(_("div",{class:"q-circular-progress__text absolute-full row flex-center content-center",style:{fontSize:t.fontSize}},i.default!==void 0?i.default():[_("div",k.value)])),_("div",{class:`q-circular-progress q-circular-progress--${t.indeterminate===!0?"in":""}determinate`,style:a.value,role:"progressbar","aria-valuemin":t.min,"aria-valuemax":t.max,"aria-valuenow":t.indeterminate===!0?void 0:k.value},Ye(i.internal,e))}}});function W(t,i,n,a){const s=[];return t.forEach(c=>{a(c)===!0?s.push(c):i.push({failedPropValidation:n,file:c})}),s}function te(t){t?.dataTransfer&&(t.dataTransfer.dropEffect="copy"),we(t)}const xt={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},St=["rejected"];function qt({editable:t,dnd:i,getFileInput:n,addFilesToQueue:a}){const{props:s,emit:c,proxy:f}=Z(),F=B(null),k=D(()=>s.accept!==void 0?s.accept.split(",").map(r=>(r=r.trim(),r==="*"?"*/":(r.endsWith("/*")&&(r=r.slice(0,r.length-1)),r.toUpperCase()))):null),w=D(()=>parseInt(s.maxFiles,10)),p=D(()=>parseInt(s.maxTotalSize,10));function U(r){if(t.value)if(r!==Object(r)&&(r={target:null}),r.target?.matches('input[type="file"]')===!0)r.clientX===0&&r.clientY===0&&Be(r);else{const P=n();P!==r.target&&P?.click(r)}}function d(r){t.value&&r&&a(null,r)}function u(r,P,N,V){let g=Array.from(P||r.target.files);const x=[],E=()=>{x.length!==0&&c("rejected",x)};if(s.accept!==void 0&&k.value.indexOf("*/")===-1&&(g=W(g,x,"accept",y=>k.value.some(S=>y.type.toUpperCase().startsWith(S)||y.name.toUpperCase().endsWith(S))),g.length===0))return E();if(s.maxFileSize!==void 0){const y=parseInt(s.maxFileSize,10);if(g=W(g,x,"max-file-size",S=>S.size<=y),g.length===0)return E()}if(s.multiple!==!0&&g.length!==0&&(g=[g[0]]),g.forEach(y=>{y.__key=y.webkitRelativePath+y.lastModified+y.name+y.size}),V===!0){const y=N.map(S=>S.__key);g=W(g,x,"duplicate",S=>y.includes(S.__key)===!1)}if(g.length===0)return E();if(s.maxTotalSize!==void 0){let y=V===!0?N.reduce((S,R)=>S+R.size,0):0;if(g=W(g,x,"max-total-size",S=>(y+=S.size,y<=p.value)),g.length===0)return E()}if(typeof s.filter=="function"){const y=s.filter(g);g=W(g,x,"filter",S=>y.includes(S))}if(s.maxFiles!==void 0){let y=V===!0?N.length:0;if(g=W(g,x,"max-files",()=>(y++,y<=w.value)),g.length===0)return E()}if(E(),g.length!==0)return g}function e(r){te(r),i.value!==!0&&(i.value=!0)}function l(r){we(r),(r.relatedTarget!==null||Xe.is.safari!==!0?r.relatedTarget!==F.value:document.elementsFromPoint(r.clientX,r.clientY).includes(F.value)===!1)===!0&&(i.value=!1)}function v(r){te(r);const P=r.dataTransfer.files;P.length!==0&&a(null,P),i.value=!1}function h(r){if(i.value===!0)return _("div",{ref:F,class:`q-${r}__dnd absolute-full`,onDragenter:te,onDragover:te,onDragleave:l,onDrop:v})}return Object.assign(f,{pickFiles:U,addFiles:d}),{pickFiles:U,addFiles:d,onDragover:e,onDragleave:l,processFiles:u,getDndNode:h,maxFilesNumber:w,maxTotalSizeNumber:p}}function qe(t){return(t*100).toFixed(2)+"%"}const kt={...Je,...xt,label:String,color:String,textColor:String,square:Boolean,flat:Boolean,bordered:Boolean,noThumbnails:Boolean,thumbnailFit:{type:String,default:"cover"},autoUpload:Boolean,hideUploadBtn:Boolean,disable:Boolean,readonly:Boolean},je=[...St,"start","finish","added","removed"];function Bt(t,i){const n=Z(),{props:a,slots:s,emit:c,proxy:f}=n,{$q:F}=f,k=Ze(a,F);function w(o,b,C){if(o.__status=b,b==="idle"){o.__uploaded=0,o.__progress=0,o.__sizeLabel=Se(o.size),o.__progressLabel="0.00%";return}if(b==="failed"){f.$forceUpdate();return}o.__uploaded=b==="uploaded"?o.size:C,o.__progress=b==="uploaded"?1:Math.min(.9999,o.__uploaded/o.size),o.__progressLabel=qe(o.__progress),f.$forceUpdate()}const p=D(()=>a.disable!==!0&&a.readonly!==!0),U=B(!1),d=B(null),u=B(null),e={files:B([]),queuedFiles:B([]),uploadedFiles:B([]),uploadedSize:B(0),updateFileStatus:w,isAlive:()=>lt(n)===!1},{pickFiles:l,addFiles:v,onDragover:h,onDragleave:r,processFiles:P,getDndNode:N,maxFilesNumber:V,maxTotalSizeNumber:g}=qt({editable:p,dnd:U,getFileInput:me,addFilesToQueue:ge});Object.assign(e,t({props:a,slots:s,emit:c,helpers:e,exposeApi:o=>{Object.assign(e,o)}})),e.isBusy===void 0&&(e.isBusy=B(!1));const x=B(0),E=D(()=>x.value===0?0:e.uploadedSize.value/x.value),y=D(()=>qe(E.value)),S=D(()=>Se(x.value)),R=D(()=>p.value===!0&&e.isUploading.value!==!0&&(a.multiple===!0||e.queuedFiles.value.length===0)&&(a.maxFiles===void 0||e.files.value.length<V.value)&&(a.maxTotalSize===void 0||x.value<g.value)),m=D(()=>p.value===!0&&e.isBusy.value!==!0&&e.isUploading.value!==!0&&e.queuedFiles.value.length!==0);rt(ke,he);const T=D(()=>"q-uploader column no-wrap"+(k.value===!0?" q-uploader--dark q-dark":"")+(a.bordered===!0?" q-uploader--bordered":"")+(a.square===!0?" q-uploader--square no-border-radius":"")+(a.flat===!0?" q-uploader--flat no-shadow":"")+(a.disable===!0?" disabled q-uploader--disable":"")+(U.value===!0?" q-uploader--dnd":"")),M=D(()=>"q-uploader__header"+(a.color!==void 0?` bg-${a.color}`:"")+(a.textColor!==void 0?` text-${a.textColor}`:""));Ge(e.isUploading,(o,b)=>{b===!1&&o===!0?c("start"):b===!0&&o===!1&&c("finish")});function H(){a.disable===!1&&(e.abort(),e.uploadedSize.value=0,x.value=0,ve(),e.files.value=[],e.queuedFiles.value=[],e.uploadedFiles.value=[])}function Q(){a.disable===!1&&pe(["uploaded"],()=>{e.uploadedFiles.value=[]})}function G(){pe(["idle","failed"],({size:o})=>{x.value-=o,e.queuedFiles.value=[]})}function pe(o,b){if(a.disable===!0)return;const C={files:[],size:0},A=e.files.value.filter(z=>o.indexOf(z.__status)===-1?!0:(C.size+=z.size,C.files.push(z),z.__img!==void 0&&window.URL.revokeObjectURL(z.__img.src),!1));C.files.length!==0&&(e.files.value=A,b(C),c("removed",C.files))}function le(o){a.disable||(o.__status==="uploaded"?e.uploadedFiles.value=e.uploadedFiles.value.filter(b=>b.__key!==o.__key):o.__status==="uploading"?o.__abort():x.value-=o.size,e.files.value=e.files.value.filter(b=>b.__key!==o.__key?!0:(b.__img!==void 0&&window.URL.revokeObjectURL(b.__img.src),!1)),e.queuedFiles.value=e.queuedFiles.value.filter(b=>b.__key!==o.__key),c("removed",[o]))}function ve(){e.files.value.forEach(o=>{o.__img!==void 0&&window.URL.revokeObjectURL(o.__img.src)})}function me(){return u.value||d.value.getElementsByClassName("q-uploader__input")[0]}function ge(o,b){const C=P(o,b,e.files.value,!0),A=me();A!=null&&(A.value=""),C!==void 0&&(C.forEach(z=>{if(e.updateFileStatus(z,"idle"),x.value+=z.size,a.noThumbnails!==!0&&z.type.toUpperCase().startsWith("IMAGE")){const ye=new Image;ye.src=window.URL.createObjectURL(z),z.__img=ye}}),e.files.value=e.files.value.concat(C),e.queuedFiles.value=e.queuedFiles.value.concat(C),c("added",C),a.autoUpload===!0&&e.upload())}function _e(){m.value===!0&&e.upload()}function J(o,b,C){if(o===!0){const A={type:"a",key:b,icon:F.iconSet.uploader[b],flat:!0,dense:!0};let z;return b==="add"?(A.onClick=l,z=he):A.onClick=C,_(X,A,z)}}function he(){return _("input",{ref:u,class:"q-uploader__input overflow-hidden absolute-full",tabindex:-1,type:"file",title:"",accept:a.accept,multiple:a.multiple===!0?"multiple":void 0,capture:a.capture,onMousedown:Be,onClick:l,onChange:ge})}function Ie(){return s.header!==void 0?s.header(K):[_("div",{class:"q-uploader__header-content column"},[_("div",{class:"flex flex-center no-wrap q-gutter-xs"},[J(e.queuedFiles.value.length!==0,"removeQueue",G),J(e.uploadedFiles.value.length!==0,"removeUploaded",Q),e.isUploading.value===!0?_(be,{class:"q-uploader__spinner"}):null,_("div",{class:"col column justify-center"},[a.label!==void 0?_("div",{class:"q-uploader__title"},[a.label]):null,_("div",{class:"q-uploader__subtitle"},[S.value+" / "+y.value])]),J(R.value,"add"),J(a.hideUploadBtn===!1&&m.value===!0,"upload",e.upload),J(e.isUploading.value,"clear",e.abort)])])]}function Oe(){return s.list!==void 0?s.list(K):e.files.value.map(o=>_("div",{key:o.__key,class:"q-uploader__file relative-position"+(a.noThumbnails!==!0&&o.__img!==void 0?" q-uploader__file--img":"")+(o.__status==="failed"?" q-uploader__file--failed":o.__status==="uploaded"?" q-uploader__file--uploaded":""),style:a.noThumbnails!==!0&&o.__img!==void 0?{backgroundImage:'url("'+o.__img.src+'")',backgroundSize:a.thumbnailFit}:null},[_("div",{class:"q-uploader__file-header row flex-center no-wrap"},[o.__status==="failed"?_(Ce,{class:"q-uploader__file-status",name:F.iconSet.type.negative,color:"negative"}):null,_("div",{class:"q-uploader__file-header-content col"},[_("div",{class:"q-uploader__title"},[o.name]),_("div",{class:"q-uploader__subtitle row items-center no-wrap"},[o.__sizeLabel+" / "+o.__progressLabel])]),o.__status==="uploading"?_(Dt,{value:o.__progress,min:0,max:1,indeterminate:o.__progress===0}):_(X,{round:!0,dense:!0,flat:!0,icon:F.iconSet.uploader[o.__status==="uploaded"?"done":"clear"],onClick:()=>{le(o)}})])]))}et(()=>{e.isUploading.value===!0&&e.abort(),e.files.value.length!==0&&ve()});const K={};for(const o in e)tt(e[o])===!0?at(K,o,()=>e[o].value):K[o]=e[o];return Object.assign(K,{upload:_e,reset:H,removeUploadedFiles:Q,removeQueuedFiles:G,removeFile:le,pickFiles:l,addFiles:v}),ot(K,{canAddFiles:()=>R.value,canUpload:()=>m.value,uploadSizeLabel:()=>S.value,uploadProgressLabel:()=>y.value}),i({...e,upload:_e,reset:H,removeUploadedFiles:Q,removeQueuedFiles:G,removeFile:le,pickFiles:l,addFiles:v,canAddFiles:R,canUpload:m,uploadSizeLabel:S,uploadProgressLabel:y}),()=>{const o=[_("div",{class:M.value},Ie()),_("div",{class:"q-uploader__list scroll"},Oe()),N("uploader")];e.isBusy.value===!0&&o.push(_("div",{class:"q-uploader__overlay absolute-full flex flex-center"},[_(be)]));const b={ref:d,class:T.value};return R.value===!0&&Object.assign(b,{onDragover:h,onDragleave:r}),_("div",b,o)}}const wt=()=>!0;function Ne(t){const i={};return t.forEach(n=>{i[n]=wt}),i}const Ct=Ne(je),zt=({name:t,props:i,emits:n,injectPlugin:a})=>oe({name:t,props:{...kt,...i},emits:nt(n)===!0?{...Ct,...n}:[...je,...n],setup(s,{expose:c}){return Bt(a,c)}});function L(t){return typeof t=="function"?t:()=>t}const Ut="QUploader",Pt={url:[Function,String],method:{type:[Function,String],default:"POST"},fieldName:{type:[Function,String],default:()=>t=>t.name},headers:[Function,Array],formFields:[Function,Array],withCredentials:[Function,Boolean],sendRaw:[Function,Boolean],batch:[Function,Boolean],factory:Function},$t=["factoryFailed","uploaded","failed","uploading"];function Et({props:t,emit:i,helpers:n}){const a=B([]),s=B([]),c=B(0),f=D(()=>({url:L(t.url),method:L(t.method),headers:L(t.headers),formFields:L(t.formFields),fieldName:L(t.fieldName),withCredentials:L(t.withCredentials),sendRaw:L(t.sendRaw),batch:L(t.batch)})),F=D(()=>c.value>0),k=D(()=>s.value.length!==0);let w;function p(){a.value.forEach(e=>{e.abort()}),s.value.length!==0&&(w=!0)}function U(){const e=n.queuedFiles.value.slice(0);n.queuedFiles.value=[],f.value.batch(e)?d(e):e.forEach(l=>{d([l])})}function d(e){if(c.value++,typeof t.factory!="function"){u(e,{});return}const l=t.factory(e);if(!l)i("factoryFailed",new Error("QUploader: factory() does not return properly"),e),c.value--;else if(typeof l.catch=="function"&&typeof l.then=="function"){s.value.push(l);const v=h=>{n.isAlive()===!0&&(s.value=s.value.filter(r=>r!==l),s.value.length===0&&(w=!1),n.queuedFiles.value=n.queuedFiles.value.concat(e),e.forEach(r=>{n.updateFileStatus(r,"failed")}),i("factoryFailed",h,e),c.value--)};l.then(h=>{w===!0?v(new Error("Aborted")):n.isAlive()===!0&&(s.value=s.value.filter(r=>r!==l),u(e,h))}).catch(v)}else u(e,l||{})}function u(e,l){const v=new FormData,h=new XMLHttpRequest,r=(m,T)=>l[m]!==void 0?L(l[m])(T):f.value[m](T),P=r("url",e);if(!P){console.error("q-uploader: invalid or no URL specified"),c.value--;return}const N=r("formFields",e);N!==void 0&&N.forEach(m=>{v.append(m.name,m.value)});let V=0,g=0,x=0,E=0,y;h.upload.addEventListener("progress",m=>{if(y===!0)return;const T=Math.min(E,m.loaded);n.uploadedSize.value+=T-x,x=T;let M=x-g;for(let H=V;M>0&&H<e.length;H++){const Q=e[H];if(M>Q.size)M-=Q.size,V++,g+=Q.size,n.updateFileStatus(Q,"uploading",Q.size);else{n.updateFileStatus(Q,"uploading",M);return}}},!1),h.onreadystatechange=()=>{h.readyState<4||(h.status&&h.status<400?(n.uploadedFiles.value=n.uploadedFiles.value.concat(e),e.forEach(m=>{n.updateFileStatus(m,"uploaded")}),i("uploaded",{files:e,xhr:h})):(y=!0,n.uploadedSize.value-=x,n.queuedFiles.value=n.queuedFiles.value.concat(e),e.forEach(m=>{n.updateFileStatus(m,"failed")}),i("failed",{files:e,xhr:h})),c.value--,a.value=a.value.filter(m=>m!==h))},h.open(r("method",e),P),r("withCredentials",e)===!0&&(h.withCredentials=!0);const S=r("headers",e);S!==void 0&&S.forEach(m=>{h.setRequestHeader(m.name,m.value)});const R=r("sendRaw",e);e.forEach(m=>{n.updateFileStatus(m,"uploading",0),R!==!0&&v.append(r("fieldName",m),m,m.name),m.xhr=h,m.__abort=()=>{h.abort()},E+=m.size}),i("uploading",{files:e,xhr:h}),a.value.push(h),R===!0?h.send(new Blob(e)):h.send(v)}return{isUploading:F,isBusy:k,abort:p,upload:U}}const Qt={name:Ut,props:Pt,emits:$t,injectPlugin:Et},Rt=zt(Qt);function fe(){const{emit:t,proxy:i}=Z(),n=B(null);function a(){n.value.show()}function s(){n.value.hide()}function c(F){t("ok",F),s()}function f(){t("hide")}return Object.assign(i,{show:a,hide:s}),{dialogRef:n,onDialogHide:f,onDialogOK:c,onDialogCancel:s}}const Ve=["ok","hide"];fe.emits=Ve;fe.emitsObject=Ne(Ve);const At={class:"text-center upload-title"},Lt=ce({__name:"AddProductModal",emits:["refresh-data"],setup(t,{emit:i}){const n=i,a=Ee(),s=Pe(),c=mt(),{dialogRef:f}=fe(),F=Qe(),k=B(!1),w=B(),p=B({id:null,name:"",category_id:"",unit_id:"",qty:null,description:""});async function U(){try{const e=await s.createProduct(p.value);e&&(p.value.id=e.id,a.notify({message:"Товар успешно создан, теперь вам необходимо добавить картинку",color:"primary"}))}catch(e){console.error(e)}}function d(e){const l=new FileReader;l.readAsDataURL(e[0]),l.onload=()=>{l?.result&&(w.value=String(l.result))},u(e[0])}async function u(e){const l=new FormData;l.append("file",e);try{await s.uploadFile(p.value.id,l)&&(a.notify({message:"Картинка успешно добавлена",color:"primary"}),f.value?.hide())}catch(v){console.error(v)}finally{n("refresh-data")}}return(e,l)=>(j(),Y(st,{ref_key:"dialogRef",ref:f,modelValue:k.value,"onUpdate:modelValue":l[6]||(l[6]=v=>k.value=v),persistent:""},{default:$(()=>[q(Ue,{class:"add-product"},{default:$(()=>[q(gt,{greedy:""},{default:$(()=>[q(ue,null,{default:$(()=>[l[9]||(l[9]=O("div",{class:"text-h6 q-mb-md"},"Добавление товара",-1)),q(re,{modelValue:p.value.name,"onUpdate:modelValue":l[0]||(l[0]=v=>p.value.name=v),class:"q-mb-xs",outlined:"",label:"Наименование товара"},null,8,["modelValue"]),q(re,{modelValue:p.value.qty,"onUpdate:modelValue":l[1]||(l[1]=v=>p.value.qty=v),class:"q-mb-xs",outlined:"",label:"Количество"},null,8,["modelValue"]),q(xe,{modelValue:p.value.category_id,"onUpdate:modelValue":l[2]||(l[2]=v=>p.value.category_id=v),options:ie(c).categories,class:"q-mb-xs",outlined:"",label:"Тип тары","emit-value":"","map-options":"","option-label":"name","option-value":"id"},null,8,["modelValue","options"]),q(xe,{modelValue:p.value.unit_id,"onUpdate:modelValue":l[3]||(l[3]=v=>p.value.unit_id=v),options:ie(F).units,outlined:"",label:"Вес","emit-value":"","map-options":"","option-label":"name","option-value":"id"},null,8,["modelValue","options"]),q(re,{class:"q-mt-sm",modelValue:p.value.description,"onUpdate:modelValue":l[4]||(l[4]=v=>p.value.description=v),filled:"",type:"textarea",rows:"2",label:"Описание"},null,8,["modelValue"]),!w.value&&p.value.id?(j(),Y(Rt,{key:0,class:"q-mt-sm",ref:"uploaderRef",color:"primary",flat:"",onAdded:d},{header:$(()=>[...l[7]||(l[7]=[])]),list:$(()=>[q(yt),O("div",At,[q(Ce,{class:"q-mr-sm",name:"note_add",size:"24px"}),l[8]||(l[8]=O("span",null,"Загрузить картинку",-1))])]),_:1},512)):ae("",!0),w.value?(j(),Y($e,{key:1,class:"q-mt-sm",src:w.value},null,8,["src"])):ae("",!0)]),_:1}),q(ze,{align:"right"},{default:$(()=>[ut(q(X,{color:"red",label:"Отмена"},null,512),[[_t]]),q(X,{color:"primary",label:"Подтвердить",onClick:l[5]||(l[5]=v=>U())})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),jt=Re(Lt,[["__scopeId","data-v-15064176"]]),Nt={class:"product-card row q-col-gutter-xs"},Vt={class:"text-center card-title"},It={class:"text-center"},Ot={class:"text-bold"},Tt={key:0,class:"text-grey old-price"},Mt=ce({__name:"ProductList",setup(t){const i=Ee(),n=Qe(),a=Pe(),s=ft(),c=B(!1),f=B(!1);it(async()=>{try{await n.fetchUnits(),i.loading.show()}catch(d){console.error(d)}finally{i.loading.hide()}});function F(){k()}async function k(){try{i.loading.show();const d=await a.fetchProducts(a.pagination);d&&(a.pagination.total=d.total,a.pagination.has_more=d.has_more,a?.products?.length?a.products.push(d.items):a.products=d.items)}catch(d){console.error(d)}finally{i.loading.hide()}}function w(d){try{if(i.loading.show(),s.basketData?.length){const u=s.basketData.find(e=>e.id===d.id);u?p(u,d):s.basketData.push(structuredClone(De(d)))}else s.basketData.push(structuredClone(De(d)))}catch(u){console.error(u)}finally{i.notify({message:`Товар ${d.name} добавлен в корзину`,color:"primary"}),i.loading.hide()}}function p(d,u){d.price&&(d.price+=u.price),d.weight&&(d.weight+=u.weight),d.oldPrice&&(d.oldPrice+=u.oldPrice)}const U=async(d,u)=>{if(!a.pagination.has_more){c.value=!0,u(!0);return}await k(),a.pagination.offset+=a.pagination.limit,u()};return(d,u)=>(j(),Y(pt,{onLoad:U,offset:250},{default:$(()=>[q(X,{onClick:u[0]||(u[0]=e=>f.value=!f.value),class:"full-width q-mb-sm",color:"secondary",label:"Добавление товара"}),O("div",Nt,[(j(!0),ne(ct,null,dt(ie(a).products,(e,l)=>(j(),ne("div",{class:"col-6",key:l},[q(Ue,{class:"my-card radius-12 full-height",style:{"border-radius":"20px"},flat:"",bordered:""},{default:$(()=>[q(ue,{class:"q-pa-sm full-height"},{default:$(()=>[O("div",null,[q($e,{class:"cursor-pointer",src:"https://media.istockphoto.com/id/1141529240/ru/%D0%B2%D0%B5%D0%BA%D1%82%D0%BE%D1%80%D0%BD%D0%B0%D1%8F/%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D0%B5-%D1%8F%D0%B1%D0%BB%D0%BE%D0%BA%D0%BE-%D0%B2-%D0%BF%D0%BB%D0%BE%D1%81%D0%BA%D0%BE%D0%BC-%D1%81%D1%82%D0%B8%D0%BB%D0%B5-%D0%B8%D0%BB%D0%BB%D1%8E%D1%81%D1%82%D1%80%D0%B0%D1%86%D0%B8%D1%8F-%D0%B2%D0%B5%D0%BA%D1%82%D0%BE%D1%80%D0%B0.jpg?s=612x612&w=0&k=20&c=B-KXrA7VTm8E6t4jk9qcuFz8bDFzTJwiIGaYGYUcsZI="})]),q(ue,{class:"q-pa-sm"},{default:$(()=>[O("div",Vt,ee(e.name),1),O("div",It,[O("span",Ot,ee(e.price),1),u[3]||(u[3]=Fe(" ₽ ",-1)),e?.oldPrice?(j(),ne("span",Tt,ee(e.old_price)+" ₽",1)):ae("",!0),Fe(" / "+ee(e.unit_symbol),1)])]),_:2},1024),q(ze,{class:"justify-center"},{default:$(()=>[q(X,{dense:"","no-caps":"",class:"full-width",color:"secondary",icon:"add_shopping_cart",label:"В корзину",onClick:v=>w(e)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]))),128))]),f.value?(j(),Y(jt,{key:0,modelValue:f.value,"onUpdate:modelValue":u[1]||(u[1]=e=>f.value=e),onRefreshData:u[2]||(u[2]=e=>F())},null,8,["modelValue"])):ae("",!0)]),_:1}))}}),Ht=Re(Mt,[["__scopeId","data-v-fa13c6a4"]]),la=ce({__name:"DashboardPage",setup(t){return(i,n)=>(j(),Y(ht,{class:"q-mx-xs"},{default:$(()=>[q(Ht,{class:"q-mb-lg"})]),_:1}))}});export{la as default};
