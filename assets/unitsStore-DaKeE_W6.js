import{k as P,r as F,aU as C,aT as E,o as q,g as B,h as I,l as $,aD as Q,N as A,q as R,aZ as V,_ as D,a_ as j,aP as k,aQ as f}from"./index-C9Luj8DU.js";const _=P({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(a,{slots:m,emit:d}){const g=B(),i=F(null);let u=0;const e=[];function n(t){const c=typeof t=="boolean"?t:a.noErrorFocus!==!0,v=++u,b=(o,r)=>{d(`validation${o===!0?"Success":"Error"}`,r)},p=o=>{const r=o.validate();return typeof r.then=="function"?r.then(s=>({valid:s,comp:o}),s=>({valid:!1,comp:o,err:s})):Promise.resolve({valid:r,comp:o})};return(a.greedy===!0?Promise.all(e.map(p)).then(o=>o.filter(r=>r.valid!==!0)):e.reduce((o,r)=>o.then(()=>p(r).then(s=>{if(s.valid===!1)return Promise.reject(s)})),Promise.resolve()).catch(o=>[o])).then(o=>{if(o===void 0||o.length===0)return v===u&&b(!0),!0;if(v===u){const{comp:r,err:s}=o[0];if(s!==void 0&&console.error(s),b(!1,r),c===!0){const x=o.find(({comp:w})=>typeof w.focus=="function"&&Q(w.$)===!1);x!==void 0&&x.comp.focus()}}return!1})}function l(){u++,e.forEach(t=>{typeof t.resetValidation=="function"&&t.resetValidation()})}function y(t){t!==void 0&&A(t);const c=u+1;n().then(v=>{c===u&&v===!0&&(a.onSubmit!==void 0?d("submit",t):t?.target!==void 0&&typeof t.target.submit=="function"&&t.target.submit())})}function S(t){t!==void 0&&A(t),d("reset"),R(()=>{l(),a.autofocus===!0&&a.noResetFocus!==!0&&h()})}function h(){V(()=>{if(i.value===null)return;(i.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||i.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||i.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(i.value.querySelectorAll("[tabindex]"),c=>c.tabIndex!==-1))?.focus({preventScroll:!0})})}D(j,{bindComponent(t){e.push(t)},unbindComponent(t){const c=e.indexOf(t);c!==-1&&e.splice(c,1)}});let U=!1;return C(()=>{U=!0}),E(()=>{U===!0&&a.autofocus===!0&&h()}),q(()=>{a.autofocus===!0&&h()}),Object.assign(g.proxy,{validate:n,resetValidation:l,submit:y,reset:S,focus:h,getValidationComponents:()=>e}),()=>I("form",{class:"q-form",ref:i,onSubmit:y,onReset:S},$(m.default))}}),K=k("Units",()=>{const a=F();async function m(e){return f.post("units",e).then(n=>n.data).catch(n=>{throw console.error("[UnitsStore] - An error occurred while createing via createUnit",n.message),n})}async function d(e){return f.get(`/units/${e}`).then(n=>n.data).catch(n=>{throw console.error("[UnitsStore] - An error occurred while fetching via fetchUnitsById",n.message),n})}async function g(){return f.get("units").then(e=>{a.value=e.data}).catch(e=>{throw console.error("[UnitsStore] - An error occurred while fetching via fetchUnits",e.message),e})}async function i(e,n){return f.put(`/units/${e}`,{data:n}).then(l=>l.data).catch(l=>{throw console.error("[UnitsStore] - An error occurred while fetching via updateUnit",l.message),l})}async function u(e){return f.delete(`units/${e}`).then(n=>n.data).catch(n=>{throw console.error("[UnitsStore] - An error occurred while deleting via deleteUnit",n.message),n})}return{createUnit:m,fetchUnitsById:d,fetchUnits:g,updateUnit:i,deleteUnit:u,units:a}});export{_ as Q,K as u};
