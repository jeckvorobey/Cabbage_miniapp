import{d as N,r as m,ag as F,ah as g,ai as s,f as e,ao as v,Q as i,an as l,F as L,aq as U,am as c,aj as f,az as y,ap as p,ak as Q,ab as E,aH as k,aF as _,aD as V,aG as P,Y as b,aE as j}from"./index-CcfvS8Eu.js";import{Q as z,b as A,a as w}from"./QItem-bG1dKP_L.js";import{Q as G}from"./QList-UD0K1hm9.js";import{C as q}from"./ClosePopup-BMFTL8MB.js";import{u as H}from"./use-quasar-DtARRiGq.js";import{a as x}from"./useUtils-BCRxd3pn.js";import{u as O}from"./categoriesStore-Dreu2Q7Y.js";const R={class:"text-h6"},ae=N({__name:"CategoriesPage",setup(T){const d=H(),r=O(),u=m(!1),h=m({name:"",parent_id:null,description:""}),o=m({id:null,name:"",parent_id:null,description:""});function C(n){n?.id?o.value=n:o.value=h.value,u.value=!u.value}function S(n){d.dialog({title:"Удаление категорию",message:"Вы уверенны что хотите удалить категорию?",cancel:!0,persistent:!0}).onOk(()=>{B(n)})}async function B(n){try{await r.deleteCategorie(n)}catch(a){console.error(a)}finally{await r.fetchCategories()}}async function I(){try{if(d.loading.show(),!o.value)return;await(o.value.id?r.updateCategorie:r.createCategories)(o.value)&&(await r.fetchCategories(),d.notify({message:"Категория успешно добавлена",color:"primary"}))}catch(n){console.error(n)}finally{d.loading.hide()}}return(n,a)=>{const $=F("q-item-action");return s(),g("div",null,[e(i,{onClick:a[0]||(a[0]=t=>C()),class:"full-width q-mb-sm",color:"secondary",label:"Добавление категории"}),a[5]||(a[5]=v("h6",{class:"text-center q-mt-md q-mb-md"},"Категории",-1)),e(k,{class:"my-card q-ma-sm",flat:"",bordered:""},{default:l(()=>[(s(!0),g(L,null,U(c(r).categories,(t,D)=>(s(),f(G,{key:D},{default:l(()=>[e(z,null,{default:l(()=>[e(A,null,{default:l(()=>[e(w,null,{default:l(()=>[y(p(t.name),1)]),_:2},1024),e(w,{caption:""},{default:l(()=>[y(p(t.description),1)]),_:2},1024)]),_:2},1024),e($,null,{default:l(()=>[c(x)?(s(),f(i,{key:0,flat:"",round:"",color:"red",icon:"delete",onClick:M=>S(t.id)},null,8,["onClick"])):Q("",!0),c(x)?(s(),f(i,{key:1,flat:"",round:"",color:"secondary",icon:"mode_edit",onClick:M=>C(t)},null,8,["onClick"])):Q("",!0)]),_:2},1024)]),_:2},1024),e(E)]),_:2},1024))),128))]),_:1}),e(j,{modelValue:u.value,"onUpdate:modelValue":a[4]||(a[4]=t=>u.value=t)},{default:l(()=>[e(k,{style:{"min-width":"90svw"}},{default:l(()=>[e(_,null,{default:l(()=>[v("div",R,p(o.value.id?"Редактировать категорию":"Добавить категорию"),1)]),_:1}),e(_,{class:"q-pt-none"},{default:l(()=>[e(V,{modelValue:o.value.name,"onUpdate:modelValue":a[1]||(a[1]=t=>o.value.name=t),class:"q-mb-xs",outlined:"",label:"Наиминование категории"},null,8,["modelValue"]),e(V,{class:"q-mt-sm",modelValue:o.value.description,"onUpdate:modelValue":a[2]||(a[2]=t=>o.value.description=t),filled:"",type:"textarea",rows:"2",label:"Описание"},null,8,["modelValue"])]),_:1}),e(P,{align:"right"},{default:l(()=>[b(e(i,{flat:"",label:"Отмена",color:"negative"},null,512),[[q]]),b(e(i,{flat:"",label:"Подтвердить",color:"primary",onClick:a[3]||(a[3]=t=>I())},null,512),[[q]])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}});export{ae as default};
