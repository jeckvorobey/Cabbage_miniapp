import{b as R,l as U,s as V,r as d,f as B,w as c,o as _,m as j,n as z,p as F,q as W,t as $,h as N,v as G,x as g,y,z as H,A as q,B as L,C as J,D as K}from"./index-C92qa7O6.js";const{passive:i}=U,Y=R({name:"QInfiniteScroll",props:{offset:{type:Number,default:500},debounce:{type:[String,Number],default:100},scrollTarget:V,initialIndex:{type:Number,default:0},disable:Boolean,reverse:Boolean},emits:["load"],setup(l,{slots:P,emit:D}){const s=d(!1),n=d(!0),f=d(null),h=d(null);let v=l.initialIndex,e,a;const M=B(()=>"q-infinite-scroll__loading"+(s.value===!0?"":" invisible"));function o(){if(l.disable===!0||s.value===!0||n.value===!1)return;const t=g(e),r=y(e),u=H(e);l.reverse===!1?Math.round(r+u+l.offset)>=Math.round(t)&&m():Math.round(r)<=l.offset&&m()}function m(){if(l.disable===!0||s.value===!0||n.value===!1)return;v++,s.value=!0;const t=g(e);D("load",v,r=>{n.value===!0&&(s.value=!1,q(()=>{if(l.reverse===!0){const u=g(e),w=y(e),O=u-t;L(e,w+O)}r===!0?b():f.value&&f.value.closest("body")&&a()}))})}function C(){v=0}function I(){n.value===!1&&(n.value=!0,e.addEventListener("scroll",a,i)),o()}function b(){n.value===!0&&(n.value=!1,s.value=!1,e.removeEventListener("scroll",a,i),a?.cancel?.())}function S(){if(e&&n.value===!0&&e.removeEventListener("scroll",a,i),e=J(f.value,l.scrollTarget),n.value===!0){if(e.addEventListener("scroll",a,i),l.reverse===!0){const t=g(e),r=H(e);L(e,t-r)}o()}}function Q(t){v=t}function A(t){t=parseInt(t,10);const r=a;a=t<=0?o:K(o,isNaN(t)===!0?100:t),e&&n.value===!0&&(r!==void 0&&e.removeEventListener("scroll",r,i),e.addEventListener("scroll",a,i))}function E(t){if(T.value===!0){if(h.value===null){t!==!0&&q(()=>{E(!0)});return}const r=`${s.value===!0?"un":""}pauseAnimations`;Array.from(h.value.getElementsByTagName("svg")).forEach(u=>{u[r]()})}}const T=B(()=>l.disable!==!0&&n.value===!0);c([s,T],()=>{E()}),c(()=>l.disable,t=>{t===!0?b():I()}),c(()=>l.reverse,()=>{s.value===!1&&n.value===!0&&o()}),c(()=>l.scrollTarget,S),c(()=>l.debounce,A);let x=!1;_(()=>{x!==!1&&e&&L(e,x)}),j(()=>{x=e?y(e):!1}),z(()=>{n.value===!0&&e.removeEventListener("scroll",a,i)}),F(()=>{A(l.debounce),S(),s.value===!1&&E()});const k=W();return Object.assign(k.proxy,{poll:()=>{a?.()},trigger:m,stop:b,reset:C,resume:I,setIndex:Q,updateScrollTarget:S}),()=>{const t=$(P.default,[]);return T.value===!0&&t[l.reverse===!1?"push":"unshift"](N("div",{ref:h,class:M.value},G(P.loading))),N("div",{class:"q-infinite-scroll",ref:f},t)}}});export{Y as Q};
