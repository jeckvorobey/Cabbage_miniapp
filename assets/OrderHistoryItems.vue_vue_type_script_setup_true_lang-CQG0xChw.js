import{Q as v,a as f,b as n}from"./QItem-DQyRjP3b.js";import{Q as b}from"./QList-BcFRRHg9.js";import{Q as S}from"./QBtnDropdown-D1a858nj.js";import{C as B}from"./ClosePopup-DinItDPI.js";import{u as A}from"./use-quasar-BDlt-IKv.js";import{u as M}from"./orderStore-B0RC784Z.js";import{d as w}from"./useUtils-CxT89PWc.js";import{X as T,Y as V,a3 as p,_ as u,a1 as a,$ as e,a4 as D,a5 as L,Z as _,ad as G,a7 as r,a8 as c,a6 as O,a9 as R}from"./index-_eQ6ifiF.js";var i=(o=>(o.CREATED="created",o.ASSEMBLING="assembling",o.DELIVERING="delivering",o.COMPLETED="completed",o.CANCELLED="cancelled",o))(i||{});const h=T({__name:"OrderHistoryItems",props:{orderData:{},adminMode:{type:Boolean}},setup(o){const d=A(),y=M(),C=[{label:"создан",value:i.CREATED},{label:"собирается",value:i.ASSEMBLING},{label:"в пути",value:i.DELIVERING},{label:"завершён",value:i.COMPLETED},{label:"отменён",value:i.CANCELLED}];function I(l,t){d.dialog({cancel:!0,message:"Вы уверенны что хотите изменить статус?",persistent:!0,title:"Смена статуса"}).onOk(()=>{N(l,t)})}async function N(l,t){try{d.loading.show(),await y.updateOrderStatus(l,t)&&d.notify({color:"primary",message:"Статус успешно изменен"})}catch(s){console.error(s)}finally{d.loading.hide()}}function g(l){return C.find(s=>s.value===l)?.label}return(l,t)=>{const s=V("q-item-action");return u(),p("div",null,[a(b,null,{default:e(()=>[(u(!0),p(D,null,L(l.orderData,(m,k)=>(u(),_(v,{key:k,class:"border-bot"},{default:e(()=>[a(f,null,{default:e(()=>[a(n,{caption:"",lines:"2"},{default:e(()=>[...t[0]||(t[0]=[r("Дата",-1)])]),_:1}),a(n,null,{default:e(()=>[r(c(O(w)(m.order_date)),1)]),_:2},1024)]),_:2},1024),a(f,null,{default:e(()=>[a(n,{caption:"",lines:"2"},{default:e(()=>[...t[1]||(t[1]=[r("Статус",-1)])]),_:1}),a(n,null,{default:e(()=>[r(c(g(m.status)),1)]),_:2},1024)]),_:2},1024),a(f,null,{default:e(()=>[a(n,{caption:"",lines:"2"},{default:e(()=>[...t[2]||(t[2]=[r("Общая сумма",-1)])]),_:1}),a(n,null,{default:e(()=>[r(c(m.total_amount),1)]),_:2},1024)]),_:2},1024),l.adminMode?(u(),_(s,{key:0},{default:e(()=>[a(S,{color:"green",dense:""},{default:e(()=>[(u(),p(D,null,L(C,(E,Q)=>a(b,{key:Q},{default:e(()=>[R((u(),_(v,{clickable:"",onClick:P=>I(m.id,E.value)},{default:e(()=>[a(f,null,{default:e(()=>[a(n,null,{default:e(()=>[r(c(E.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])),[[B]])]),_:2},1024)),64))]),_:2},1024)]),_:2},1024)):G("",!0)]),_:2},1024))),128))]),_:1})])}}});export{h as _};
