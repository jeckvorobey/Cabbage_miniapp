import{k as q,r as v,c,V as D,m as I,a1 as l,Y as n,$ as s,Z as r,_ as d,a2 as p,a3 as g,a4 as _,X as A,a0 as b,aa as V,a9 as $,an as B,a5 as x,a6 as y,C as R}from"./index-S2HywuQa.js";import{Q as N,a as Q,b as S}from"./QItem-me-TR8Qj.js";import{Q as L}from"./QImg-CozvKW49.js";import{Q as M}from"./QInfiniteScroll-Cbbkm_It.js";import{u as z,d as j}from"./use-quasar-w1OI9H8r.js";const E=q("Reviews",()=>{const h=v(),u=v({offset:0,limit:20,total:0,has_more:!1});async function a(e){return c.get("reviews",{params:e}).then(t=>t.data).catch(t=>{throw console.error("[ReviewsStore] - An error occurred while fetching via fetchReviews",t.message),t})}async function i(){return c.get("reviews/my").then(e=>e.data).catch(e=>{throw console.error("[ReviewsStore] - An error occurred while fetching via fetchMyReviews",e.message),e})}async function m(e){return c.post("addresses",e).then(t=>t.data).catch(t=>{throw console.error("[ReviewsStore] - An error occurred while createing via createReviews",t.message),t})}async function f(e){return c.patch(`/reviews/${e.id}`,e).then(t=>t.data).catch(t=>{throw console.error("[ReviewsStore] - An error occurred while creating via updateReviews",t.message),t})}async function o(e){return c.delete(`reviews/${e}`).then(t=>t.data).catch(t=>{throw console.error("[ReviewsStore] - An error occurred while deleting via deleteReview",t.message),t})}return{reviewsData:h,pagination:u,fetchReviews:a,fetchMyReviews:i,createReviews:m,updateReviews:f,deleteReview:o}}),F={class:"q-mx-sm"},P={class:"q-mt-sm text-green-7 text-caption flex items-center"},T={class:"q-mt-sm"},U={key:0},X={class:"flex justify-end"},K=D({__name:"ReviewsPage",setup(h){const u=z(),a=E(),i=v(!1);I(()=>{f()});const m=async(o,e)=>{if(!a.pagination.has_more){e(!0);return}await f(),a.pagination.offset+=a.pagination.limit,e()};async function f(){try{u.loading.show();const o={limit:a.pagination.limit,offset:a.pagination.offset},e=await a.fetchReviews(o);e&&(a.pagination.total=e.total,a.pagination.has_more=e.has_more,a.reviewsData?.length?a.reviewsData.push(e.items):a.reviewsData=e.items),e&&(a.reviewsData=e.items)}catch(o){console.error(o)}finally{u.loading.hide()}}return(o,e)=>(n(),l("div",F,[s(M,{offset:250,onLoad:m},{default:r(()=>[e[3]||(e[3]=d("h6",{class:"text-center"},"Отзывы",-1)),(n(!0),l(p,null,g(_(a).reviewsData,(t,k)=>(n(),A(b,{key:k,flat:"",bordered:""},{default:r(()=>[s(V,{class:"q-pb-xs"},{default:r(()=>[s(N,{class:"q-pa-none"},{default:r(()=>[s(Q,{avatar:""},{default:r(()=>[s(B,{color:"grey-3","text-color":"grey-6",icon:"person"})]),_:1}),s(Q,null,{default:r(()=>[s(S,{class:"text-weight-bold"},{default:r(()=>[...e[1]||(e[1]=[x("User",-1)])]),_:1}),s(S,{caption:"",class:"text-grey-7"},{default:r(()=>[x(y(_(j)(t.created_at)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),d("div",P,[s(R,{name:"check_circle",size:"16px",class:"q-mr-xs"}),e[2]||(e[2]=d("span",{class:"text-weight-medium"},"Отзыв",-1))]),d("div",T,y(t.text),1),i.value?(n(),l("div",U,[(n(!0),l(p,null,g(t.images,(w,C)=>(n(),l("div",{key:C},[s(L,{class:"cursor-pointer radius-8",src:w.file_path,height:"70px",width:"70px",fit:"cover"},null,8,["src"])]))),128))])):$("",!0),d("div",X,[s(R,{size:"30px",name:i.value?"expand_less":"expand_more",onClick:e[0]||(e[0]=w=>i.value=!i.value)},null,8,["name"])])]),_:2},1024)]),_:2},1024))),128))]),_:1})]))}});export{K as default};
