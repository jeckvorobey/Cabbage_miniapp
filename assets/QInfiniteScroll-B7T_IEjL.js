import{k as C,t as O,a0 as R,r as d,c as A,w as c,aT as W,aU as _,n as j,o as F,g as X,y as Y,h as B,l as $,aV as g,a2 as L,aW as H,q,aX as P,a1 as z,aY as G}from"./index-0kcI6X4Y.js";const{passive:s}=O,K=C({name:"QInfiniteScroll",props:{offset:{type:Number,default:500},debounce:{type:[String,Number],default:100},scrollTarget:R,initialIndex:{type:Number,default:0},disable:Boolean,reverse:Boolean},emits:["load"],setup(l,{slots:x,emit:M}){const i=d(!1),a=d(!0),f=d(null),h=d(null);let v=l.initialIndex,e,n;const k=A(()=>"q-infinite-scroll__loading"+(i.value===!0?"":" invisible"));function o(){if(l.disable===!0||i.value===!0||a.value===!1)return;const t=g(e),r=L(e),u=H(e);l.reverse===!1?Math.round(r+u+l.offset)>=Math.round(t)&&m():Math.round(r)<=l.offset&&m()}function m(){if(l.disable===!0||i.value===!0||a.value===!1)return;v++,i.value=!0;const t=g(e);M("load",v,r=>{a.value===!0&&(i.value=!1,q(()=>{if(l.reverse===!0){const u=g(e),V=L(e),w=u-t;P(e,V+w)}r===!0?b():f.value&&f.value.closest("body")&&n()}))})}function D(){v=0}function I(){a.value===!1&&(a.value=!0,e.addEventListener("scroll",n,s)),o()}function b(){a.value===!0&&(a.value=!1,i.value=!1,e.removeEventListener("scroll",n,s),n?.cancel?.())}function S(){if(e&&a.value===!0&&e.removeEventListener("scroll",n,s),e=z(f.value,l.scrollTarget),a.value===!0){if(e.addEventListener("scroll",n,s),l.reverse===!0){const t=g(e),r=H(e);P(e,t-r)}o()}}function Q(t){v=t}function N(t){t=parseInt(t,10);const r=n;n=t<=0?o:G(o,isNaN(t)===!0?100:t),e&&a.value===!0&&(r!==void 0&&e.removeEventListener("scroll",r,s),e.addEventListener("scroll",n,s))}function T(t){if(E.value===!0){if(h.value===null){t!==!0&&q(()=>{T(!0)});return}const r=`${i.value===!0?"un":""}pauseAnimations`;Array.from(h.value.getElementsByTagName("svg")).forEach(u=>{u[r]()})}}const E=A(()=>l.disable!==!0&&a.value===!0);c([i,E],()=>{T()}),c(()=>l.disable,t=>{t===!0?b():I()}),c(()=>l.reverse,()=>{i.value===!1&&a.value===!0&&o()}),c(()=>l.scrollTarget,S),c(()=>l.debounce,N);let y=!1;W(()=>{y!==!1&&e&&P(e,y)}),_(()=>{y=e?L(e):!1}),j(()=>{a.value===!0&&e.removeEventListener("scroll",n,s)}),F(()=>{N(l.debounce),S(),i.value===!1&&T()});const U=X();return Object.assign(U.proxy,{poll:()=>{n?.()},trigger:m,stop:b,reset:D,resume:I,setIndex:Q,updateScrollTarget:S}),()=>{const t=Y(x.default,[]);return E.value===!0&&t[l.reverse===!1?"push":"unshift"](B("div",{ref:h,class:k.value},$(x.loading))),B("div",{class:"q-infinite-scroll",ref:f},t)}}});export{K as Q};
