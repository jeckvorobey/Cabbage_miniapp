import{d as x,r as _,aj as g,ai as m,an as t,f as e,as as S,b0 as N,ao as h,av as Q,b1 as P,Y as V,Q as f,aW as F,u as L,c as R,o as j,ah as y,ak as U,am as b,F as E,aq as O,at as k,ap as C,ab as T}from"./index-C7LLdeFm.js";import{u as $,Q as W,b as v,a as w}from"./useUtils-BQeKkN_u.js";import{Q as Y}from"./QList-C-oh1Mby.js";import{u as B,Q as z}from"./unitsStore-DnQnSLpi.js";import{C as q}from"./ClosePopup-DbUkIGqN.js";import{_ as G}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{u as H}from"./usePermissionVisibility.hook-D8mONlPr.js";const J=x({__name:"AddUnitModal",setup(I){const c=$(),p=B(),o=_(!1),u=_({name:"",symbol:""});async function d(){try{await p.createUnit(u.value)&&c.notify({message:"Единица измерения успешно создана",color:"primary"})}catch(i){console.error(i)}}return(i,l)=>(m(),g(F,{ref:"dialogRef",modelValue:o.value,"onUpdate:modelValue":l[3]||(l[3]=r=>o.value=r),persistent:""},{default:t(()=>[e(S,{class:"add-product"},{default:t(()=>[e(z,{greedy:""},{default:t(()=>[e(N,null,{default:t(()=>[l[4]||(l[4]=h("div",{class:"text-h6 q-mb-md"},"Добавление единицы измерения",-1)),e(Q,{modelValue:u.value.name,"onUpdate:modelValue":l[0]||(l[0]=r=>u.value.name=r),outlined:"",class:"q-mb-xs",label:"Наименование (пример: кг, гр, шт)"},null,8,["modelValue"]),e(Q,{modelValue:u.value.symbol,"onUpdate:modelValue":l[1]||(l[1]=r=>u.value.symbol=r),outlined:"",class:"q-mb-xs",label:"Символ (пример: kg, gr, sh)"},null,8,["modelValue"])]),_:1}),e(P,{align:"right"},{default:t(()=>[V(e(f,{color:"red",label:"Отмена"},null,512),[[q]]),V(e(f,{color:"primary",label:"Сохранить",onClick:l[2]||(l[2]=r=>d())},null,512),[[q]])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),K=G(J,[["__scopeId","data-v-4551a0f1"]]),X={key:0},ne=x({__name:"UnitsPage",setup(I){const c=$(),p=L(),o=B(),{isManager:u}=H(R(()=>p.user?.role)),d=_(!1);j(()=>{i()});async function i(){try{await o.fetchUnits(),c.loading.show()}catch(s){console.error(s)}finally{c.loading.hide()}}function l(s){c.dialog({title:"Удаление единицы измерения",message:"Вы уверенны что хотите удалить единицу измерения?",cancel:!0,persistent:!0}).onOk(()=>{r(s)})}async function r(s){try{await o.deleteUnit(s)}catch(a){console.error(a)}finally{await i()}}async function M(s){try{const a=o.units?.find(n=>n.id===s);if(!a)return;await o.updateUnit(s,a)}catch(a){console.error(a)}finally{await i()}}return(s,a)=>(m(),y("div",null,[e(f,{onClick:a[0]||(a[0]=n=>d.value=!d.value),class:"full-width q-mb-sm",color:"secondary",label:"Добавление единицы измерения"}),b(o).units?(m(),y("div",X,[a[2]||(a[2]=h("h6",{class:"text-center q-mt-md q-mb-md"},"Единицы измерения",-1)),e(S,{class:"my-card q-ma-sm",flat:"",bordered:""},{default:t(()=>[(m(!0),y(E,null,O(b(o).units,(n,A)=>(m(),g(Y,{key:A},{default:t(()=>[e(W,null,{default:t(()=>[e(v,null,{default:t(()=>[e(w,null,{default:t(()=>[k(C(n.name),1)]),_:2},1024)]),_:2},1024),e(v,null,{default:t(()=>[e(w,null,{default:t(()=>[k(C(n.symbol),1)]),_:2},1024)]),_:2},1024),e(v,null,{default:t(()=>[b(u)?(m(),g(f,{key:0,flat:"",round:"",color:"red",icon:"delete",onClick:D=>l(n.id)},null,8,["onClick"])):U("",!0),e(f,{flat:"",round:"",color:"primary",icon:"mode_edit",onClick:D=>M(n.id)},null,8,["onClick"])]),_:2},1024)]),_:2},1024),e(T)]),_:2},1024))),128))]),_:1})])):U("",!0),e(K,{modelValue:d.value,"onUpdate:modelValue":a[1]||(a[1]=n=>d.value=n),label:"test"},null,8,["modelValue"])]))}});export{ne as default};
