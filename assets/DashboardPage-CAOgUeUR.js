import{k as ae,g as Z,a as ne,v as N,x as Ie,P as Te,c as F,h as m,l as Me,ah as ke,ai as He,aj as Ke,ak as We,r as k,J as qe,L as Be,D as Xe,w as Ye,n as Je,i as Ze,al as Ge,am as et,an as ye,ao as tt,a0 as we,Q as X,O as at,ap as ot,d as de,a6 as J,a5 as I,aa as Q,f as S,ab as O,a9 as se,M as lt,o as rt,a4 as le,ad as nt,F as st,ac as ee,af as be,a7 as ut,aq as Fe}from"./index-CjQoejyx.js";import{u as Ce,Q as ze,a as it}from"./orderStore-CZcTq4uO.js";import{Q as ue}from"./QCardSection-7Susf4BM.js";import{Q as dt,a as Ue,C as ct}from"./ClosePopup-Dl6CqCev.js";import{u as ft,a as pt,Q as Pe}from"./QCard-qCF9DJJi.js";import{Q as vt}from"./QInfiniteScroll-BvLgNQb4.js";import{u as Qe}from"./use-quasar-Du0Vn07S.js";import{Q as re}from"./QInput-e7IcEHXM.js";import{Q as De}from"./QSelect-DUr3UVWc.js";import{b as mt,h as Se,u as gt}from"./categoriesStore-BHVf4-7_.js";import{u as $e,Q as _t}from"./unitsStore-ahObVYx_.js";import{_ as Ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./use-timeout-DmzBBSUr.js";const ht=ae({name:"QPage",props:{padding:Boolean,styleFn:Function},setup(t,{slots:i}){const{proxy:{$q:n}}=Z(),o=ne(Ie,N);if(o===N)return console.error("QPage needs to be a deep child of QLayout"),N;if(ne(Te,N)===N)return console.error("QPage needs to be child of QPageContainer"),N;const d=F(()=>{const g=(o.header.space===!0?o.header.size:0)+(o.footer.space===!0?o.footer.size:0);if(typeof t.styleFn=="function"){const f=o.isContainer.value===!0?o.containerHeight.value:n.screen.height;return t.styleFn(g,f)}return{minHeight:o.isContainer.value===!0?o.containerHeight.value-g+"px":n.screen.height===0?g!==0?`calc(100vh - ${g}px)`:"100vh":n.screen.height-g+"px"}}),c=F(()=>`q-page${t.padding===!0?" q-layout-padding":""}`);return()=>m("main",{class:c.value,style:d.value},Me(i.default))}}),yt=ae({name:"QUploaderAddTrigger",setup(){const t=ne(ke,N);return t===N&&console.error("QUploaderAddTrigger needs to be child of QUploader"),t}}),bt={...He,min:{type:Number,default:0},max:{type:Number,default:100},color:String,centerColor:String,trackColor:String,fontSize:String,rounded:Boolean,thickness:{type:Number,default:.2,validator:t=>t>=0&&t<=1},angle:{type:Number,default:0},showValue:Boolean,reverse:Boolean,instantFeedback:Boolean},ie=50,Le=2*ie,Re=Le*Math.PI,Ft=Math.round(Re*1e3)/1e3,Dt=ae({name:"QCircularProgress",props:{...bt,value:{type:Number,default:0},animationSpeed:{type:[String,Number],default:600},indeterminate:Boolean},setup(t,{slots:i}){const{proxy:{$q:n}}=Z(),o=Ke(t),s=F(()=>{const a=(n.lang.rtl===!0?-1:1)*t.angle;return{transform:t.reverse!==(n.lang.rtl===!0)?`scale3d(-1, 1, 1) rotate3d(0, 0, 1, ${-90-a}deg)`:`rotate3d(0, 0, 1, ${a-90}deg)`}}),d=F(()=>t.instantFeedback!==!0&&t.indeterminate!==!0?{transition:`stroke-dashoffset ${t.animationSpeed}ms ease 0s, stroke ${t.animationSpeed}ms ease`}:""),c=F(()=>Le/(1-t.thickness/2)),g=F(()=>`${c.value/2} ${c.value/2} ${c.value} ${c.value}`),f=F(()=>mt(t.value,t.min,t.max)),w=F(()=>t.max-t.min),q=F(()=>t.thickness/2*c.value),U=F(()=>{const a=(t.max-f.value)/w.value,e=t.rounded===!0&&f.value<t.max&&a<.25?q.value/2*(1-a/.25):0;return Re*a+e});function u({thickness:a,offset:e,color:_,cls:C,rounded:h}){return m("circle",{class:"q-circular-progress__"+C+(_!==void 0?` text-${_}`:""),style:d.value,fill:"transparent",stroke:"currentColor","stroke-width":a,"stroke-dasharray":Ft,"stroke-dashoffset":e,"stroke-linecap":h,cx:c.value,cy:c.value,r:ie})}return()=>{const a=[];t.centerColor!==void 0&&t.centerColor!=="transparent"&&a.push(m("circle",{class:`q-circular-progress__center text-${t.centerColor}`,fill:"currentColor",r:ie-q.value/2,cx:c.value,cy:c.value})),t.trackColor!==void 0&&t.trackColor!=="transparent"&&a.push(u({cls:"track",thickness:q.value,offset:0,color:t.trackColor})),a.push(u({cls:"circle",thickness:q.value,offset:U.value,color:t.color,rounded:t.rounded===!0?"round":void 0}));const e=[m("svg",{class:"q-circular-progress__svg",style:s.value,viewBox:g.value,"aria-hidden":"true"},a)];return t.showValue===!0&&e.push(m("div",{class:"q-circular-progress__text absolute-full row flex-center content-center",style:{fontSize:t.fontSize}},i.default!==void 0?i.default():[m("div",f.value)])),m("div",{class:`q-circular-progress q-circular-progress--${t.indeterminate===!0?"in":""}determinate`,style:o.value,role:"progressbar","aria-valuemin":t.min,"aria-valuemax":t.max,"aria-valuenow":t.indeterminate===!0?void 0:f.value},We(i.internal,e))}}});function W(t,i,n,o){const s=[];return t.forEach(d=>{o(d)===!0?s.push(d):i.push({failedPropValidation:n,file:d})}),s}function te(t){t?.dataTransfer&&(t.dataTransfer.dropEffect="copy"),Be(t)}const St={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},xt=["rejected"];function kt({editable:t,dnd:i,getFileInput:n,addFilesToQueue:o}){const{props:s,emit:d,proxy:c}=Z(),g=k(null),f=F(()=>s.accept!==void 0?s.accept.split(",").map(r=>(r=r.trim(),r==="*"?"*/":(r.endsWith("/*")&&(r=r.slice(0,r.length-1)),r.toUpperCase()))):null),w=F(()=>parseInt(s.maxFiles,10)),q=F(()=>parseInt(s.maxTotalSize,10));function U(r){if(t.value)if(r!==Object(r)&&(r={target:null}),r.target?.matches('input[type="file"]')===!0)r.clientX===0&&r.clientY===0&&qe(r);else{const P=n();P!==r.target&&P?.click(r)}}function u(r){t.value&&r&&o(null,r)}function a(r,P,j,V){let v=Array.from(P||r.target.files);const D=[],$=()=>{D.length!==0&&d("rejected",D)};if(s.accept!==void 0&&f.value.indexOf("*/")===-1&&(v=W(v,D,"accept",y=>f.value.some(x=>y.type.toUpperCase().startsWith(x)||y.name.toUpperCase().endsWith(x))),v.length===0))return $();if(s.maxFileSize!==void 0){const y=parseInt(s.maxFileSize,10);if(v=W(v,D,"max-file-size",x=>x.size<=y),v.length===0)return $()}if(s.multiple!==!0&&v.length!==0&&(v=[v[0]]),v.forEach(y=>{y.__key=y.webkitRelativePath+y.lastModified+y.name+y.size}),V===!0){const y=j.map(x=>x.__key);v=W(v,D,"duplicate",x=>y.includes(x.__key)===!1)}if(v.length===0)return $();if(s.maxTotalSize!==void 0){let y=V===!0?j.reduce((x,L)=>x+L.size,0):0;if(v=W(v,D,"max-total-size",x=>(y+=x.size,y<=q.value)),v.length===0)return $()}if(typeof s.filter=="function"){const y=s.filter(v);v=W(v,D,"filter",x=>y.includes(x))}if(s.maxFiles!==void 0){let y=V===!0?j.length:0;if(v=W(v,D,"max-files",()=>(y++,y<=w.value)),v.length===0)return $()}if($(),v.length!==0)return v}function e(r){te(r),i.value!==!0&&(i.value=!0)}function _(r){Be(r),(r.relatedTarget!==null||Xe.is.safari!==!0?r.relatedTarget!==g.value:document.elementsFromPoint(r.clientX,r.clientY).includes(g.value)===!1)===!0&&(i.value=!1)}function C(r){te(r);const P=r.dataTransfer.files;P.length!==0&&o(null,P),i.value=!1}function h(r){if(i.value===!0)return m("div",{ref:g,class:`q-${r}__dnd absolute-full`,onDragenter:te,onDragover:te,onDragleave:_,onDrop:C})}return Object.assign(c,{pickFiles:U,addFiles:u}),{pickFiles:U,addFiles:u,onDragover:e,onDragleave:_,processFiles:a,getDndNode:h,maxFilesNumber:w,maxTotalSizeNumber:q}}function xe(t){return(t*100).toFixed(2)+"%"}const qt={...ft,...St,label:String,color:String,textColor:String,square:Boolean,flat:Boolean,bordered:Boolean,noThumbnails:Boolean,thumbnailFit:{type:String,default:"cover"},autoUpload:Boolean,hideUploadBtn:Boolean,disable:Boolean,readonly:Boolean},Ae=[...xt,"start","finish","added","removed"];function Bt(t,i){const n=Z(),{props:o,slots:s,emit:d,proxy:c}=n,{$q:g}=c,f=pt(o,g);function w(l,b,B){if(l.__status=b,b==="idle"){l.__uploaded=0,l.__progress=0,l.__sizeLabel=Se(l.size),l.__progressLabel="0.00%";return}if(b==="failed"){c.$forceUpdate();return}l.__uploaded=b==="uploaded"?l.size:B,l.__progress=b==="uploaded"?1:Math.min(.9999,l.__uploaded/l.size),l.__progressLabel=xe(l.__progress),c.$forceUpdate()}const q=F(()=>o.disable!==!0&&o.readonly!==!0),U=k(!1),u=k(null),a=k(null),e={files:k([]),queuedFiles:k([]),uploadedFiles:k([]),uploadedSize:k(0),updateFileStatus:w,isAlive:()=>tt(n)===!1},{pickFiles:_,addFiles:C,onDragover:h,onDragleave:r,processFiles:P,getDndNode:j,maxFilesNumber:V,maxTotalSizeNumber:v}=kt({editable:q,dnd:U,getFileInput:ve,addFilesToQueue:me});Object.assign(e,t({props:o,slots:s,emit:d,helpers:e,exposeApi:l=>{Object.assign(e,l)}})),e.isBusy===void 0&&(e.isBusy=k(!1));const D=k(0),$=F(()=>D.value===0?0:e.uploadedSize.value/D.value),y=F(()=>xe($.value)),x=F(()=>Se(D.value)),L=F(()=>q.value===!0&&e.isUploading.value!==!0&&(o.multiple===!0||e.queuedFiles.value.length===0)&&(o.maxFiles===void 0||e.files.value.length<V.value)&&(o.maxTotalSize===void 0||D.value<v.value)),p=F(()=>q.value===!0&&e.isBusy.value!==!0&&e.isUploading.value!==!0&&e.queuedFiles.value.length!==0);at(ke,_e);const T=F(()=>"q-uploader column no-wrap"+(f.value===!0?" q-uploader--dark q-dark":"")+(o.bordered===!0?" q-uploader--bordered":"")+(o.square===!0?" q-uploader--square no-border-radius":"")+(o.flat===!0?" q-uploader--flat no-shadow":"")+(o.disable===!0?" disabled q-uploader--disable":"")+(U.value===!0?" q-uploader--dnd":"")),M=F(()=>"q-uploader__header"+(o.color!==void 0?` bg-${o.color}`:"")+(o.textColor!==void 0?` text-${o.textColor}`:""));Ye(e.isUploading,(l,b)=>{b===!1&&l===!0?d("start"):b===!0&&l===!1&&d("finish")});function H(){o.disable===!1&&(e.abort(),e.uploadedSize.value=0,D.value=0,pe(),e.files.value=[],e.queuedFiles.value=[],e.uploadedFiles.value=[])}function E(){o.disable===!1&&fe(["uploaded"],()=>{e.uploadedFiles.value=[]})}function G(){fe(["idle","failed"],({size:l})=>{D.value-=l,e.queuedFiles.value=[]})}function fe(l,b){if(o.disable===!0)return;const B={files:[],size:0},R=e.files.value.filter(z=>l.indexOf(z.__status)===-1?!0:(B.size+=z.size,B.files.push(z),z.__img!==void 0&&window.URL.revokeObjectURL(z.__img.src),!1));B.files.length!==0&&(e.files.value=R,b(B),d("removed",B.files))}function oe(l){o.disable||(l.__status==="uploaded"?e.uploadedFiles.value=e.uploadedFiles.value.filter(b=>b.__key!==l.__key):l.__status==="uploading"?l.__abort():D.value-=l.size,e.files.value=e.files.value.filter(b=>b.__key!==l.__key?!0:(b.__img!==void 0&&window.URL.revokeObjectURL(b.__img.src),!1)),e.queuedFiles.value=e.queuedFiles.value.filter(b=>b.__key!==l.__key),d("removed",[l]))}function pe(){e.files.value.forEach(l=>{l.__img!==void 0&&window.URL.revokeObjectURL(l.__img.src)})}function ve(){return a.value||u.value.getElementsByClassName("q-uploader__input")[0]}function me(l,b){const B=P(l,b,e.files.value,!0),R=ve();R!=null&&(R.value=""),B!==void 0&&(B.forEach(z=>{if(e.updateFileStatus(z,"idle"),D.value+=z.size,o.noThumbnails!==!0&&z.type.toUpperCase().startsWith("IMAGE")){const he=new Image;he.src=window.URL.createObjectURL(z),z.__img=he}}),e.files.value=e.files.value.concat(B),e.queuedFiles.value=e.queuedFiles.value.concat(B),d("added",B),o.autoUpload===!0&&e.upload())}function ge(){p.value===!0&&e.upload()}function Y(l,b,B){if(l===!0){const R={type:"a",key:b,icon:g.iconSet.uploader[b],flat:!0,dense:!0};let z;return b==="add"?(R.onClick=_,z=_e):R.onClick=B,m(X,R,z)}}function _e(){return m("input",{ref:a,class:"q-uploader__input overflow-hidden absolute-full",tabindex:-1,type:"file",title:"",accept:o.accept,multiple:o.multiple===!0?"multiple":void 0,capture:o.capture,onMousedown:qe,onClick:_,onChange:me})}function Ne(){return s.header!==void 0?s.header(K):[m("div",{class:"q-uploader__header-content column"},[m("div",{class:"flex flex-center no-wrap q-gutter-xs"},[Y(e.queuedFiles.value.length!==0,"removeQueue",G),Y(e.uploadedFiles.value.length!==0,"removeUploaded",E),e.isUploading.value===!0?m(ye,{class:"q-uploader__spinner"}):null,m("div",{class:"col column justify-center"},[o.label!==void 0?m("div",{class:"q-uploader__title"},[o.label]):null,m("div",{class:"q-uploader__subtitle"},[x.value+" / "+y.value])]),Y(L.value,"add"),Y(o.hideUploadBtn===!1&&p.value===!0,"upload",e.upload),Y(e.isUploading.value,"clear",e.abort)])])]}function Oe(){return s.list!==void 0?s.list(K):e.files.value.map(l=>m("div",{key:l.__key,class:"q-uploader__file relative-position"+(o.noThumbnails!==!0&&l.__img!==void 0?" q-uploader__file--img":"")+(l.__status==="failed"?" q-uploader__file--failed":l.__status==="uploaded"?" q-uploader__file--uploaded":""),style:o.noThumbnails!==!0&&l.__img!==void 0?{backgroundImage:'url("'+l.__img.src+'")',backgroundSize:o.thumbnailFit}:null},[m("div",{class:"q-uploader__file-header row flex-center no-wrap"},[l.__status==="failed"?m(we,{class:"q-uploader__file-status",name:g.iconSet.type.negative,color:"negative"}):null,m("div",{class:"q-uploader__file-header-content col"},[m("div",{class:"q-uploader__title"},[l.name]),m("div",{class:"q-uploader__subtitle row items-center no-wrap"},[l.__sizeLabel+" / "+l.__progressLabel])]),l.__status==="uploading"?m(Dt,{value:l.__progress,min:0,max:1,indeterminate:l.__progress===0}):m(X,{round:!0,dense:!0,flat:!0,icon:g.iconSet.uploader[l.__status==="uploaded"?"done":"clear"],onClick:()=>{oe(l)}})])]))}Je(()=>{e.isUploading.value===!0&&e.abort(),e.files.value.length!==0&&pe()});const K={};for(const l in e)Ze(e[l])===!0?Ge(K,l,()=>e[l].value):K[l]=e[l];return Object.assign(K,{upload:ge,reset:H,removeUploadedFiles:E,removeQueuedFiles:G,removeFile:oe,pickFiles:_,addFiles:C}),et(K,{canAddFiles:()=>L.value,canUpload:()=>p.value,uploadSizeLabel:()=>x.value,uploadProgressLabel:()=>y.value}),i({...e,upload:ge,reset:H,removeUploadedFiles:E,removeQueuedFiles:G,removeFile:oe,pickFiles:_,addFiles:C,canAddFiles:L,canUpload:p,uploadSizeLabel:x,uploadProgressLabel:y}),()=>{const l=[m("div",{class:M.value},Ne()),m("div",{class:"q-uploader__list scroll"},Oe()),j("uploader")];e.isBusy.value===!0&&l.push(m("div",{class:"q-uploader__overlay absolute-full flex flex-center"},[m(ye)]));const b={ref:u,class:T.value};return L.value===!0&&Object.assign(b,{onDragover:h,onDragleave:r}),m("div",b,l)}}const wt=()=>!0;function je(t){const i={};return t.forEach(n=>{i[n]=wt}),i}const Ct=je(Ae),zt=({name:t,props:i,emits:n,injectPlugin:o})=>ae({name:t,props:{...qt,...i},emits:ot(n)===!0?{...Ct,...n}:[...Ae,...n],setup(s,{expose:d}){return Bt(o,d)}});function A(t){return typeof t=="function"?t:()=>t}const Ut="QUploader",Pt={url:[Function,String],method:{type:[Function,String],default:"POST"},fieldName:{type:[Function,String],default:()=>t=>t.name},headers:[Function,Array],formFields:[Function,Array],withCredentials:[Function,Boolean],sendRaw:[Function,Boolean],batch:[Function,Boolean],factory:Function},Qt=["factoryFailed","uploaded","failed","uploading"];function $t({props:t,emit:i,helpers:n}){const o=k([]),s=k([]),d=k(0),c=F(()=>({url:A(t.url),method:A(t.method),headers:A(t.headers),formFields:A(t.formFields),fieldName:A(t.fieldName),withCredentials:A(t.withCredentials),sendRaw:A(t.sendRaw),batch:A(t.batch)})),g=F(()=>d.value>0),f=F(()=>s.value.length!==0);let w;function q(){o.value.forEach(e=>{e.abort()}),s.value.length!==0&&(w=!0)}function U(){const e=n.queuedFiles.value.slice(0);n.queuedFiles.value=[],c.value.batch(e)?u(e):e.forEach(_=>{u([_])})}function u(e){if(d.value++,typeof t.factory!="function"){a(e,{});return}const _=t.factory(e);if(!_)i("factoryFailed",new Error("QUploader: factory() does not return properly"),e),d.value--;else if(typeof _.catch=="function"&&typeof _.then=="function"){s.value.push(_);const C=h=>{n.isAlive()===!0&&(s.value=s.value.filter(r=>r!==_),s.value.length===0&&(w=!1),n.queuedFiles.value=n.queuedFiles.value.concat(e),e.forEach(r=>{n.updateFileStatus(r,"failed")}),i("factoryFailed",h,e),d.value--)};_.then(h=>{w===!0?C(new Error("Aborted")):n.isAlive()===!0&&(s.value=s.value.filter(r=>r!==_),a(e,h))}).catch(C)}else a(e,_||{})}function a(e,_){const C=new FormData,h=new XMLHttpRequest,r=(p,T)=>_[p]!==void 0?A(_[p])(T):c.value[p](T),P=r("url",e);if(!P){console.error("q-uploader: invalid or no URL specified"),d.value--;return}const j=r("formFields",e);j!==void 0&&j.forEach(p=>{C.append(p.name,p.value)});let V=0,v=0,D=0,$=0,y;h.upload.addEventListener("progress",p=>{if(y===!0)return;const T=Math.min($,p.loaded);n.uploadedSize.value+=T-D,D=T;let M=D-v;for(let H=V;M>0&&H<e.length;H++){const E=e[H];if(M>E.size)M-=E.size,V++,v+=E.size,n.updateFileStatus(E,"uploading",E.size);else{n.updateFileStatus(E,"uploading",M);return}}},!1),h.onreadystatechange=()=>{h.readyState<4||(h.status&&h.status<400?(n.uploadedFiles.value=n.uploadedFiles.value.concat(e),e.forEach(p=>{n.updateFileStatus(p,"uploaded")}),i("uploaded",{files:e,xhr:h})):(y=!0,n.uploadedSize.value-=D,n.queuedFiles.value=n.queuedFiles.value.concat(e),e.forEach(p=>{n.updateFileStatus(p,"failed")}),i("failed",{files:e,xhr:h})),d.value--,o.value=o.value.filter(p=>p!==h))},h.open(r("method",e),P),r("withCredentials",e)===!0&&(h.withCredentials=!0);const x=r("headers",e);x!==void 0&&x.forEach(p=>{h.setRequestHeader(p.name,p.value)});const L=r("sendRaw",e);e.forEach(p=>{n.updateFileStatus(p,"uploading",0),L!==!0&&C.append(r("fieldName",p),p,p.name),p.xhr=h,p.__abort=()=>{h.abort()},$+=p.size}),i("uploading",{files:e,xhr:h}),o.value.push(h),L===!0?h.send(new Blob(e)):h.send(C)}return{isUploading:g,isBusy:f,abort:q,upload:U}}const Et={name:Ut,props:Pt,emits:Qt,injectPlugin:$t},Lt=zt(Et);function ce(){const{emit:t,proxy:i}=Z(),n=k(null);function o(){n.value.show()}function s(){n.value.hide()}function d(g){t("ok",g),s()}function c(){t("hide")}return Object.assign(i,{show:o,hide:s}),{dialogRef:n,onDialogHide:c,onDialogOK:d,onDialogCancel:s}}const Ve=["ok","hide"];ce.emits=Ve;ce.emitsObject=je(Ve);const Rt={class:"text-center upload-title"},At=de({__name:"AddProductModal",setup(t){const i=Qe(),n=Ce(),o=gt(),{dialogRef:s}=ce(),d=$e(),c=k(!1),g=k(),f=k({id:null,name:"",category_id:"",unit_id:"",qty:null,description:""});async function w(){try{const u=await n.createProduct(f.value);u&&(f.value.id=u.id,i.notify({message:"Товар успешно создан, теперь вам необходимо добавить картинку",color:"primary"}))}catch(u){console.error(u)}}function q(u){const a=new FileReader;a.readAsDataURL(u[0]),a.onload=()=>{a?.result&&(g.value=String(a.result))},U(u[0])}async function U(u){const a=new FormData;a.append("file",u);try{await n.uploadFile(f.value.id,a)&&(i.notify({message:"Картинка успешно добавлена",color:"primary"}),s.value?.hide())}catch(e){console.error(e)}}return(u,a)=>(I(),J(dt,{ref_key:"dialogRef",ref:s,modelValue:c.value,"onUpdate:modelValue":a[6]||(a[6]=e=>c.value=e),persistent:""},{default:Q(()=>[S(Pe,{class:"add-product"},{default:Q(()=>[S(_t,{greedy:""},{default:Q(()=>[S(ue,null,{default:Q(()=>[a[9]||(a[9]=O("div",{class:"text-h6 q-mb-md"},"Добавление товара",-1)),S(re,{modelValue:f.value.name,"onUpdate:modelValue":a[0]||(a[0]=e=>f.value.name=e),label:"Наименование товара","stack-label":""},null,8,["modelValue"]),S(re,{modelValue:f.value.qty,"onUpdate:modelValue":a[1]||(a[1]=e=>f.value.qty=e),label:"Количество","stack-label":""},null,8,["modelValue"]),S(De,{modelValue:f.value.category_id,"onUpdate:modelValue":a[2]||(a[2]=e=>f.value.category_id=e),options:se(o).categories,label:"Тип тары","emit-value":"","map-options":"","option-label":"name","option-value":"id"},null,8,["modelValue","options"]),S(De,{modelValue:f.value.unit_id,"onUpdate:modelValue":a[3]||(a[3]=e=>f.value.unit_id=e),options:se(d).units,label:"Вес","emit-value":"","map-options":"","option-label":"name","option-value":"id"},null,8,["modelValue","options"]),S(re,{class:"q-mt-sm",modelValue:f.value.description,"onUpdate:modelValue":a[4]||(a[4]=e=>f.value.description=e),filled:"",type:"textarea",rows:"2",label:"Описание"},null,8,["modelValue"]),!g.value&&f.value.id?(I(),J(Lt,{key:0,class:"q-mt-sm",ref:"uploaderRef",color:"primary",flat:"",onAdded:q},{header:Q(()=>[...a[7]||(a[7]=[])]),list:Q(()=>[S(yt),O("div",Rt,[S(we,{class:"q-mr-sm",name:"note_add",size:"24px"}),a[8]||(a[8]=O("span",null,"Загрузить картинку",-1))])]),_:1},512)):(I(),J(ze,{key:1,class:"q-mt-sm",src:g.value},null,8,["src"]))]),_:1}),S(Ue,{align:"right"},{default:Q(()=>[lt(S(X,{color:"red",label:"Отмена"},null,512),[[ct]]),S(X,{color:"primary",label:"Подтвердить",onClick:a[5]||(a[5]=e=>w())})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),jt=Ee(At,[["__scopeId","data-v-d34a09c5"]]),Vt={class:"product-card row q-col-gutter-xs"},Nt={class:"text-center card-title"},Ot={class:"text-center"},It={class:"text-bold"},Tt={key:0,class:"text-grey old-price"},Mt=de({__name:"ProductList",setup(t){const i=Qe(),n=$e(),o=Ce(),s=it(),d=k(!1),c=k(!1),g=k({offset:0,limit:20,total:0});rt(async()=>{try{await n.fetchUnits(),i.loading.show()}catch(u){console.error(u)}finally{i.loading.hide()}});async function f(){try{i.loading.show();const u=await o.fetchProducts(g.value);u&&(o?.products?.length?o.products.push(u.items):(o.products=u.items,g.value.total=u.total))}catch(u){console.error(u)}finally{i.loading.hide()}}function w(u){try{if(i.loading.show(),s.basketData?.length){const a=s.basketData.find(e=>e.id===u.id);a?q(a,u):s.basketData.push(structuredClone(Fe(u)))}else s.basketData.push(structuredClone(Fe(u)))}catch(a){console.error(a)}finally{i.notify({message:`Товар ${u.name} добавлен в корзину`,color:"primary"}),i.loading.hide()}}function q(u,a){u.price&&(u.price+=a.price),u.weight&&(u.weight+=a.weight),u.oldPrice&&(u.oldPrice+=a.oldPrice)}async function U(u,a){if(d.value){a(!0);return}try{const e=o.products?.length??0;if(await f(),(o.products?.length??0)===e){d.value=!0,a(!0);return}g.value.offset++,a()}catch(e){console.error("[ProductList] onLoad error",e),a(!0)}}return(u,a)=>(I(),J(vt,{onLoad:U,offset:250},{default:Q(()=>[S(X,{onClick:a[0]||(a[0]=e=>c.value=!c.value),class:"full-width q-mb-sm",color:"secondary",label:"Добавление товара"}),O("div",Vt,[(I(!0),le(st,null,nt(se(o).products,(e,_)=>(I(),le("div",{class:"col-6",key:_},[S(Pe,{class:"my-card radius-12 full-height",style:{"border-radius":"20px"},flat:"",bordered:""},{default:Q(()=>[S(ue,{class:"q-pa-sm full-height"},{default:Q(()=>[O("div",null,[S(ze,{class:"cursor-pointer",src:"https://media.istockphoto.com/id/1141529240/ru/%D0%B2%D0%B5%D0%BA%D1%82%D0%BE%D1%80%D0%BD%D0%B0%D1%8F/%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D0%B5-%D1%8F%D0%B1%D0%BB%D0%BE%D0%BA%D0%BE-%D0%B2-%D0%BF%D0%BB%D0%BE%D1%81%D0%BA%D0%BE%D0%BC-%D1%81%D1%82%D0%B8%D0%BB%D0%B5-%D0%B8%D0%BB%D0%BB%D1%8E%D1%81%D1%82%D1%80%D0%B0%D1%86%D0%B8%D1%8F-%D0%B2%D0%B5%D0%BA%D1%82%D0%BE%D1%80%D0%B0.jpg?s=612x612&w=0&k=20&c=B-KXrA7VTm8E6t4jk9qcuFz8bDFzTJwiIGaYGYUcsZI="})]),S(ue,{class:"q-pa-sm"},{default:Q(()=>[O("div",Nt,ee(e.name),1),O("div",Ot,[O("span",It,ee(e.price),1),a[2]||(a[2]=be(" ₽ ",-1)),e?.oldPrice?(I(),le("span",Tt,ee(e.old_price)+" ₽",1)):ut("",!0),be(" / "+ee(e.unit_symbol),1)])]),_:2},1024),S(Ue,{class:"justify-center"},{default:Q(()=>[S(X,{dense:"","no-caps":"",class:"full-width",color:"secondary",icon:"add_shopping_cart",label:"В корзину",onClick:C=>w(e)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]))),128))]),S(jt,{modelValue:c.value,"onUpdate:modelValue":a[1]||(a[1]=e=>c.value=e),label:"test"},null,8,["modelValue"])]),_:1}))}}),Ht=Ee(Mt,[["__scopeId","data-v-49e810dd"]]),na=de({__name:"DashboardPage",setup(t){return(i,n)=>(I(),J(ht,{class:"q-mx-xs"},{default:Q(()=>[S(Ht,{class:"q-mb-lg"})]),_:1}))}});export{na as default};
