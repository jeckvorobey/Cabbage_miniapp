import{Q as Z}from"./QImg-BkNMs5PC.js";import{aM as z,r as m,aN as v,d as S,o as x,af as D,ae as _,aC as E,aj as u,f as a,aF as C,aD as U,ak as d,ai as h,aB as w,aO as M,aE as N,U as F,av as V,c as b,aA as k,a3 as P,ad as R,ag as T,al as K,a9 as y}from"./index-B_nJ1CnL.js";import{Q as L}from"./QBtnToggle-ClkVhSRJ.js";import{Q as q}from"./QSelect-BiMD_I6Z.js";import{u as B}from"./use-quasar-C4E25BP3.js";import{Q as O}from"./QForm-BYfiKklj.js";import{C as G}from"./ClosePopup-BIqazoOM.js";import{r as Q,g as H}from"./useUtils-B0I_KiU2.js";import"./QBtnGroup-DjJguGDz.js";import"./QItem-Do-lWtoB.js";import"./QMenu--I_3TB-x.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";const I=z("Addresses",()=>{const A=m(),c=m();async function r(){return v.get("addresses").then(s=>s.data).catch(s=>{throw console.error("[AddressesStore] - An error occurred while fetching via fetchAddresses",s.message),s})}async function f(s){return v.post("addresses",s).then(e=>e.data).catch(e=>{throw console.error("[AddressesStore] - An error occurred while createing via createAddress",e.message),e})}async function p(s){return v.patch(`/addresses/${s.id}`,s).then(e=>e.data).catch(e=>{throw console.error("[AddressesStore] - An error occurred while creating via updateAddress",e.message),e})}async function t(s){return v.delete(`addresses/${s}`).then(e=>e.data).catch(e=>{throw console.error("[AddressesStore] - An error occurred while deleting via deleteAddress",e.message),e})}async function n(){return v.get("delivery-zones").then(s=>s.data).catch(s=>{throw console.error("[AddressesStore] - An error occurred while fetching via fetchAddresses",s.message),s})}return{addresses:A,deliveryZones:c,fetchAddresses:r,createAddress:f,updateAddress:p,deleteAddress:t,fetchDeliveryZones:n}}),J=S({__name:"AddAddressModal",setup(A){const c=B(),r=I(),f=m(!0),p=m(),t=m({area_id:null,address_line:"",comment:"",is_default:!1});x(async()=>{try{c.loading.show();const s=await r.fetchDeliveryZones();s&&(r.deliveryZones=s)}catch(s){console.error(s)}finally{c.loading.hide()}});async function n(){try{await r.createAddress(t.value)}catch(s){console.error(s)}finally{p.value.hide()}}return(s,e)=>(_(),D(E,{ref_key:"dialogRef",ref:p,modelValue:f.value,"onUpdate:modelValue":e[5]||(e[5]=o=>f.value=o),persistent:""},{default:u(()=>[a(C,{class:""},{default:u(()=>[a(O,{greedy:"",onSubmit:e[4]||(e[4]=o=>n())},{default:u(()=>[a(U,null,{default:u(()=>[e[6]||(e[6]=d("div",{class:"text-h6"},"Создание нового адреса доставки",-1)),a(q,{modelValue:t.value.area_id,"onUpdate:modelValue":e[0]||(e[0]=o=>t.value.area_id=o),options:h(r).deliveryZones,class:"q-mb-xs",outlined:"",label:"Зона доставки *","emit-value":"","map-options":"","option-label":"title","option-value":"id",rules:[h(Q)]},null,8,["modelValue","options","rules"]),a(w,{class:"q-mb-sm",outlined:"",modelValue:t.value.address_line,"onUpdate:modelValue":e[1]||(e[1]=o=>t.value.address_line=o),label:"Адрес *",rules:[h(Q)]},null,8,["modelValue","rules"]),a(w,{label:"Комментарий",modelValue:t.value.comment,"onUpdate:modelValue":e[2]||(e[2]=o=>t.value.comment=o),outlined:"",type:"textarea",rows:"3"},null,8,["modelValue"]),a(M,{modelValue:t.value.is_default,"onUpdate:modelValue":e[3]||(e[3]=o=>t.value.is_default=o),label:"Активный аддрес"},null,8,["modelValue"])]),_:1}),a(N,{align:"right"},{default:u(()=>[F(a(V,{color:"red",flat:"",label:"Отмена"},null,512),[[G]]),a(V,{color:"primary",flat:"",label:"Сохранить",type:"submit"})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),W={class:"q-pa-sm"},X={class:"justify-center row q-mb-md"},Y={class:"text-h5 justify-between q-mb-sm row"},ee={class:"items-center"},se={class:"items-center"},ae={class:"row items-center q-mb-sm"},ve=S({__name:"UserPage",setup(A){const c=B(),r=I(),f=b(()=>k.isActive),p=P({dark:"dark",light:"light"}),t=b(()=>f.value?p.dark:p.light),n=m(!1),s=m("dark"),e=m({full_name:"",mail:"",phone:"",addres:""}),o={id:4,full_name:"Denis Ivanov",phone:null,subscribe_news:!0,role:1,is_user:!1,language_code:"ru",is_premium:!1,main_image_url:"https://api.telegram.org/file/bot7772150741:AAFpK9oECUvBzrE8Kdh-fc1Io18ucALDvgI/photos/file_11.jpg",is_bot:!1};x(()=>{j()});const $=()=>{k.toggle(),window.localStorage.setItem("theme",t.value)};async function j(){try{c.loading.show();const g=await r.fetchAddresses();g&&(r.addresses=g.items)}catch(g){console.error(g)}finally{c.loading.hide()}}return(g,l)=>(_(),R("div",null,[l[6]||(l[6]=d("h6",{class:"text-center q-mb-md"},"Личный кабинет",-1)),d("div",W,[a(C,{class:"my-card full-height",flat:"",bordered:""},{default:u(()=>[a(U,null,{default:u(()=>[d("div",X,[a(Z,{class:"radius-100",height:"120px",width:"120px",src:h(H)("/card-shop.jpg")},null,8,["src"])]),d("div",Y,[d("div",null,K(o.full_name),1),d("div",null,[a(L,{modelValue:s.value,"onUpdate:modelValue":l[0]||(l[0]=i=>s.value=i),size:"sm","no-caps":"",unelevated:"",dense:"","toggle-color":"grey-9",color:"white","text-color":"grey-9",options:[{value:"dark",slot:"dark",title:"Dark mode"},{value:"light",slot:"light",title:"Light mode"}],onClick:l[1]||(l[1]=i=>$())},{dark:u(()=>[d("div",ee,[a(y,{name:"nightlight"})])]),light:u(()=>[d("div",se,[a(y,{name:"light_mode"})])]),_:1},8,["modelValue"])])]),a(w,{class:"q-mb-sm",outlined:"",modelValue:e.value.phone,"onUpdate:modelValue":l[2]||(l[2]=i=>e.value.phone=i),label:"Телефон",mask:"+# (###) ###-##-##",type:"tel"},null,8,["modelValue"]),d("div",ae,[a(q,{modelValue:e.value.addres,"onUpdate:modelValue":l[3]||(l[3]=i=>e.value.addres=i),options:h(r).addresses,class:"col-10",outlined:"",label:"Адрес","emit-value":"","map-options":"","option-label":"address_line","option-value":"id"},null,8,["modelValue","options"]),a(y,{onClick:l[4]||(l[4]=i=>n.value=!n.value),name:"add",size:"34px",color:"green",class:"col-2"})])]),_:1})]),_:1})]),n.value?(_(),D(J,{key:0,modelValue:n.value,"onUpdate:modelValue":l[5]||(l[5]=i=>n.value=i)},null,8,["modelValue"])):T("",!0)]))}});export{ve as default};
