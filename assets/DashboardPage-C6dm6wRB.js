import{k as te,g as Z,a as ce,u as j,v as Ge,O as et,c as D,h,l as Pe,t as tt,P as at,r as x,w as Y,ag as lt,ah as ot,n as Ee,o as Le,x as rt,ai as le,S as se,aj as xe,q as qe,ak as ue,R as nt,al as st,am as Qe,an as ut,ao as it,ap as dt,I as $e,K as Re,C as ct,i as ft,aq as vt,ar as mt,as as ke,at as pt,$ as Ae,Q as J,N as gt,au as ht,d as pe,a5 as ee,a4 as V,a9 as L,f as B,aa as I,a8 as fe,L as _t,a3 as ie,ac as bt,F as yt,ab as oe,ae as Be,a6 as Ft,av as we}from"./index-D9RTcbMS.js";import{b as St,h as Ce,a as Ne,u as Dt,Q as ze,e as Te,d as xt}from"./orderStore-L0y4EQ99.js";import{Q as ve,d as de}from"./QCardSection-BJnaadtX.js";import{f as qt,Q as je,C as kt}from"./ClosePopup-DoxKGoh4.js";import{u as Bt,a as wt,Q as Ie}from"./QCard-782QXVRa.js";import{u as Ve}from"./use-quasar-D53nDOxb.js";import{u as Oe,Q as Ct}from"./unitsStore-xk1z2yeU.js";import{_ as Me}from"./_plugin-vue_export-helper-DlAUqK2U.js";const zt=te({name:"QPage",props:{padding:Boolean,styleFn:Function},setup(t,{slots:d}){const{proxy:{$q:u}}=Z(),a=ce(Ge,j);if(a===j)return console.error("QPage needs to be a deep child of QLayout"),j;if(ce(et,j)===j)return console.error("QPage needs to be child of QPageContainer"),j;const f=D(()=>{const m=(a.header.space===!0?a.header.size:0)+(a.footer.space===!0?a.footer.size:0);if(typeof t.styleFn=="function"){const n=a.isContainer.value===!0?a.containerHeight.value:u.screen.height;return t.styleFn(m,n)}return{minHeight:a.isContainer.value===!0?a.containerHeight.value-m+"px":u.screen.height===0?m!==0?`calc(100vh - ${m}px)`:"100vh":u.screen.height-m+"px"}}),v=D(()=>`q-page${t.padding===!0?" q-layout-padding":""}`);return()=>h("main",{class:v.value,style:f.value},Pe(d.default))}}),{passive:M}=tt,Ut=te({name:"QInfiniteScroll",props:{offset:{type:Number,default:500},debounce:{type:[String,Number],default:100},scrollTarget:at,initialIndex:{type:Number,default:0},disable:Boolean,reverse:Boolean},emits:["load"],setup(t,{slots:d,emit:u}){const a=x(!1),r=x(!0),f=x(null),v=x(null);let m=t.initialIndex,n,S;const w=D(()=>"q-infinite-scroll__loading"+(a.value===!0?"":" invisible"));function C(){if(t.disable===!0||a.value===!0||r.value===!1)return;const c=le(n),q=se(n),p=xe(n);t.reverse===!1?Math.round(q+p+t.offset)>=Math.round(c)&&i():Math.round(q)<=t.offset&&i()}function i(){if(t.disable===!0||a.value===!0||r.value===!1)return;m++,a.value=!0;const c=le(n);u("load",m,q=>{r.value===!0&&(a.value=!1,qe(()=>{if(t.reverse===!0){const p=le(n),k=se(n),R=p-c;ue(n,k+R)}q===!0?_():f.value&&f.value.closest("body")&&S()}))})}function l(){m=0}function e(){r.value===!1&&(r.value=!0,n.addEventListener("scroll",S,M)),C()}function _(){r.value===!0&&(r.value=!1,a.value=!1,n.removeEventListener("scroll",S,M),S?.cancel?.())}function z(){if(n&&r.value===!0&&n.removeEventListener("scroll",S,M),n=nt(f.value,t.scrollTarget),r.value===!0){if(n.addEventListener("scroll",S,M),t.reverse===!0){const c=le(n),q=xe(n);ue(n,c-q)}C()}}function y(c){m=c}function s(c){c=parseInt(c,10);const q=S;S=c<=0?C:st(C,isNaN(c)===!0?100:c),n&&r.value===!0&&(q!==void 0&&n.removeEventListener("scroll",q,M),n.addEventListener("scroll",S,M))}function U(c){if(Q.value===!0){if(v.value===null){c!==!0&&qe(()=>{U(!0)});return}const q=`${a.value===!0?"un":""}pauseAnimations`;Array.from(v.value.getElementsByTagName("svg")).forEach(p=>{p[q]()})}}const Q=D(()=>t.disable!==!0&&r.value===!0);Y([a,Q],()=>{U()}),Y(()=>t.disable,c=>{c===!0?_():e()}),Y(()=>t.reverse,()=>{a.value===!1&&r.value===!0&&C()}),Y(()=>t.scrollTarget,z),Y(()=>t.debounce,s);let $=!1;lt(()=>{$!==!1&&n&&ue(n,$)}),ot(()=>{$=n?se(n):!1}),Ee(()=>{r.value===!0&&n.removeEventListener("scroll",S,M)}),Le(()=>{s(t.debounce),z(),a.value===!1&&U()});const g=Z();return Object.assign(g.proxy,{poll:()=>{S?.()},trigger:i,stop:_,reset:l,resume:e,setIndex:y,updateScrollTarget:z}),()=>{const c=rt(d.default,[]);return Q.value===!0&&c[t.reverse===!1?"push":"unshift"](h("div",{ref:v,class:w.value},Pe(d.loading))),h("div",{class:"q-infinite-scroll",ref:f},c)}}}),Pt=te({name:"QUploaderAddTrigger",setup(){const t=ce(Qe,j);return t===j&&console.error("QUploaderAddTrigger needs to be child of QUploader"),t}}),Et={...ut,min:{type:Number,default:0},max:{type:Number,default:100},color:String,centerColor:String,trackColor:String,fontSize:String,rounded:Boolean,thickness:{type:Number,default:.2,validator:t=>t>=0&&t<=1},angle:{type:Number,default:0},showValue:Boolean,reverse:Boolean,instantFeedback:Boolean},me=50,He=2*me,Ke=He*Math.PI,Lt=Math.round(Ke*1e3)/1e3,Qt=te({name:"QCircularProgress",props:{...Et,value:{type:Number,default:0},animationSpeed:{type:[String,Number],default:600},indeterminate:Boolean},setup(t,{slots:d}){const{proxy:{$q:u}}=Z(),a=it(t),r=D(()=>{const l=(u.lang.rtl===!0?-1:1)*t.angle;return{transform:t.reverse!==(u.lang.rtl===!0)?`scale3d(-1, 1, 1) rotate3d(0, 0, 1, ${-90-l}deg)`:`rotate3d(0, 0, 1, ${l-90}deg)`}}),f=D(()=>t.instantFeedback!==!0&&t.indeterminate!==!0?{transition:`stroke-dashoffset ${t.animationSpeed}ms ease 0s, stroke ${t.animationSpeed}ms ease`}:""),v=D(()=>He/(1-t.thickness/2)),m=D(()=>`${v.value/2} ${v.value/2} ${v.value} ${v.value}`),n=D(()=>St(t.value,t.min,t.max)),S=D(()=>t.max-t.min),w=D(()=>t.thickness/2*v.value),C=D(()=>{const l=(t.max-n.value)/S.value,e=t.rounded===!0&&n.value<t.max&&l<.25?w.value/2*(1-l/.25):0;return Ke*l+e});function i({thickness:l,offset:e,color:_,cls:z,rounded:y}){return h("circle",{class:"q-circular-progress__"+z+(_!==void 0?` text-${_}`:""),style:f.value,fill:"transparent",stroke:"currentColor","stroke-width":l,"stroke-dasharray":Lt,"stroke-dashoffset":e,"stroke-linecap":y,cx:v.value,cy:v.value,r:me})}return()=>{const l=[];t.centerColor!==void 0&&t.centerColor!=="transparent"&&l.push(h("circle",{class:`q-circular-progress__center text-${t.centerColor}`,fill:"currentColor",r:me-w.value/2,cx:v.value,cy:v.value})),t.trackColor!==void 0&&t.trackColor!=="transparent"&&l.push(i({cls:"track",thickness:w.value,offset:0,color:t.trackColor})),l.push(i({cls:"circle",thickness:w.value,offset:C.value,color:t.color,rounded:t.rounded===!0?"round":void 0}));const e=[h("svg",{class:"q-circular-progress__svg",style:r.value,viewBox:m.value,"aria-hidden":"true"},l)];return t.showValue===!0&&e.push(h("div",{class:"q-circular-progress__text absolute-full row flex-center content-center",style:{fontSize:t.fontSize}},d.default!==void 0?d.default():[h("div",n.value)])),h("div",{class:`q-circular-progress q-circular-progress--${t.indeterminate===!0?"in":""}determinate`,style:a.value,role:"progressbar","aria-valuemin":t.min,"aria-valuemax":t.max,"aria-valuenow":t.indeterminate===!0?void 0:n.value},dt(d.internal,e))}}});function X(t,d,u,a){const r=[];return t.forEach(f=>{a(f)===!0?r.push(f):d.push({failedPropValidation:u,file:f})}),r}function re(t){t?.dataTransfer&&(t.dataTransfer.dropEffect="copy"),Re(t)}const $t={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},Rt=["rejected"];function At({editable:t,dnd:d,getFileInput:u,addFilesToQueue:a}){const{props:r,emit:f,proxy:v}=Z(),m=x(null),n=D(()=>r.accept!==void 0?r.accept.split(",").map(s=>(s=s.trim(),s==="*"?"*/":(s.endsWith("/*")&&(s=s.slice(0,s.length-1)),s.toUpperCase()))):null),S=D(()=>parseInt(r.maxFiles,10)),w=D(()=>parseInt(r.maxTotalSize,10));function C(s){if(t.value)if(s!==Object(s)&&(s={target:null}),s.target?.matches('input[type="file"]')===!0)s.clientX===0&&s.clientY===0&&$e(s);else{const U=u();U!==s.target&&U?.click(s)}}function i(s){t.value&&s&&a(null,s)}function l(s,U,Q,$){let g=Array.from(U||s.target.files);const c=[],q=()=>{c.length!==0&&f("rejected",c)};if(r.accept!==void 0&&n.value.indexOf("*/")===-1&&(g=X(g,c,"accept",p=>n.value.some(k=>p.type.toUpperCase().startsWith(k)||p.name.toUpperCase().endsWith(k))),g.length===0))return q();if(r.maxFileSize!==void 0){const p=parseInt(r.maxFileSize,10);if(g=X(g,c,"max-file-size",k=>k.size<=p),g.length===0)return q()}if(r.multiple!==!0&&g.length!==0&&(g=[g[0]]),g.forEach(p=>{p.__key=p.webkitRelativePath+p.lastModified+p.name+p.size}),$===!0){const p=Q.map(k=>k.__key);g=X(g,c,"duplicate",k=>p.includes(k.__key)===!1)}if(g.length===0)return q();if(r.maxTotalSize!==void 0){let p=$===!0?Q.reduce((k,R)=>k+R.size,0):0;if(g=X(g,c,"max-total-size",k=>(p+=k.size,p<=w.value)),g.length===0)return q()}if(typeof r.filter=="function"){const p=r.filter(g);g=X(g,c,"filter",k=>p.includes(k))}if(r.maxFiles!==void 0){let p=$===!0?Q.length:0;if(g=X(g,c,"max-files",()=>(p++,p<=S.value)),g.length===0)return q()}if(q(),g.length!==0)return g}function e(s){re(s),d.value!==!0&&(d.value=!0)}function _(s){Re(s),(s.relatedTarget!==null||ct.is.safari!==!0?s.relatedTarget!==m.value:document.elementsFromPoint(s.clientX,s.clientY).includes(m.value)===!1)===!0&&(d.value=!1)}function z(s){re(s);const U=s.dataTransfer.files;U.length!==0&&a(null,U),d.value=!1}function y(s){if(d.value===!0)return h("div",{ref:m,class:`q-${s}__dnd absolute-full`,onDragenter:re,onDragover:re,onDragleave:_,onDrop:z})}return Object.assign(v,{pickFiles:C,addFiles:i}),{pickFiles:C,addFiles:i,onDragover:e,onDragleave:_,processFiles:l,getDndNode:y,maxFilesNumber:S,maxTotalSizeNumber:w}}function Ue(t){return(t*100).toFixed(2)+"%"}const Nt={...Bt,...$t,label:String,color:String,textColor:String,square:Boolean,flat:Boolean,bordered:Boolean,noThumbnails:Boolean,thumbnailFit:{type:String,default:"cover"},autoUpload:Boolean,hideUploadBtn:Boolean,disable:Boolean,readonly:Boolean},We=[...Rt,"start","finish","added","removed"];function Tt(t,d){const u=Z(),{props:a,slots:r,emit:f,proxy:v}=u,{$q:m}=v,n=wt(a,m);function S(o,F,P){if(o.__status=F,F==="idle"){o.__uploaded=0,o.__progress=0,o.__sizeLabel=Ce(o.size),o.__progressLabel="0.00%";return}if(F==="failed"){v.$forceUpdate();return}o.__uploaded=F==="uploaded"?o.size:P,o.__progress=F==="uploaded"?1:Math.min(.9999,o.__uploaded/o.size),o.__progressLabel=Ue(o.__progress),v.$forceUpdate()}const w=D(()=>a.disable!==!0&&a.readonly!==!0),C=x(!1),i=x(null),l=x(null),e={files:x([]),queuedFiles:x([]),uploadedFiles:x([]),uploadedSize:x(0),updateFileStatus:S,isAlive:()=>pt(u)===!1},{pickFiles:_,addFiles:z,onDragover:y,onDragleave:s,processFiles:U,getDndNode:Q,maxFilesNumber:$,maxTotalSizeNumber:g}=At({editable:w,dnd:C,getFileInput:be,addFilesToQueue:ye});Object.assign(e,t({props:a,slots:r,emit:f,helpers:e,exposeApi:o=>{Object.assign(e,o)}})),e.isBusy===void 0&&(e.isBusy=x(!1));const c=x(0),q=D(()=>c.value===0?0:e.uploadedSize.value/c.value),p=D(()=>Ue(q.value)),k=D(()=>Ce(c.value)),R=D(()=>w.value===!0&&e.isUploading.value!==!0&&(a.multiple===!0||e.queuedFiles.value.length===0)&&(a.maxFiles===void 0||e.files.value.length<$.value)&&(a.maxTotalSize===void 0||c.value<g.value)),b=D(()=>w.value===!0&&e.isBusy.value!==!0&&e.isUploading.value!==!0&&e.queuedFiles.value.length!==0);gt(Qe,Se);const O=D(()=>"q-uploader column no-wrap"+(n.value===!0?" q-uploader--dark q-dark":"")+(a.bordered===!0?" q-uploader--bordered":"")+(a.square===!0?" q-uploader--square no-border-radius":"")+(a.flat===!0?" q-uploader--flat no-shadow":"")+(a.disable===!0?" disabled q-uploader--disable":"")+(C.value===!0?" q-uploader--dnd":"")),H=D(()=>"q-uploader__header"+(a.color!==void 0?` bg-${a.color}`:"")+(a.textColor!==void 0?` text-${a.textColor}`:""));Y(e.isUploading,(o,F)=>{F===!1&&o===!0?f("start"):F===!0&&o===!1&&f("finish")});function K(){a.disable===!1&&(e.abort(),e.uploadedSize.value=0,c.value=0,_e(),e.files.value=[],e.queuedFiles.value=[],e.uploadedFiles.value=[])}function A(){a.disable===!1&&he(["uploaded"],()=>{e.uploadedFiles.value=[]})}function ae(){he(["idle","failed"],({size:o})=>{c.value-=o,e.queuedFiles.value=[]})}function he(o,F){if(a.disable===!0)return;const P={files:[],size:0},N=e.files.value.filter(E=>o.indexOf(E.__status)===-1?!0:(P.size+=E.size,P.files.push(E),E.__img!==void 0&&window.URL.revokeObjectURL(E.__img.src),!1));P.files.length!==0&&(e.files.value=N,F(P),f("removed",P.files))}function ne(o){a.disable||(o.__status==="uploaded"?e.uploadedFiles.value=e.uploadedFiles.value.filter(F=>F.__key!==o.__key):o.__status==="uploading"?o.__abort():c.value-=o.size,e.files.value=e.files.value.filter(F=>F.__key!==o.__key?!0:(F.__img!==void 0&&window.URL.revokeObjectURL(F.__img.src),!1)),e.queuedFiles.value=e.queuedFiles.value.filter(F=>F.__key!==o.__key),f("removed",[o]))}function _e(){e.files.value.forEach(o=>{o.__img!==void 0&&window.URL.revokeObjectURL(o.__img.src)})}function be(){return l.value||i.value.getElementsByClassName("q-uploader__input")[0]}function ye(o,F){const P=U(o,F,e.files.value,!0),N=be();N!=null&&(N.value=""),P!==void 0&&(P.forEach(E=>{if(e.updateFileStatus(E,"idle"),c.value+=E.size,a.noThumbnails!==!0&&E.type.toUpperCase().startsWith("IMAGE")){const De=new Image;De.src=window.URL.createObjectURL(E),E.__img=De}}),e.files.value=e.files.value.concat(P),e.queuedFiles.value=e.queuedFiles.value.concat(P),f("added",P),a.autoUpload===!0&&e.upload())}function Fe(){b.value===!0&&e.upload()}function G(o,F,P){if(o===!0){const N={type:"a",key:F,icon:m.iconSet.uploader[F],flat:!0,dense:!0};let E;return F==="add"?(N.onClick=_,E=Se):N.onClick=P,h(J,N,E)}}function Se(){return h("input",{ref:l,class:"q-uploader__input overflow-hidden absolute-full",tabindex:-1,type:"file",title:"",accept:a.accept,multiple:a.multiple===!0?"multiple":void 0,capture:a.capture,onMousedown:$e,onClick:_,onChange:ye})}function Je(){return r.header!==void 0?r.header(W):[h("div",{class:"q-uploader__header-content column"},[h("div",{class:"flex flex-center no-wrap q-gutter-xs"},[G(e.queuedFiles.value.length!==0,"removeQueue",ae),G(e.uploadedFiles.value.length!==0,"removeUploaded",A),e.isUploading.value===!0?h(ke,{class:"q-uploader__spinner"}):null,h("div",{class:"col column justify-center"},[a.label!==void 0?h("div",{class:"q-uploader__title"},[a.label]):null,h("div",{class:"q-uploader__subtitle"},[k.value+" / "+p.value])]),G(R.value,"add"),G(a.hideUploadBtn===!1&&b.value===!0,"upload",e.upload),G(e.isUploading.value,"clear",e.abort)])])]}function Ze(){return r.list!==void 0?r.list(W):e.files.value.map(o=>h("div",{key:o.__key,class:"q-uploader__file relative-position"+(a.noThumbnails!==!0&&o.__img!==void 0?" q-uploader__file--img":"")+(o.__status==="failed"?" q-uploader__file--failed":o.__status==="uploaded"?" q-uploader__file--uploaded":""),style:a.noThumbnails!==!0&&o.__img!==void 0?{backgroundImage:'url("'+o.__img.src+'")',backgroundSize:a.thumbnailFit}:null},[h("div",{class:"q-uploader__file-header row flex-center no-wrap"},[o.__status==="failed"?h(Ae,{class:"q-uploader__file-status",name:m.iconSet.type.negative,color:"negative"}):null,h("div",{class:"q-uploader__file-header-content col"},[h("div",{class:"q-uploader__title"},[o.name]),h("div",{class:"q-uploader__subtitle row items-center no-wrap"},[o.__sizeLabel+" / "+o.__progressLabel])]),o.__status==="uploading"?h(Qt,{value:o.__progress,min:0,max:1,indeterminate:o.__progress===0}):h(J,{round:!0,dense:!0,flat:!0,icon:m.iconSet.uploader[o.__status==="uploaded"?"done":"clear"],onClick:()=>{ne(o)}})])]))}Ee(()=>{e.isUploading.value===!0&&e.abort(),e.files.value.length!==0&&_e()});const W={};for(const o in e)ft(e[o])===!0?vt(W,o,()=>e[o].value):W[o]=e[o];return Object.assign(W,{upload:Fe,reset:K,removeUploadedFiles:A,removeQueuedFiles:ae,removeFile:ne,pickFiles:_,addFiles:z}),mt(W,{canAddFiles:()=>R.value,canUpload:()=>b.value,uploadSizeLabel:()=>k.value,uploadProgressLabel:()=>p.value}),d({...e,upload:Fe,reset:K,removeUploadedFiles:A,removeQueuedFiles:ae,removeFile:ne,pickFiles:_,addFiles:z,canAddFiles:R,canUpload:b,uploadSizeLabel:k,uploadProgressLabel:p}),()=>{const o=[h("div",{class:H.value},Je()),h("div",{class:"q-uploader__list scroll"},Ze()),Q("uploader")];e.isBusy.value===!0&&o.push(h("div",{class:"q-uploader__overlay absolute-full flex flex-center"},[h(ke)]));const F={ref:i,class:O.value};return R.value===!0&&Object.assign(F,{onDragover:y,onDragleave:s}),h("div",F,o)}}const jt=()=>!0;function Xe(t){const d={};return t.forEach(u=>{d[u]=jt}),d}const It=Xe(We),Vt=({name:t,props:d,emits:u,injectPlugin:a})=>te({name:t,props:{...Nt,...d},emits:ht(u)===!0?{...It,...u}:[...We,...u],setup(r,{expose:f}){return Tt(a,f)}});function T(t){return typeof t=="function"?t:()=>t}const Ot="QUploader",Mt={url:[Function,String],method:{type:[Function,String],default:"POST"},fieldName:{type:[Function,String],default:()=>t=>t.name},headers:[Function,Array],formFields:[Function,Array],withCredentials:[Function,Boolean],sendRaw:[Function,Boolean],batch:[Function,Boolean],factory:Function},Ht=["factoryFailed","uploaded","failed","uploading"];function Kt({props:t,emit:d,helpers:u}){const a=x([]),r=x([]),f=x(0),v=D(()=>({url:T(t.url),method:T(t.method),headers:T(t.headers),formFields:T(t.formFields),fieldName:T(t.fieldName),withCredentials:T(t.withCredentials),sendRaw:T(t.sendRaw),batch:T(t.batch)})),m=D(()=>f.value>0),n=D(()=>r.value.length!==0);let S;function w(){a.value.forEach(e=>{e.abort()}),r.value.length!==0&&(S=!0)}function C(){const e=u.queuedFiles.value.slice(0);u.queuedFiles.value=[],v.value.batch(e)?i(e):e.forEach(_=>{i([_])})}function i(e){if(f.value++,typeof t.factory!="function"){l(e,{});return}const _=t.factory(e);if(!_)d("factoryFailed",new Error("QUploader: factory() does not return properly"),e),f.value--;else if(typeof _.catch=="function"&&typeof _.then=="function"){r.value.push(_);const z=y=>{u.isAlive()===!0&&(r.value=r.value.filter(s=>s!==_),r.value.length===0&&(S=!1),u.queuedFiles.value=u.queuedFiles.value.concat(e),e.forEach(s=>{u.updateFileStatus(s,"failed")}),d("factoryFailed",y,e),f.value--)};_.then(y=>{S===!0?z(new Error("Aborted")):u.isAlive()===!0&&(r.value=r.value.filter(s=>s!==_),l(e,y))}).catch(z)}else l(e,_||{})}function l(e,_){const z=new FormData,y=new XMLHttpRequest,s=(b,O)=>_[b]!==void 0?T(_[b])(O):v.value[b](O),U=s("url",e);if(!U){console.error("q-uploader: invalid or no URL specified"),f.value--;return}const Q=s("formFields",e);Q!==void 0&&Q.forEach(b=>{z.append(b.name,b.value)});let $=0,g=0,c=0,q=0,p;y.upload.addEventListener("progress",b=>{if(p===!0)return;const O=Math.min(q,b.loaded);u.uploadedSize.value+=O-c,c=O;let H=c-g;for(let K=$;H>0&&K<e.length;K++){const A=e[K];if(H>A.size)H-=A.size,$++,g+=A.size,u.updateFileStatus(A,"uploading",A.size);else{u.updateFileStatus(A,"uploading",H);return}}},!1),y.onreadystatechange=()=>{y.readyState<4||(y.status&&y.status<400?(u.uploadedFiles.value=u.uploadedFiles.value.concat(e),e.forEach(b=>{u.updateFileStatus(b,"uploaded")}),d("uploaded",{files:e,xhr:y})):(p=!0,u.uploadedSize.value-=c,u.queuedFiles.value=u.queuedFiles.value.concat(e),e.forEach(b=>{u.updateFileStatus(b,"failed")}),d("failed",{files:e,xhr:y})),f.value--,a.value=a.value.filter(b=>b!==y))},y.open(s("method",e),U),s("withCredentials",e)===!0&&(y.withCredentials=!0);const k=s("headers",e);k!==void 0&&k.forEach(b=>{y.setRequestHeader(b.name,b.value)});const R=s("sendRaw",e);e.forEach(b=>{u.updateFileStatus(b,"uploading",0),R!==!0&&z.append(s("fieldName",b),b,b.name),b.xhr=y,b.__abort=()=>{y.abort()},q+=b.size}),d("uploading",{files:e,xhr:y}),a.value.push(y),R===!0?y.send(new Blob(e)):y.send(z)}return{isUploading:m,isBusy:n,abort:w,upload:C}}const Wt={name:Ot,props:Mt,emits:Ht,injectPlugin:Kt},Xt=Vt(Wt);function ge(){const{emit:t,proxy:d}=Z(),u=x(null);function a(){u.value.show()}function r(){u.value.hide()}function f(m){t("ok",m),r()}function v(){t("hide")}return Object.assign(d,{show:a,hide:r}),{dialogRef:u,onDialogHide:v,onDialogOK:f,onDialogCancel:r}}const Ye=["ok","hide"];ge.emits=Ye;ge.emitsObject=Xe(Ye);const Yt={class:"text-center upload-title"},Jt=pe({__name:"AddProductModal",setup(t){const d=Ve(),u=Ne(),a=Dt(),{dialogRef:r}=ge(),f=Oe(),v=x(!1),m=x(),n=x({id:null,name:"",category_id:"",unit_id:"",qty:null,description:""});async function S(){try{const i=await u.createProduct(n.value);i&&(n.value.id=i.id,d.notify({message:"Товар успешно создан, теперь вам необходимо добавить картинку",color:"primary"}))}catch(i){console.error(i)}}function w(i){const l=new FileReader;l.readAsDataURL(i[0]),l.onload=()=>{l?.result&&(m.value=String(l.result))},C(i[0])}async function C(i){const l=new FormData;l.append("file",i);try{await u.uploadFile(n.value.id,l)&&(d.notify({message:"Картинка успешно добавлена",color:"primary"}),r.value?.hide())}catch(e){console.error(e)}}return(i,l)=>(V(),ee(qt,{ref_key:"dialogRef",ref:r,modelValue:v.value,"onUpdate:modelValue":l[6]||(l[6]=e=>v.value=e),persistent:""},{default:L(()=>[B(Ie,{class:"add-product"},{default:L(()=>[B(Ct,{greedy:""},{default:L(()=>[B(ve,null,{default:L(()=>[l[9]||(l[9]=I("div",{class:"text-h6 q-mb-md"},"Добавление товара",-1)),B(de,{modelValue:n.value.name,"onUpdate:modelValue":l[0]||(l[0]=e=>n.value.name=e),label:"Наименование товара","stack-label":""},null,8,["modelValue"]),B(de,{modelValue:n.value.qty,"onUpdate:modelValue":l[1]||(l[1]=e=>n.value.qty=e),label:"Количество","stack-label":""},null,8,["modelValue"]),B(ze,{modelValue:n.value.category_id,"onUpdate:modelValue":l[2]||(l[2]=e=>n.value.category_id=e),options:fe(a).categories,label:"Тип тары","emit-value":"","map-options":"","option-label":"name","option-value":"id"},null,8,["modelValue","options"]),B(ze,{modelValue:n.value.unit_id,"onUpdate:modelValue":l[3]||(l[3]=e=>n.value.unit_id=e),options:fe(f).units,label:"Вес","emit-value":"","map-options":"","option-label":"name","option-value":"id"},null,8,["modelValue","options"]),B(de,{class:"q-mt-sm",modelValue:n.value.description,"onUpdate:modelValue":l[4]||(l[4]=e=>n.value.description=e),filled:"",type:"textarea",rows:"2",label:"Описание"},null,8,["modelValue"]),!m.value&&n.value.id?(V(),ee(Xt,{key:0,class:"q-mt-sm",ref:"uploaderRef",color:"primary",flat:"",onAdded:w},{header:L(()=>[...l[7]||(l[7]=[])]),list:L(()=>[B(Pt),I("div",Yt,[B(Ae,{class:"q-mr-sm",name:"note_add",size:"24px"}),l[8]||(l[8]=I("span",null,"Загрузить картинку",-1))])]),_:1},512)):(V(),ee(Te,{key:1,class:"q-mt-sm",src:m.value},null,8,["src"]))]),_:1}),B(je,{align:"right"},{default:L(()=>[_t(B(J,{color:"red",label:"Отмена"},null,512),[[kt]]),B(J,{color:"primary",label:"Подтвердить",onClick:l[5]||(l[5]=e=>S())})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Zt=Me(Jt,[["__scopeId","data-v-d34a09c5"]]),Gt={class:"product-card row q-col-gutter-xs"},ea={class:"text-center card-title"},ta={class:"text-center"},aa={class:"text-bold"},la={key:0,class:"text-grey old-price"},oa=pe({__name:"ProductList",setup(t){const d=Ve(),u=Oe(),a=Ne(),r=xt(),f=x(!1),v=x(!1),m=x({offset:0,limit:20,totla:0});Le(async()=>{try{await u.fetchUnits(),d.loading.show()}catch(i){console.error(i)}finally{d.loading.hide()}});async function n(){try{d.loading.show();const i=await a.fetchProducts(m.value);i&&(a?.products?.length?a.products.push(i.items):(a.products=i.items,m.value.totla=i.total))}catch(i){console.error(i)}finally{d.loading.hide()}}function S(i){try{if(d.loading.show(),r.basketData?.length){const l=r.basketData.find(e=>e.id===i.id);l?w(l,i):r.basketData.push(structuredClone(we(i)))}else r.basketData.push(structuredClone(we(i)))}catch(l){console.error(l)}finally{d.notify({message:`Товар ${i.name} добавлен в корзину`,color:"primary"}),d.loading.hide()}}function w(i,l){i.price&&(i.price+=l.price),i.weight&&(i.weight+=l.weight),i.oldPrice&&(i.oldPrice+=l.oldPrice)}const C=(i,l)=>{if(a?.products?.length>=m.value.totla){f.value=!0,l(!0);return}n(),m.value.offset++,l()};return(i,l)=>(V(),ee(Ut,{onLoad:C,offset:250},{default:L(()=>[B(J,{onClick:l[0]||(l[0]=e=>v.value=!v.value),class:"full-width q-mb-sm",color:"secondary",label:"Добавление товара"}),I("div",Gt,[(V(!0),ie(yt,null,bt(fe(a).products,(e,_)=>(V(),ie("div",{class:"col-6",key:_},[B(Ie,{class:"my-card radius-12 full-height",style:{"border-radius":"20px"},flat:"",bordered:""},{default:L(()=>[B(ve,{class:"q-pa-sm full-height"},{default:L(()=>[I("div",null,[B(Te,{class:"cursor-pointer",src:"https://media.istockphoto.com/id/1141529240/ru/%D0%B2%D0%B5%D0%BA%D1%82%D0%BE%D1%80%D0%BD%D0%B0%D1%8F/%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D0%B5-%D1%8F%D0%B1%D0%BB%D0%BE%D0%BA%D0%BE-%D0%B2-%D0%BF%D0%BB%D0%BE%D1%81%D0%BA%D0%BE%D0%BC-%D1%81%D1%82%D0%B8%D0%BB%D0%B5-%D0%B8%D0%BB%D0%BB%D1%8E%D1%81%D1%82%D1%80%D0%B0%D1%86%D0%B8%D1%8F-%D0%B2%D0%B5%D0%BA%D1%82%D0%BE%D1%80%D0%B0.jpg?s=612x612&w=0&k=20&c=B-KXrA7VTm8E6t4jk9qcuFz8bDFzTJwiIGaYGYUcsZI="})]),B(ve,{class:"q-pa-sm"},{default:L(()=>[I("div",ea,oe(e.name),1),I("div",ta,[I("span",aa,oe(e.price),1),l[2]||(l[2]=Be(" ₽ ",-1)),e?.oldPrice?(V(),ie("span",la,oe(e.old_price)+" ₽",1)):Ft("",!0),Be(" / "+oe(e.unit_symbol),1)])]),_:2},1024),B(je,{class:"justify-center"},{default:L(()=>[B(J,{dense:"","no-caps":"",class:"full-width",color:"secondary",icon:"add_shopping_cart",label:"В корзину",onClick:z=>S(e)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]))),128))]),B(Zt,{modelValue:v.value,"onUpdate:modelValue":l[1]||(l[1]=e=>v.value=e),label:"test"},null,8,["modelValue"])]),_:1}))}}),ra=Me(oa,[["__scopeId","data-v-868cd156"]]),ma=pe({__name:"DashboardPage",setup(t){return(d,u)=>(V(),ee(zt,{class:"q-mx-xs"},{default:L(()=>[B(ra,{class:"q-mb-lg"})]),_:1}))}});export{ma as default};
