import{Q as g,a as f,b as n}from"./QItem-BUSxhQog.js";import{Q as v}from"./QList-TKOPIRu2.js";import{Q as A}from"./QBtnDropdown-kGTrF5Mm.js";import{V as M,W as T,a1 as C,Y as d,$ as t,Z as e,a2 as b,a3 as k,X as p,ab as D,a5 as o,a6 as m,a4 as L,a7 as V,z as R}from"./index-x6Aa7lxu.js";import{C as G}from"./ClosePopup-C9zojMI0.js";import{u as $,d as P}from"./use-quasar-C_N7afwZ.js";import{u as q}from"./orderStore-qQ89CxCy.js";var c=(s=>(s.CREATED="created",s.ASSEMBLING="assembling",s.DELIVERING="delivering",s.COMPLETED="completed",s.CANCELLED="cancelled",s))(c||{});const Z=M({__name:"OrderHistoryItems",props:{orderData:{},adminMode:{type:Boolean}},setup(s){const r=$(),y=q(),E=[{label:"создан",value:c.CREATED},{label:"собирается",value:c.ASSEMBLING},{label:"в пути",value:c.DELIVERING},{label:"завершён",value:c.COMPLETED},{label:"отменён",value:c.CANCELLED}];function I(l,a){r.dialog({cancel:!0,message:"Вы уверенны что хотите изменить статус?",persistent:!0,title:"Смена статуса"}).onOk(()=>{N(l,a)})}async function N(l,a){try{r.loading.show(),await y.updateOrderStatus(l,a)&&r.notify({color:"primary",message:"Статус успешно изменен"})}catch(u){console.error(u)}finally{r.loading.hide()}}function Q(l){return E.find(u=>u.value===l)?.label}function S(l){r.dialog({cancel:!0,message:"Вы уверенны что хотите отменить заказ?",persistent:!0,title:"Отмена заказа"}).onOk(()=>{B(l)})}async function B(l){try{r.loading.show(),await y.deleteOrder(l)&&r.notify({color:"primary",message:"Заказ отменен"})}catch(a){console.error(a)}finally{r.loading.hide()}}return(l,a)=>{const u=T("q-item-action");return d(),C("div",null,[t(v,null,{default:e(()=>[(d(!0),C(b,null,k(l.orderData,(i,O)=>(d(),p(g,{key:O,class:"border-bot"},{default:e(()=>[t(f,null,{default:e(()=>[t(n,{caption:"",lines:"2"},{default:e(()=>[...a[0]||(a[0]=[o("Дата",-1)])]),_:1}),t(n,null,{default:e(()=>[o(m(L(P)(i.order_date)),1)]),_:2},1024)]),_:2},1024),t(f,null,{default:e(()=>[t(n,{caption:"",lines:"2"},{default:e(()=>[...a[1]||(a[1]=[o("Имя",-1)])]),_:1}),t(n,null,{default:e(()=>[o(m(i.user.full_name),1)]),_:2},1024)]),_:2},1024),t(f,null,{default:e(()=>[t(n,{caption:"",lines:"2"},{default:e(()=>[...a[2]||(a[2]=[o("Статус",-1)])]),_:1}),t(n,null,{default:e(()=>[o(m(Q(i.status)),1)]),_:2},1024)]),_:2},1024),t(f,null,{default:e(()=>[t(n,{caption:"",lines:"2"},{default:e(()=>[...a[3]||(a[3]=[o("Общая сумма",-1)])]),_:1}),t(n,null,{default:e(()=>[o(m(i.total_amount),1)]),_:2},1024)]),_:2},1024),l.adminMode?(d(),p(u,{key:0},{default:e(()=>[t(A,{color:"green",dense:""},{default:e(()=>[(d(),C(b,null,k(E,(_,w)=>t(v,{key:w},{default:e(()=>[V((d(),p(g,{clickable:"",onClick:h=>I(i.id,_.value)},{default:e(()=>[t(f,null,{default:e(()=>[t(n,null,{default:e(()=>[o(m(_.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])),[[G]])]),_:2},1024)),64))]),_:2},1024)]),_:2},1024)):D("",!0),!l.adminMode&&i.status!==L(c).CREATED?(d(),p(u,{key:1},{default:e(()=>[t(R,{round:"",color:"deep-orange",icon:"close",onClick:_=>S(i.id)},null,8,["onClick"])]),_:2},1024)):D("",!0)]),_:2},1024))),128))]),_:1})])}}});export{Z as _};
