import{k as he,t as z,a0 as ve,r as M,c as C,w as S,aN as We,aM as qe,n as I,o as me,g as Y,y as Le,h as D,l as ge,b7 as R,a2 as j,b8 as le,q as U,b9 as Q,a1 as be,aK as pe,K as ne,I as oe,aV as Be,E as Ae,ba as ie,G as Re,a4 as ze,O as De,b5 as Fe,P as $e,R as Ie,S as Ke,bb as Ne,U as Oe,bc as Ve,V as je,bd as Qe,be as _e,bf as ae,bg as Ue,J as Xe,bh as Ye,bi as Ge,bj as Je,a6 as Ze,bk as et,N as tt}from"./index-CsmAfaz7.js";import{c as lt}from"./selection-BqplmxfU.js";const{passive:P}=z,vt=he({name:"QInfiniteScroll",props:{offset:{type:Number,default:500},debounce:{type:[String,Number],default:100},scrollTarget:ve,initialIndex:{type:Number,default:0},disable:Boolean,reverse:Boolean},emits:["load"],setup(e,{slots:l,emit:o}){const t=M(!1),n=M(!0),d=M(null),i=M(null);let h=e.initialIndex,u,r;const v=C(()=>"q-infinite-scroll__loading"+(t.value===!0?"":" invisible"));function b(){if(e.disable===!0||t.value===!0||n.value===!1)return;const f=R(u),g=j(u),E=le(u);e.reverse===!1?Math.round(g+E+e.offset)>=Math.round(f)&&y():Math.round(g)<=e.offset&&y()}function y(){if(e.disable===!0||t.value===!0||n.value===!1)return;h++,t.value=!0;const f=R(u);o("load",h,g=>{n.value===!0&&(t.value=!1,U(()=>{if(e.reverse===!0){const E=R(u),B=j(u),A=E-f;Q(u,B+A)}g===!0?w():d.value&&d.value.closest("body")&&r()}))})}function a(){h=0}function c(){n.value===!1&&(n.value=!0,u.addEventListener("scroll",r,P)),b()}function w(){n.value===!0&&(n.value=!1,t.value=!1,u.removeEventListener("scroll",r,P),r?.cancel?.())}function H(){if(u&&n.value===!0&&u.removeEventListener("scroll",r,P),u=be(d.value,e.scrollTarget),n.value===!0){if(u.addEventListener("scroll",r,P),e.reverse===!0){const f=R(u),g=le(u);Q(u,f-g)}b()}}function q(f){h=f}function L(f){f=parseInt(f,10);const g=r;r=f<=0?b:pe(b,isNaN(f)===!0?100:f),u&&n.value===!0&&(g!==void 0&&u.removeEventListener("scroll",g,P),u.addEventListener("scroll",r,P))}function x(f){if(T.value===!0){if(i.value===null){f!==!0&&U(()=>{x(!0)});return}const g=`${t.value===!0?"un":""}pauseAnimations`;Array.from(i.value.getElementsByTagName("svg")).forEach(E=>{E[g]()})}}const T=C(()=>e.disable!==!0&&n.value===!0);S([t,T],()=>{x()}),S(()=>e.disable,f=>{f===!0?w():c()}),S(()=>e.reverse,()=>{t.value===!1&&n.value===!0&&b()}),S(()=>e.scrollTarget,H),S(()=>e.debounce,L);let m=!1;We(()=>{m!==!1&&u&&Q(u,m)}),qe(()=>{m=u?j(u):!1}),I(()=>{n.value===!0&&u.removeEventListener("scroll",r,P)}),me(()=>{L(e.debounce),H(),t.value===!1&&x()});const k=Y();return Object.assign(k.proxy,{poll:()=>{r?.()},trigger:y,stop:w,reset:a,resume:c,setIndex:q,updateScrollTarget:H}),()=>{const f=Le(l.default,[]);return T.value===!0&&f[e.reverse===!1?"push":"unshift"](D("div",{ref:i,class:v.value},ge(l.loading))),D("div",{class:"q-infinite-scroll",ref:d},f)}}}),nt={target:{type:[Boolean,String,Element],default:!0},noParentEvent:Boolean},ot={...nt,contextMenu:Boolean};function it({showing:e,avoidEmit:l,configureAnchorEl:o}){const{props:t,proxy:n,emit:d}=Y(),i=M(null);let h=null;function u(a){return i.value===null?!1:a===void 0||a.touches===void 0||a.touches.length<=1}const r={};o===void 0&&(Object.assign(r,{hide(a){n.hide(a)},toggle(a){n.toggle(a),a.qAnchorHandled=!0},toggleKey(a){Be(a,13)===!0&&r.toggle(a)},contextClick(a){n.hide(a),ne(a),U(()=>{n.show(a),a.qAnchorHandled=!0})},prevent:ne,mobileTouch(a){if(r.mobileCleanup(a),u(a)!==!0)return;n.hide(a),i.value.classList.add("non-selectable");const c=a.target;oe(r,"anchor",[[c,"touchmove","mobileCleanup","passive"],[c,"touchend","mobileCleanup","passive"],[c,"touchcancel","mobileCleanup","passive"],[i.value,"contextmenu","prevent","notPassive"]]),h=setTimeout(()=>{h=null,n.show(a),a.qAnchorHandled=!0},300)},mobileCleanup(a){i.value.classList.remove("non-selectable"),h!==null&&(clearTimeout(h),h=null),e.value===!0&&a!==void 0&&lt()}}),o=function(a=t.contextMenu){if(t.noParentEvent===!0||i.value===null)return;let c;a===!0?n.$q.platform.is.mobile===!0?c=[[i.value,"touchstart","mobileTouch","passive"]]:c=[[i.value,"mousedown","hide","passive"],[i.value,"contextmenu","contextClick","notPassive"]]:c=[[i.value,"click","toggle","passive"],[i.value,"keyup","toggleKey","passive"]],oe(r,"anchor",c)});function v(){Ae(r,"anchor")}function b(a){for(i.value=a;i.value.classList.contains("q-anchor--skip");)i.value=i.value.parentNode;o()}function y(){if(t.target===!1||t.target===""||n.$el.parentNode===null)i.value=null;else if(t.target===!0)b(n.$el.parentNode);else{let a=t.target;if(typeof t.target=="string")try{a=document.querySelector(t.target)}catch{a=void 0}a!=null?(i.value=a.$el||a,o()):(i.value=null,console.error(`Anchor: target "${t.target}" not found`))}}return S(()=>t.contextMenu,a=>{i.value!==null&&(v(),o(a))}),S(()=>t.target,()=>{i.value!==null&&v(),y()}),S(()=>t.noParentEvent,a=>{i.value!==null&&(a===!0?v():o())}),me(()=>{y(),l!==!0&&t.modelValue===!0&&i.value===null&&d("update:modelValue",!1)}),I(()=>{h!==null&&clearTimeout(h),v()}),{anchorEl:i,canShow:u,anchorEvents:r}}function at(e,l){const o=M(null);let t;function n(h,u){const r=`${u!==void 0?"add":"remove"}EventListener`,v=u!==void 0?u:t;h!==window&&h[r]("scroll",v,z.passive),window[r]("scroll",v,z.passive),t=u}function d(){o.value!==null&&(n(o.value),o.value=null)}const i=S(()=>e.noParentEvent,()=>{o.value!==null&&(d(),l())});return I(i),{localScrollTarget:o,unconfigureScrollTarget:d,changeScrollEvent:n}}const{notPassiveCapture:F}=z,W=[];function $(e){const l=e.target;if(l===void 0||l.nodeType===8||l.classList.contains("no-pointer-events")===!0)return;let o=ie.length-1;for(;o>=0;){const t=ie[o].$;if(t.type.name==="QTooltip"){o--;continue}if(t.type.name!=="QDialog")break;if(t.props.seamless!==!0)return;o--}for(let t=W.length-1;t>=0;t--){const n=W[t];if((n.anchorEl.value===null||n.anchorEl.value.contains(l)===!1)&&(l===document.body||n.innerRef.value!==null&&n.innerRef.value.contains(l)===!1))e.qClickOutside=!0,n.onClickOutside(e);else return}}function ut(e){W.push(e),W.length===1&&(document.addEventListener("mousedown",$,F),document.addEventListener("touchstart",$,F))}function ue(e){const l=W.findIndex(o=>o===e);l!==-1&&(W.splice(l,1),W.length===0&&(document.removeEventListener("mousedown",$,F),document.removeEventListener("touchstart",$,F)))}let re,se;function ce(e){const l=e.split(" ");return l.length!==2?!1:["top","center","bottom"].includes(l[0])!==!0?(console.error("Anchor/Self position must start with one of top/center/bottom"),!1):["left","middle","right","start","end"].includes(l[1])!==!0?(console.error("Anchor/Self position must end with one of left/middle/right/start/end"),!1):!0}function rt(e){return e?!(e.length!==2||typeof e[0]!="number"||typeof e[1]!="number"):!0}const X={"start#ltr":"left","start#rtl":"right","end#ltr":"right","end#rtl":"left"};["left","middle","right"].forEach(e=>{X[`${e}#ltr`]=e,X[`${e}#rtl`]=e});function fe(e,l){const o=e.split(" ");return{vertical:o[0],horizontal:X[`${o[1]}#${l===!0?"rtl":"ltr"}`]}}function st(e,l){let{top:o,left:t,right:n,bottom:d,width:i,height:h}=e.getBoundingClientRect();return l!==void 0&&(o-=l[1],t-=l[0],d+=l[1],n+=l[0],i+=l[0],h+=l[1]),{top:o,bottom:d,height:h,left:t,right:n,width:i,middle:t+(n-t)/2,center:o+(d-o)/2}}function ct(e,l,o){let{top:t,left:n}=e.getBoundingClientRect();return t+=l.top,n+=l.left,o!==void 0&&(t+=o[1],n+=o[0]),{top:t,bottom:t+1,height:1,left:n,right:n+1,width:1,middle:n,center:t}}function ft(e,l){return{top:0,center:l/2,bottom:l,left:0,middle:e/2,right:e}}function de(e,l,o,t){return{top:e[o.vertical]-l[t.vertical],left:e[o.horizontal]-l[t.horizontal]}}function xe(e,l=0){if(e.targetEl===null||e.anchorEl===null||l>5)return;if(e.targetEl.offsetHeight===0||e.targetEl.offsetWidth===0){setTimeout(()=>{xe(e,l+1)},10);return}const{targetEl:o,offset:t,anchorEl:n,anchorOrigin:d,selfOrigin:i,absoluteOffset:h,fit:u,cover:r,maxHeight:v,maxWidth:b}=e;if(Re.is.ios===!0&&window.visualViewport!==void 0){const k=document.body.style,{offsetLeft:f,offsetTop:g}=window.visualViewport;f!==re&&(k.setProperty("--q-pe-left",f+"px"),re=f),g!==se&&(k.setProperty("--q-pe-top",g+"px"),se=g)}const{scrollLeft:y,scrollTop:a}=o,c=h===void 0?st(n,r===!0?[0,0]:t):ct(n,h,t);Object.assign(o.style,{top:0,left:0,minWidth:null,minHeight:null,maxWidth:b,maxHeight:v,visibility:"visible"});const{offsetWidth:w,offsetHeight:H}=o,{elWidth:q,elHeight:L}=u===!0||r===!0?{elWidth:Math.max(c.width,w),elHeight:r===!0?Math.max(c.height,H):H}:{elWidth:w,elHeight:H};let x={maxWidth:b,maxHeight:v};(u===!0||r===!0)&&(x.minWidth=c.width+"px",r===!0&&(x.minHeight=c.height+"px")),Object.assign(o.style,x);const T=ft(q,L);let m=de(c,T,d,i);if(h===void 0||t===void 0)_(m,c,T,d,i);else{const{top:k,left:f}=m;_(m,c,T,d,i);let g=!1;if(m.top!==k){g=!0;const E=2*t[1];c.center=c.top-=E,c.bottom-=E+2}if(m.left!==f){g=!0;const E=2*t[0];c.middle=c.left-=E,c.right-=E+2}g===!0&&(m=de(c,T,d,i),_(m,c,T,d,i))}x={top:m.top+"px",left:m.left+"px"},m.maxHeight!==void 0&&(x.maxHeight=m.maxHeight+"px",c.height>m.maxHeight&&(x.minHeight=x.maxHeight)),m.maxWidth!==void 0&&(x.maxWidth=m.maxWidth+"px",c.width>m.maxWidth&&(x.minWidth=x.maxWidth)),Object.assign(o.style,x),o.scrollTop!==a&&(o.scrollTop=a),o.scrollLeft!==y&&(o.scrollLeft=y)}function _(e,l,o,t,n){const d=o.bottom,i=o.right,h=ze(),u=window.innerHeight-h,r=document.body.clientWidth;if(e.top<0||e.top+d>u)if(n.vertical==="center")e.top=l[t.vertical]>u/2?Math.max(0,u-d):0,e.maxHeight=Math.min(d,u);else if(l[t.vertical]>u/2){const v=Math.min(u,t.vertical==="center"?l.center:t.vertical===n.vertical?l.bottom:l.top);e.maxHeight=Math.min(d,v),e.top=Math.max(0,v-d)}else e.top=Math.max(0,t.vertical==="center"?l.center:t.vertical===n.vertical?l.top:l.bottom),e.maxHeight=Math.min(d,u-e.top);if(e.left<0||e.left+i>r)if(e.maxWidth=Math.min(i,r),n.horizontal==="middle")e.left=l[t.horizontal]>r/2?Math.max(0,r-i):0;else if(l[t.horizontal]>r/2){const v=Math.min(r,t.horizontal==="middle"?l.middle:t.horizontal===n.horizontal?l.right:l.left);e.maxWidth=Math.min(i,v),e.left=Math.max(0,v-e.maxWidth)}else e.left=Math.max(0,t.horizontal==="middle"?l.middle:t.horizontal===n.horizontal?l.left:l.right),e.maxWidth=Math.min(i,r-e.left)}const mt=he({name:"QMenu",inheritAttrs:!1,props:{...ot,...Ie,...$e,...Fe,persistent:Boolean,autoClose:Boolean,separateClosePopup:Boolean,noEscDismiss:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,fit:Boolean,cover:Boolean,square:Boolean,anchor:{type:String,validator:ce},self:{type:String,validator:ce},offset:{type:Array,validator:rt},scrollTarget:ve,touchPosition:Boolean,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null}},emits:[...De,"click","escapeKey"],setup(e,{slots:l,emit:o,attrs:t}){let n=null,d,i,h;const u=Y(),{proxy:r}=u,{$q:v}=r,b=M(null),y=M(!1),a=C(()=>e.persistent!==!0&&e.noRouteDismiss!==!0),c=Ke(e,v),{registerTick:w,removeTick:H}=Ne(),{registerTimeout:q}=Oe(),{transitionProps:L,transitionStyle:x}=Ve(e),{localScrollTarget:T,changeScrollEvent:m,unconfigureScrollTarget:k}=at(e,ee),{anchorEl:f,canShow:g}=it({showing:y}),{hide:E}=je({showing:y,canShow:g,handleShow:He,handleHide:we,hideOnRouteChange:a,processOnMount:!0}),{showPortal:B,hidePortal:A,renderPortal:ye}=Qe(u,b,Ce,"menu"),K={anchorEl:f,innerRef:b,onClickOutside(s){if(e.persistent!==!0&&y.value===!0)return E(s),(s.type==="touchstart"||s.target.classList.contains("q-dialog__backdrop"))&&tt(s),!0}},G=C(()=>fe(e.anchor||(e.cover===!0?"center middle":"bottom start"),v.lang.rtl)),Ee=C(()=>e.cover===!0?G.value:fe(e.self||"top start",v.lang.rtl)),Te=C(()=>(e.square===!0?" q-menu--square":"")+(c.value===!0?" q-menu--dark q-dark":"")),Se=C(()=>e.autoClose===!0?{onClick:ke}:{}),J=C(()=>y.value===!0&&e.persistent!==!0);S(J,s=>{s===!0?(_e(O),ut(K)):(ae(O),ue(K))});function N(){et(()=>{let s=b.value;s&&s.contains(document.activeElement)!==!0&&(s=s.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||s.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||s.querySelector("[autofocus], [data-autofocus]")||s,s.focus({preventScroll:!0}))})}function He(s){if(n=e.noRefocus===!1?document.activeElement:null,Ue(te),B(),ee(),d=void 0,s!==void 0&&(e.touchPosition||e.contextMenu)){const V=Xe(s);if(V.left!==void 0){const{top:Me,left:Pe}=f.value.getBoundingClientRect();d={left:V.left-Pe,top:V.top-Me}}}i===void 0&&(i=S(()=>v.screen.width+"|"+v.screen.height+"|"+e.self+"|"+e.anchor+"|"+v.lang.rtl,p)),e.noFocus!==!0&&document.activeElement.blur(),w(()=>{p(),e.noFocus!==!0&&N()}),q(()=>{v.platform.is.ios===!0&&(h=e.autoClose,b.value.click()),p(),B(!0),o("show",s)},e.transitionDuration)}function we(s){H(),A(),Z(!0),n!==null&&(s===void 0||s.qClickOutside!==!0)&&(((s?.type.indexOf("key")===0?n.closest('[tabindex]:not([tabindex^="-"])'):void 0)||n).focus(),n=null),q(()=>{A(!0),o("hide",s)},e.transitionDuration)}function Z(s){d=void 0,i!==void 0&&(i(),i=void 0),(s===!0||y.value===!0)&&(Ye(te),k(),ue(K),ae(O)),s!==!0&&(n=null)}function ee(){(f.value!==null||e.scrollTarget!==void 0)&&(T.value=be(f.value,e.scrollTarget),m(T.value,p))}function ke(s){h!==!0?(Ge(r,s),o("click",s)):h=!1}function te(s){J.value===!0&&e.noFocus!==!0&&Je(b.value,s.target)!==!0&&N()}function O(s){e.noEscDismiss!==!0&&(o("escapeKey"),E(s))}function p(){xe({targetEl:b.value,offset:e.offset,anchorEl:f.value,anchorOrigin:G.value,selfOrigin:Ee.value,absoluteOffset:d,fit:e.fit,cover:e.cover,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function Ce(){return D(Ze,L.value,()=>y.value===!0?D("div",{role:"menu",...t,ref:b,tabindex:-1,class:["q-menu q-position-engine scroll"+Te.value,t.class],style:[t.style,x.value],...Se.value},ge(l.default)):null)}return I(Z),Object.assign(r,{focus:N,updatePosition:p}),ye}});export{mt as Q,vt as a};
