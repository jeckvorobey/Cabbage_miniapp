import{k as C,r as F,ah as E,ag as P,o as q,g as B,h as I,l as $,at as R,K as A,q as V,N as Q,aH as j,aF as k,aG as d}from"./index-D9RTcbMS.js";import{i as D}from"./QCardSection-BJnaadtX.js";const H=C({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(a,{slots:m,emit:f}){const g=B(),s=F(null);let u=0;const e=[];function n(t){const c=typeof t=="boolean"?t:a.noErrorFocus!==!0,v=++u,U=(o,r)=>{f(`validation${o===!0?"Success":"Error"}`,r)},p=o=>{const r=o.validate();return typeof r.then=="function"?r.then(i=>({valid:i,comp:o}),i=>({valid:!1,comp:o,err:i})):Promise.resolve({valid:r,comp:o})};return(a.greedy===!0?Promise.all(e.map(p)).then(o=>o.filter(r=>r.valid!==!0)):e.reduce((o,r)=>o.then(()=>p(r).then(i=>{if(i.valid===!1)return Promise.reject(i)})),Promise.resolve()).catch(o=>[o])).then(o=>{if(o===void 0||o.length===0)return v===u&&U(!0),!0;if(v===u){const{comp:r,err:i}=o[0];if(i!==void 0&&console.error(i),U(!1,r),c===!0){const x=o.find(({comp:w})=>typeof w.focus=="function"&&R(w.$)===!1);x!==void 0&&x.comp.focus()}}return!1})}function l(){u++,e.forEach(t=>{typeof t.resetValidation=="function"&&t.resetValidation()})}function y(t){t!==void 0&&A(t);const c=u+1;n().then(v=>{c===u&&v===!0&&(a.onSubmit!==void 0?f("submit",t):t?.target!==void 0&&typeof t.target.submit=="function"&&t.target.submit())})}function S(t){t!==void 0&&A(t),f("reset"),V(()=>{l(),a.autofocus===!0&&a.noResetFocus!==!0&&h()})}function h(){D(()=>{if(s.value===null)return;(s.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||s.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||s.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(s.value.querySelectorAll("[tabindex]"),c=>c.tabIndex!==-1))?.focus({preventScroll:!0})})}Q(j,{bindComponent(t){e.push(t)},unbindComponent(t){const c=e.indexOf(t);c!==-1&&e.splice(c,1)}});let b=!1;return E(()=>{b=!0}),P(()=>{b===!0&&a.autofocus===!0&&h()}),q(()=>{a.autofocus===!0&&h()}),Object.assign(g.proxy,{validate:n,resetValidation:l,submit:y,reset:S,focus:h,getValidationComponents:()=>e}),()=>I("form",{class:"q-form",ref:s,onSubmit:y,onReset:S},$(m.default))}}),M=k("Units",()=>{const a=F();async function m(e){return d.post("units",e).then(n=>n.data).catch(n=>{throw console.error("[UnitsStore] - An error occurred while createing via createUnit",n.message),n})}async function f(e){return d.get(`/units/${e}`).then(n=>n.data).catch(n=>{throw console.error("[UnitsStore] - An error occurred while fetching via fetchUnitsById",n.message),n})}async function g(){return d.get("units").then(e=>{a.value=e.data}).catch(e=>{throw console.error("[UnitsStore] - An error occurred while fetching via fetchUnits",e.message),e})}async function s(e,n){return d.put(`/units/${e}`,{data:n}).then(l=>l.data).catch(l=>{throw console.error("[UnitsStore] - An error occurred while fetching via updateUnit",l.message),l})}async function u(e){return d.delete(`units/${e}`).then(n=>n.data).catch(n=>{throw console.error("[UnitsStore] - An error occurred while deleting via deleteUnit",n.message),n})}return{createUnit:m,fetchUnitsById:f,fetchUnits:g,updateUnit:s,deleteUnit:u,units:a}});export{H as Q,M as u};
