import{b as V,f,h as d,p as J,n as K,r as T,a$ as ae,A as k,b0 as R,aF as oe,m as W,B as Y,O as le,P as re,b1 as ie,aB as se,Q as $,j as ue,X as ce,Z as x,_ as p,a6 as F,$ as m,a3 as me,a5 as de,a4 as fe,a1 as q,ad as U,a9 as j,a7 as z}from"./index-TWMozEHe.js";import{a as ve,b as ge,c as _e,d as ye}from"./useCart-F50_ESqI.js";import{Q as H,a as X,b as Z}from"./QItem-DJ-6SN4N.js";import{Q as be}from"./QList-D51DKjrd.js";import{Q as he}from"./QBtnDropdown-DtfsLo1K.js";import{C as G}from"./ClosePopup-DWWMCTrG.js";import{u as pe}from"./use-quasar-DXTtSasI.js";import{u as Ce}from"./usePermissionVisibility.hook-CmS_Rd9u.js";import{u as xe}from"./productsStore-54SbMLgD.js";import{_ as qe}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Ie=V({name:"QCarouselSlide",props:{...ve,imgSrc:String},setup(e,{slots:i}){const a=f(()=>e.imgSrc?{backgroundImage:`url("${e.imgSrc}")`}:{});return()=>d("div",{class:"q-carousel__slide",style:a.value},J(i.default))}}),Pe=V({name:"QCarouselControl",props:{position:{type:String,default:"bottom-right",validator:e=>["top-right","top-left","bottom-right","bottom-left","top","right","bottom","left"].includes(e)},offset:{type:Array,default:()=>[18,18],validator:e=>e.length===2}},setup(e,{slots:i}){const a=f(()=>`q-carousel__control absolute absolute-${e.position}`),o=f(()=>({margin:`${e.offset[1]}px ${e.offset[0]}px`}));return()=>d("div",{class:a.value,style:o.value},J(i.default))}});let P=0;const ke={fullscreen:Boolean,noRouteFullscreenExit:Boolean},$e=["update:fullscreen","fullscreen"];function we(){const e=K(),{props:i,emit:a,proxy:o}=e;let t,v,y;const l=T(!1);ae(e)===!0&&k(()=>o.$route.fullPath,()=>{i.noRouteFullscreenExit!==!0&&g()}),k(()=>i.fullscreen,b=>{l.value!==b&&c()}),k(l,b=>{a("update:fullscreen",b),a("fullscreen",b)});function c(){l.value===!0?g():h()}function h(){l.value!==!0&&(l.value=!0,y=o.$el.parentNode,y.replaceChild(v,o.$el),document.body.appendChild(o.$el),P++,P===1&&document.body.classList.add("q-body--fullscreen-mixin"),t={handler:g},R.add(t))}function g(){l.value===!0&&(t!==void 0&&(R.remove(t),t=void 0),y.replaceChild(o.$el,v),l.value=!1,P=Math.max(0,P-1),P===0&&(document.body.classList.remove("q-body--fullscreen-mixin"),o.$el.scrollIntoView!==void 0&&setTimeout(()=>{o.$el.scrollIntoView()})))}return oe(()=>{v=document.createElement("span")}),W(()=>{i.fullscreen===!0&&h()}),Y(g),Object.assign(o,{toggleFullscreen:c,setFullscreen:h,exitFullscreen:g}),{inFullscreen:l,toggleFullscreen:c}}const Se=["top","right","bottom","left"],Qe=["regular","flat","outline","push","unelevated"],Be=V({name:"QCarousel",props:{...le,..._e,...ke,transitionPrev:{type:String,default:"fade"},transitionNext:{type:String,default:"fade"},height:String,padding:Boolean,controlColor:String,controlTextColor:String,controlType:{type:String,validator:e=>Qe.includes(e),default:"flat"},autoplay:[Number,Boolean],arrows:Boolean,prevIcon:String,nextIcon:String,navigation:Boolean,navigationPosition:{type:String,validator:e=>Se.includes(e)},navigationIcon:String,navigationActiveIcon:String,thumbnails:Boolean},emits:[...$e,...ge],setup(e,{slots:i}){const{proxy:{$q:a}}=K(),o=re(e,a);let t=null,v;const{updatePanelsList:y,getPanelContent:l,panelDirectives:c,goToPanel:h,previousPanel:g,nextPanel:b,getEnabledPanels:w,panelIndex:s}=ye(),{inFullscreen:n}=we(),_=f(()=>n.value!==!0&&e.height!==void 0?{height:e.height}:{}),C=f(()=>e.vertical===!0?"vertical":"horizontal"),N=f(()=>e.navigationPosition||(e.vertical===!0?"right":"bottom")),ee=f(()=>`q-carousel q-panel-parent q-carousel--with${e.padding===!0?"":"out"}-padding`+(n.value===!0?" fullscreen":"")+(o.value===!0?" q-carousel--dark q-dark":"")+(e.arrows===!0?` q-carousel--arrows-${C.value}`:"")+(e.navigation===!0?` q-carousel--navigation-${N.value}`:"")),E=f(()=>{const r=[e.prevIcon||a.iconSet.carousel[e.vertical===!0?"up":"left"],e.nextIcon||a.iconSet.carousel[e.vertical===!0?"down":"right"]];return e.vertical===!1&&a.lang.rtl===!0?r.reverse():r}),M=f(()=>e.navigationIcon||a.iconSet.carousel.navigationIcon),te=f(()=>e.navigationActiveIcon||M.value),S=f(()=>({color:e.controlColor,textColor:e.controlTextColor,round:!0,[e.controlType]:!0,dense:!0}));k(()=>e.modelValue,()=>{e.autoplay&&Q()}),k(()=>e.autoplay,r=>{r?Q():t!==null&&(clearTimeout(t),t=null)});function Q(){const r=ie(e.autoplay)===!0?Math.abs(e.autoplay):5e3;t!==null&&clearTimeout(t),t=setTimeout(()=>{t=null,r>=0?b():g()},r)}W(()=>{e.autoplay&&Q()}),Y(()=>{t!==null&&clearTimeout(t)});function D(r,I){return d("div",{class:`q-carousel__control q-carousel__navigation no-wrap absolute flex q-carousel__navigation--${r} q-carousel__navigation--${N.value}`+(e.controlColor!==void 0?` text-${e.controlColor}`:"")},[d("div",{class:"q-carousel__navigation-inner flex flex-center no-wrap"},w().map(I))])}function ne(){const r=[];if(e.navigation===!0){const I=i["navigation-icon"]!==void 0?i["navigation-icon"]:u=>d($,{key:"nav"+u.name,class:`q-carousel__navigation-icon q-carousel__navigation-icon--${u.active===!0?"":"in"}active`,...u.btnProps,onClick:u.onClick}),B=v-1;r.push(D("buttons",(u,L)=>{const O=u.props.name,A=s.value===L;return I({index:L,maxIndex:B,name:O,active:A,btnProps:{icon:A===!0?te.value:M.value,size:"sm",...S.value},onClick:()=>{h(O)}})}))}else if(e.thumbnails===!0){const I=e.controlColor!==void 0?` text-${e.controlColor}`:"";r.push(D("thumbnails",B=>{const u=B.props;return d("img",{key:"tmb#"+u.name,class:`q-carousel__thumbnail q-carousel__thumbnail--${u.name===e.modelValue?"":"in"}active`+I,src:u.imgSrc||u["img-src"],onClick:()=>{h(u.name)}})}))}return e.arrows===!0&&s.value>=0&&((e.infinite===!0||s.value>0)&&r.push(d("div",{key:"prev",class:`q-carousel__control q-carousel__arrow q-carousel__prev-arrow q-carousel__prev-arrow--${C.value} absolute flex flex-center`},[d($,{icon:E.value[0],...S.value,onClick:g})])),(e.infinite===!0||s.value<v-1)&&r.push(d("div",{key:"next",class:`q-carousel__control q-carousel__arrow q-carousel__next-arrow q-carousel__next-arrow--${C.value} absolute flex flex-center`},[d($,{icon:E.value[1],...S.value,onClick:b})]))),ue(i.control,r)}return()=>(v=y(i),d("div",{class:ee.value,style:_.value},[se("div",{class:"q-carousel__slides-container"},l(),"sl-cont",e.swipeable,()=>c.value)].concat(ne())))}}),Fe=ce({__name:"ProductImgCarusel",props:{images:{}},emits:["refresh-data"],setup(e,{emit:i}){const a=e,o=i,t=pe(),v=xe(),{isManager:y}=Ce(),l=T(0),c=T(!1);function h(){t.dialog({cancel:!0,message:"Вы уверенны что хотите удалить картинку?",persistent:!0,title:"Удаление картинки"}).onOk(()=>{g()})}async function g(){try{const s=a.images[l.value];await v.deleteFile(s.id),o("refresh-data")}catch(s){console.error(s)}}function b(){t.dialog({cancel:!0,message:"Вы уверенны что хотите назначить эту картинку главной?",persistent:!0,title:"Главная картинка"}).onOk(()=>{w()})}async function w(){try{const s=a.images[l.value];await v.setMainImage(s.id),o("refresh-data")}catch(s){console.error(s)}}return(s,n)=>(p(),x(Be,{modelValue:l.value,"onUpdate:modelValue":n[3]||(n[3]=_=>l.value=_),fullscreen:c.value,"onUpdate:fullscreen":n[4]||(n[4]=_=>c.value=_),swipeable:"",animated:"",arrows:"",infinite:"",height:F(y)?"200px":"250px",class:"q-mb-sm"},{control:m(()=>[q(Pe,{position:"bottom-right",offset:[18,18]},{default:m(()=>[F(y)?U("",!0):(p(),x($,{key:0,push:"",round:"",dense:"",color:"white","text-color":"primary",icon:c.value?"fullscreen_exit":"fullscreen",onClick:n[0]||(n[0]=_=>c.value=!c.value)},null,8,["icon"])),F(y)?(p(),x(he,{key:1,color:"primary",label:"Настройки"},{default:m(()=>[q(be,null,{default:m(()=>[j((p(),x(H,{clickable:"",onClick:n[1]||(n[1]=_=>h())},{default:m(()=>[q(X,null,{default:m(()=>[q(Z,{class:"text-res"},{default:m(()=>[...n[5]||(n[5]=[z("Удалить картинку",-1)])]),_:1})]),_:1})]),_:1})),[[G]]),j((p(),x(H,{clickable:"",onClick:n[2]||(n[2]=_=>b())},{default:m(()=>[q(X,null,{default:m(()=>[q(Z,{class:"text-green"},{default:m(()=>[...n[6]||(n[6]=[z("Назначить главной",-1)])]),_:1})]),_:1})]),_:1})),[[G]])]),_:1})]),_:1})):U("",!0)]),_:1})]),default:m(()=>[(p(!0),me(fe,null,de(s.images,(_,C)=>(p(),x(Ie,{key:C,name:C,"img-src":_.file_path,class:"card-image"},null,8,["name","img-src"]))),128))]),_:1},8,["modelValue","fullscreen","height"]))}}),Ue=qe(Fe,[["__scopeId","data-v-655cf348"]]);export{Ue as P};
